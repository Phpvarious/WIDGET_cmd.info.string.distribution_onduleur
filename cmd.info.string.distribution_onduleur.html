<div class="cmd #history# cmd-widget" data-type="info" data-subtype="string" data-cmd_id="#id#" data-cmd_uid="#uid#" data-version="#version#" data-eqLogic_id="#eqLogic_id#" style="width: 100%;">
<!-- ################ Distribution onduleur ################ 
  Widget name : cmd.info.string.distribution_onduleur
  Author : Phpvarious
  Inspiration : https://github.com/slipx06/sunsynk-power-flow-card/tree/master
  Last Update : 2024/03/11 19h30 - Phpvarious
-->
  <div class="widget#id#" id="widget#id#"></div>
  <style>
    :root {
      --solar_colour#id# : orange;
      --battery_colour#id# : pink;
      --aux_colour#id# : #a43df5;
      --grid_colour#id# : #5490c2;
      --load_colour#id# : #5fb6ad;
      --inverter_colour#id# : grey;
      --inverter_secondary_colour#id# : black;
      --inverterStateColour#id#: transparent;
      --background#id#: transparent;
      --no_grid_colour#id#: #db041c;
      --color_alerte#id#: red;      
      --label-tempo-red#id#: #E85130;
      --label-tempo-blue#id#: #1057c8;
      --label-tempo-white#id#: #F4F4F4;
      --label-tempo-undefined#id#: transparent;
    }
    .widget#id#{width: 100%;}
    .container#id# {
      justify-content: center;
      height: 100%;
      width: 100%;
    }
    .card#id# {background: var(--background#id#, transparent);}
    .left-align#id# {text-anchor: start;}
    .right-align#id# {text-anchor: end;}
    .center-align#id# {text-anchor: middle;}
    .ft7-#id#{font-size:7px;}
    .ft8-#id#{font-size:8px;}
    .ft9-#id#{font-size:9px;}
    .ft12-#id#{font-size:12px;}
    .ft14-#id#{font-size:14px;}
    .ft16-#id#{font-size:16px;}
    .ft18-#id#{font-size:18px;}
    .ft22-#id#{font-size:22px;}
    .ftw-#id#{font-weight:500}
    .hidden-#id#{display:none;}
    
    @keyframes blinking#id# {
      0% { opacity: 1; }
      100% { opacity: 0.4; }
    }
    .blink#id# {
      -moz-animation: blinking#id# 0.7s linear infinite;
      -webkit-animation: blinking#id# 0.7s linear infinite;
      animation: blinking#id# 0.7s linear infinite;
    }
  </style>
  <script>
    ////////////////////////////////////////////////////////
    ////////////////////// VARIABLES ///////////////////////
    ////////////////////////////////////////////////////////
    var debug#id# = ('#debug#' == 1) ? true : false
    var versionWidget#id# = '11/03/2024 19h30'
    var float = false
    var timer_in#id# = false
    var unite_conversion#id# = { 'W' : [1000, 'W', 'kW', 'MW'], 'Wh' : [1000, 'Wh', 'kWh', 'MWh'], 'l' : [1000, 'l', 'm<sup>3</sup>'] }
    var JsonTempoArray#id# = []
    var timer#id# = false
    var labelsList = [
      { key: 'RED', data: { txt: 'Rouge', label: 'label-tempo-red#id#' }},
      { key: 'BLUE', data: { txt: 'Bleu', label: 'label-tempo-blue#id#' }},
      { key: 'WHITE', data: { txt: 'Blanc', label: 'label-tempo-white#id#' }},
      { key: 'UNDEFINED', data: { txt: 'undefined', label: 'label-tempo-undefined#id#' }}
    ];
    
    log#id#('┌─────────────────── Widget Distribution Onduleur [#id#] Compatibilité V4.3 V4.4 [' + versionWidget#id# + '] ───────────────')
    /* Compatibilité V4.2 V4.3 V4.4 */        
    /**/ if (typeof jeedom.cmd.addUpdateFunction !== 'function') { // a partir de la 4.3
    /**/   log#id#('| jeedom.cmd.addUpdateFunction no exist')
    /**/   jeedom.cmd.addUpdateFunction = function(id,func) { jeedom.cmd.update[id]=func; }
    /**/ }
    
    ////////////////////////////////////////////////////////
    ////////////////////// FUNCTION ////////////////////////
    ////////////////////////////////////////////////////////
    function log#id#(text) {
      if (debug#id#) console.log(text)
    }
    function getLabel(key){
      return labelsList.find(item => item.key.toLowerCase() === key.toLowerCase())?labelsList.find(item => item.key.toLowerCase() === key.toLowerCase()).data.label:'label-error#id#'
    }
    function trunc#id#(value = 0, trunc = 1, forceDec = false) {
      trunc = (trunc == 0) ? 1 : (trunc == 1) ? 10 : (trunc == 2) ? 100 : (trunc == 3) ? 1000 : 10
      var result = 0
      if (value === null || value == '' || (isNaN(value) == true)) value = 0
      result = Math.trunc(value * trunc) / trunc
      result = (forceDec && forceDec >= 1 && Number.isInteger(result)) ? result.toFixed(forceDec) : result
      log#id#('|| trunc(' +  value + ', ' + trunc +', ' + forceDec + ') | value brute = ' +  value + ' => ' +  result)
      return result
    }
    function autoValueArray#id#(value, unit = '', trunc = 1) {
      var result = { }
      result.unit = unit.replace("\"", "").replace("\'", "")
      if (value === null || value == '') {
        result.value = 0
        return result
      }
      if(isNaN(value) == true){
        result.value = value
        return result
      }
      if (isset(unite_conversion#id#[unit])) {
        let mod = unite_conversion#id#[unit][0]
        let prefix = unite_conversion#id#[unit].slice(1)
        let myval = autoValueFormat#id#(value, mod, prefix.length - 1)
        result.value = myval[0]
        result.unit = prefix[myval[1]]
      } else result.value = value //Math.trunc(value * trunc) / trunc
      return result
    }
    function autoValueFormat#id#(value, mod = 1000, maxdiv = 10) {
      let val = 0
      if (value < 0) val = parseFloat(-value)
      else val = parseFloat(value)
      for (div = 0; div < maxdiv && val >= mod; div++) {
        val = parseFloat(val / mod)
      }
      if (value < 0) val = -val
      return Array(val, div)
    }
    function getBatteryIcon#id#(value=false, full_capacity=80, empty_capacity=30, icon_perso=false) {
      log#id#('| getBatteryIcon() -> ' + value + ' | ' + full_capacity + ' | ' + empty_capacity + ' | ' + icon_perso)
      if (value < full_capacity && value >= 50) {// 50 a 99
        return '<path fill="var(--battery_colour#id#)" d="M 12 20 H 4 V 6 h 8 L 12 20 m 0.67 -16 H 11 V 2 H 5 v 2 H 3.33 C 2.6 4 2 4.6 2 5.33 v 15.34 C 2 21.4 2.6 22 3.33 22 h 9.34 c 0.74 0 1.33 -0.59 1.33 -1.33 V 5.33 C 14 4.6 13.4 4 12.67 4 M 11 16 H 5 v 3 h 6 v -3 m 0 -4.5 H 5 v 3 h 6 v -3 h -3 h 3"/>'
      } else if (value < 50 && value > empty_capacity) { // 1 a 49
        return '<path fill="var(--battery_colour#id#)" d="M 12 20 H 4 V 6 h 8 L 12 6 L 12 20 m 0.67 -15.999 H 11 V 2 H 5 v 2 H 3.33 C 2.6 4 2 4.6 2 5.33 v 15.34 C 2 21.4 2.6 22 3.33 22 h 9.34 c 0.74 0 1.33 -0.59 1.33 -1.33 V 5.33 C 14 4.6 13.4 4 12.67 4 M 11 16 H 5 v 3 h 6 v -3"/>'
      } else if (value <= empty_capacity) { // empty
        return '<path fill="var(--battery_colour#id#)" d="M 12 6 L 12 20 M 12 20 H 4 l 0.05 -14 h 7.95 m 0.67 -2 h -1.67 V 2 h -6 v 2 H 3.38 a 1.33 1.33 0 0 0 -1.33 1.33 v 15.34 c 0 0.73 0.6 1.33 1.33 1.33 h 9.34 c 0.73 0 1.33 -0.6 1.33 -1.33 V 5.33 A 1.33 1.33 0 0 0 12.72 4 Z"/>'
      } else { // full
        return '<path fill="var(--battery_colour#id#)" d="M 12 20 H 4 V 6 h 8 L 12 20 m 0.67 -16 H 11 V 2 H 5 v 2 H 3.33 C 2.6 4 2 4.6 2 5.33 v 15.34 C 2 21.4 2.6 22 3.33 22 h 9.34 c 0.74 0 1.33 -0.59 1.33 -1.33 V 5.33 C 14 4.6 13.4 4 12.67 4 M 11 16 H 5 v 3 h 6 v -3 m 0 -9 H 5 v 3 h 6 V 7 m 0 4.5 H 5 v 3 h 6 v -3 h -3 h 3"/>'
      }
    }
    function getSvgIcon(icone=false, type, id='iconLoad'){
      log#id#('|┌─────────────── getSvgIcon()')
      let svg = ''; let x = ''; let y = '';
      let width = '30'; let height = '30'
      let fill = 'var(--load_colour#id#)'
      if (id == 'iconBattery') { fill = 'var(--battery_colour#id#)'; width = height = '60' }
      if(icone === 'oven'){
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 32 32" opacity="1"><path fill="' + fill + '" d="M3 7.5A4.5 4.5 0 0 1 7.5 3h17A4.5 4.5 0 0 1 29 7.5v17a4.5 4.5 0 0 1-4.5 4.5h-17A4.5 4.5 0 0 1 3 24.5v-17Zm24 0A2.5 2.5 0 0 0 24.5 5h-17A2.5 2.5 0 0 0 5 7.5V11h22V7.5Zm0 17V13H5v11.5A2.5 2.5 0 0 0 7.5 27h17a2.5 2.5 0 0 0 2.5-2.5Zm-17-15a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3Zm6 0a1.5 1.5 0 1 0 0-3a1.5 1.5 0 0 0 0 3ZM23.5 8a1.5 1.5 0 1 1-3 0a1.5 1.5 0 0 1 3 0ZM9 23v-6h14v6H9Zm-.5-8A1.5 1.5 0 0 0 7 16.5v7A1.5 1.5 0 0 0 8.5 25h15a1.5 1.5 0 0 0 1.5-1.5v-7a1.5 1.5 0 0 0-1.5-1.5h-15Z"/></svg>'
      }
      else if(icone === 'pump'){
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 24 24" opacity="1"><path fill="' + fill + '" d="M3 17h4.1q-.425-.425-.787-.925T5.675 15H3v2Zm9 0q2.075 0 3.538-1.463T17 12q0-2.075-1.463-3.538T12 7Q9.925 7 8.462 8.463T7 12q0 2.075 1.463 3.538T12 17Zm6.325-8H21V7h-4.1q.425.425.788.925T18.325 9ZM1 20v-8h2v1h2.075q-.05-.25-.063-.488T5 12q0-2.925 2.038-4.963T12 5h9V4h2v8h-2v-1h-2.075q.05.25.063.488T19 12q0 2.925-2.038 4.963T12 19H3v1H1Zm2-3v-2v2Zm18-8V7v2Zm-9 3Zm0 3q-.825 0-1.413-.588T10 13q0-.575.238-1.137t.912-1.613L12 9l.85 1.25q.675 1.05.913 1.613T14 13q0 .825-.588 1.413T12 15Z"/></svg>'
      }
      else if(icone === 'aircon'){
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        if ( id == 'iconLoad') width = height = '25'
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 24 24" opacity="1"><path fill="' + fill + '" d="M6.59.66c2.34-1.81 4.88.4 5.45 3.84c.43 0 .85.12 1.23.34c.52-.6.98-1.42.8-2.34c-.42-2.15 1.99-3.89 4.28-.92c1.81 2.34-.4 4.88-3.85 5.45c0 .43-.11.86-.34 1.24c.6.51 1.42.97 2.34.79c2.13-.42 3.88 1.98.91 4.28c-2.34 1.81-4.88-.4-5.45-3.84c-.43 0-.85-.13-1.22-.35c-.52.6-.99 1.43-.81 2.35c.42 2.14-1.99 3.89-4.28.92c-1.82-2.35.4-4.89 3.85-5.45c0-.43.13-.85.35-1.23c-.6-.51-1.42-.98-2.35-.8c-2.13.42-3.88-1.98-.91-4.28M5 16h2a2 2 0 0 1 2 2v6H7v-2H5v2H3v-6a2 2 0 0 1 2-2m0 2v2h2v-2H5m7.93-2H15l-2.93 8H10l2.93-8M18 16h3v2h-3v4h3v2h-3a2 2 0 0 1-2-2v-4a2 2 0 0 1 2-2Z"/></svg>'
      }
      else if(icone === 'boiler'){
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 24 24" opacity="1"><path fill="' + fill + '" d="M9.3 10.775q0 .475.163.925t.462.825q.05-.3.2-.588t.375-.487L12 10l1.475 1.475q.225.2.375.475t.2.575q.275-.375.487-.8t.213-.9q0-.475-.15-.913t-.45-.812q-.275.125-.563.2T13 9.375q-.75 0-1.375-.425t-.95-1.125q-.3.3-.55.637t-.438.713Q9.5 9.55 9.4 9.95t-.1.825ZM12 12.1l-.425.425q-.1.1-.138.2t-.037.225q0 .25.175.4t.425.15q.25 0 .425-.15t.175-.4q0-.125-.037-.225t-.138-.2L12 12.1ZM12 5v1.9q0 .425.3.713t.725.287q.275 0 .5-.162t.4-.388l.175-.25q1.025.575 1.588 1.563t.562 2.162q0 1.75-1.25 2.963T12 15q-1.75 0-2.975-1.225T7.8 10.8q0-1.925 1.225-3.425T12 5ZM6 22q-.825 0-1.413-.588T4 20V6q0-1.65 1.175-2.825T8 2h8q1.65 0 2.825 1.175T20 6v14q0 .825-.588 1.413T18 22H6Zm0-4v2h12v-2q-.75 0-1.2.5T15 19q-1.35 0-1.763-.5T12 18q-.825 0-1.238.5T9 19q-1.35 0-1.763-.5T6 18Zm3-1q.825 0 1.238-.5T12 16q1.35 0 1.8.5t1.2.5q.75 0 1.2-.5T18 16V6q0-.825-.588-1.413T16 4H8q-.825 0-1.413.588T6 6v10q1.35 0 1.763.5T9 17Z"/></svg>'
      }
      else if(icone === 'charging'){
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        if ( id == 'iconLoad') width = height = '25'
        if ( id == 'iconBattery') width = height = '55'
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 24 24" opacity="1"><path fill="' + fill + '" d="M22,2V4H20V2H18V6a2,2,0,0,0,2,2V18a1,1,0,0,1-1,1H16V11H13V9h3V3a3,3,0,0,0-3-3H3A3,3,0,0,0,0,3V9H3v2H0V24H16V21h3a3,3,0,0,0,3-3V8a2,2,0,0,0,2-2V2ZM10.772,11.426,9.008,14.959l-1.789-.893L8.75,11H6.615A1.614,1.614,0,0,1,5.07,8.917L7.293,4.756l1.76.949L7.275,9H9.4a1.6,1.6,0,0,1,1.376,2.426Z"/></svg>'
      }
      else if(icone === 'battery'){
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 24 24" opacity="1"><path fill="' + fill + '" d="M13 12h3l-5 7v-5H8l5-7zm-2-6H7v14h10V6h-4V4h-2zM9 4V3a1 1 0 0 1 1-1h4a1 1 0 0 1 1 1v1h3a1 1 0 0 1 1 1v16a1 1 0 0 1-1 1H6a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1z"/></svg>'
      }
      else if(icone == 'plug') {
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        if ( id == 'iconLoad') width = height = '25'
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 16 16"><path fill="' + fill + '" d="M11.89 4.111a5.5 5.5 0 0 0-7.78 0c-2.599 2.6-2.12 5.657-1.06 6.718a.75.75 0 0 0 1.06 0l.925-.925a3.09 3.09 0 0 1-.173-2.843l.547-1.23a1 1 0 0 1 1.62-.302l.19.19l.75-.75A.75.75 0 1 1 9.03 6.03l-.75.75l.94.94l.75-.75a.75.75 0 1 1 1.06 1.06l-.75.75l.19.19a1 1 0 0 1-.3 1.621l-1.231.547a3.089 3.089 0 0 1-2.843-.173l-.924.924a2.25 2.25 0 0 1-3.182 0C.222 10.122-.007 6.107 3.05 3.05a7 7 0 1 1 2.983 11.67a.75.75 0 1 1 .42-1.44a5.5 5.5 0 0 0 5.436-9.168Zm-5.658 3.56l.252-.566l2.411 2.411l-.566.252A1.589 1.589 0 0 1 6.232 7.67Z"/></svg>'
      }
      else if(icone == 'pool') {
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        if ( id == 'iconLoad') width = height = '25'
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 24 24"><path fill="' + fill + '" d="M2 15c1.67-.75 3.33-1.5 5-1.83V5a3 3 0 0 1 3-3c1.31 0 2.42.83 2.83 2H10a1 1 0 0 0-1 1v1h5V5a3 3 0 0 1 3-3c1.31 0 2.42.83 2.83 2H17a1 1 0 0 0-1 1v9.94c2-.32 4-1.94 6-1.94v2c-2.22 0-4.44 2-6.67 2c-2.22 0-4.44-2-6.66-2c-2.23 0-4.45 1-6.67 2zm12-7H9v2h5zm0 4H9v1c1.67.16 3.33 1.31 5 1.79zM2 19c2.22-1 4.44-2 6.67-2c2.22 0 4.44 2 6.66 2c2.23 0 4.45-2 6.67-2v2c-2.22 0-4.44 2-6.67 2c-2.22 0-4.44-2-6.66-2c-2.23 0-4.45 1-6.67 2z"/></svg>'
      }
      else if(icone == 'dryer') {
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
       svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 24 24"><path fill="' + fill + '" d="M6 2h12a2 2 0 0 1 2 2v16a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2m1 2a1 1 0 0 0-1 1a1 1 0 0 0 1 1a1 1 0 0 0 1-1a1 1 0 0 0-1-1m3 0a1 1 0 0 0-1 1a1 1 0 0 0 1 1a1 1 0 0 0 1-1a1 1 0 0 0-1-1m2 4a6 6 0 0 0-6 6a6 6 0 0 0 6 6a6 6 0 0 0 6-6a6 6 0 0 0-6-6m-3.89 2.5H10c-.24 1.38 0 2.17.58 2.79c1.1 1.07 1.58 2.42 1.31 4.21H10c.24-1.38 0-2.17-.58-2.79c-1.1-1.07-1.57-2.42-1.31-4.21m4 0H14c-.24 1.38 0 2.17.58 2.79c1.1 1.07 1.58 2.42 1.31 4.21H14c.24-1.38 0-2.17-.58-2.79c-1.1-1.07-1.57-2.42-1.31-4.21"/></svg>' 
      }
      else if(icone == 'dishwasher') {
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '"  width="' + width + '" height="' + height + '" viewBox="0 0 24 24"><path fill="' + fill + '" d="M6.25 3A3.25 3.25 0 0 0 3 6.25V10h1.5v-.5h15v8.25a1.75 1.75 0 0 1-1.75 1.75H7v.018c.766.11 1.373.716 1.482 1.482h9.268A3.25 3.25 0 0 0 21 17.75V6.25A3.25 3.25 0 0 0 17.75 3zM19.5 8h-15V6.25c0-.966.784-1.75 1.75-1.75h11.5c.966 0 1.75.784 1.75 1.75zM9 6.25a1 1 0 1 1-2 0a1 1 0 0 1 2 0m3.75-.75a.75.75 0 0 0 0 1.5h3.5a.75.75 0 0 0 0-1.5zM2 11.75a.75.75 0 0 1 .75-.75h5a.75.75 0 0 1 .75.75v2A3.251 3.251 0 0 1 6 16.913V20.5h.75a.75.75 0 0 1 0 1.5h-3a.75.75 0 0 1 0-1.5h.75v-3.587A3.251 3.251 0 0 1 2 13.75z"/></svg>'
      }
      else if(icone == 'washing') {
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        if ( id == 'iconLoad') width = height = '25'
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 24 24"><g fill="none" stroke="' + fill + '" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path fill="' + fill + '" d="M3 6h3m11 0h.01"/><rect width="18" height="20" x="3" y="2" rx="2"/><circle cx="12" cy="13" r="5"/><path d="M12 18a2.5 2.5 0 0 0 0-5a2.5 2.5 0 0 1 0-5"/></g></svg>'
      }
      else if(icone == 'microwave') {
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 24 24"><g fill="none" stroke="' + fill + '" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"><path fill="none" d="M3 7a1 1 0 0 1 1-1h16a1 1 0 0 1 1 1v10a1 1 0 0 1-1 1H4a1 1 0 0 1-1-1zm12-1v12m3-6h.01M18 15h.01M18 9h.01"/><path d="M6.5 10.5c1-.667 1.5-.667 2.5 0c.833.347 1.667.926 2.5 0m-5 3c1-.667 1.5-.667 2.5 0c.833.347 1.667.926 2.5 0"/></g></svg>'
      }
      else if (icone == 'toaster') {
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 24 24"><path fill="' + fill + '" d="M21 11a2 2 0 0 0-2-2H5a2 2 0 0 0-2 2H2v2h1v7h18v-7h1v-2m-5 4a2 2 0 1 1 2-2a2 2 0 0 1-2 2m1-7H6c.33-2.25 2.88-4 6-4s5.63 1.75 6 4"/></svg>'
      }
      else if (icone == 'fridge') {
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 24 24"><path fill="' + fill + '" d="M9 21v1H7v-1a2 2 0 0 1-2-2V4a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2v15a2 2 0 0 1-2 2v1h-2v-1zM7 4v5h10V4zm0 15h10v-8H7zm1-7h2v3H8zm0-6h2v2H8z"/></svg>'
      }
      else if (icone == 'coffee') {
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 24 24"><path fill="' + fill + '" d="M18 6V4h2V2H6c-1.1 0-2 .9-2 2v16c0 1.1.9 2 2 2h14v-2h-4.03A4.966 4.966 0 0 0 18 16v-5H8v5c0 1.64.81 3.09 2.03 4H6V4h2v2c0 .55.45 1 1 1h8c.55 0 1-.45 1-1m-8 10v-3h6v3c0 1.65-1.35 3-3 3s-3-1.35-3-3"/><circle cx="13" cy="9" r="1" fill="' + fill + '"/></svg>'
      }
      else if (icone == 'hood') {
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 24 24"><path fill="' + fill + '" d="M4 20q-.825 0-1.412-.587T2 18v-4.2q0-.4.163-.763T2.6 12.4L7 8V3h10v5l4.425 4.425q.275.275.425.638t.15.762V18q0 .825-.587 1.413T20 20zm1.8-8h12.4L15 8.8V5H9v3.8zM4 18h16v-4H4zm6-1.3v-1.5h4v1.5z"/></svg>' 
      }
      else if (icone == 'light') {
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        if ( id == 'iconLoad') width = height = '25'
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 24 24"><path fill="none" stroke="' + fill + '" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M12 18v-5.25m0 0a6.01 6.01 0 0 0 1.5-.189m-1.5.189a6.01 6.01 0 0 1-1.5-.189m3.75 7.478a12.06 12.06 0 0 1-4.5 0m3.75 2.383a14.406 14.406 0 0 1-3 0M14.25 18v-.192c0-.983.658-1.823 1.508-2.316a7.5 7.5 0 1 0-7.517 0c.85.493 1.509 1.333 1.509 2.316V18"/></svg>'
      }
      else if (icone == 'tv') {
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        if ( id == 'iconLoad') width = height = '24'
        if ( id == 'iconBattery') width = height = '55'
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 20 20"><path fill="' + fill + '" d="M1.364 2.35v10.794h17.272V2.35zM19.09 1c.502 0 .909.403.909.9v11.694c0 .497-.407.9-.91.9l-8.53-.001v3.157h3.437c.377 0 .682.303.682.675a.678.678 0 0 1-.682.675H5.981a.678.678 0 0 1-.682-.675c0-.372.306-.674.682-.674l3.216-.001v-3.157H.909A.904.904 0 0 1 0 13.595V1.9c0-.497.407-.9.91-.9z"/></svg>'
      }
      else if (icone == 'server') {
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        if ( id == 'iconLoad') width = height = '25'
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 24 24"><g fill="none"><path stroke="' + fill + '" stroke-linecap="round" stroke-width="1.5" d="M22 19h-8M2 19h8m2-2v-3"/><circle cx="12" cy="19" r="2" stroke="' + fill + '" stroke-width="1.5"/><path stroke="' + fill + '" stroke-width="1.5" d="M2 11a3 3 0 0 1 3-3h14a3 3 0 1 1 0 6H5a3 3 0 0 1-3-3Zm0-6a3 3 0 0 1 3-3h14a3 3 0 1 1 0 6H5a3 3 0 0 1-3-3Z"/><path stroke="' + fill + '" stroke-linecap="round" stroke-width="1.5" d="M13 5h6m-6 6h6"/><circle cx="6" cy="5" r="1" fill="' + fill + '"/><circle cx="6" cy="11" r="1" fill="' + fill + '"/></g></svg>'
      }
      else if (icone == 'laptop') {
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        if ( id == 'iconLoad') width = height = '25'
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 25 25"><path fill="' + fill + '" d="M22 18V3H2v15H0v2h24v-2zm-8 0h-4v-1h4zm6-3H4V5h16z"/></svg>'
      }
      else if (icone == 'console') {
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        if ( id == 'iconLoad') width = height = '25'
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" viewBox="0 0 24 24"><path fill="none" stroke="' + fill + '" stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M7.5 11.5v3M6 13h3m3-4.653c2.005 0 3.7-1.888 5.786-1.212c2.264.733 3.82 3.413 3.708 9.492c-.022 1.224-.336 2.578-1.546 3.106c-2.797 1.221-4.397-2.328-7-2.328h-1.897c-2.605 0-4.213 3.545-6.998 2.328c-1.21-.528-1.525-1.882-1.547-3.107c-.113-6.078 1.444-8.758 3.708-9.491C8.299 6.459 9.994 8.347 12 8.347m0-4.565v4.342M14.874 13h3"/></svg>'
      }
      else if (icone == 've') {
        x = ((id == 'iconLoad') ? (type === 11 || type === 12) ? '840' : (type === 9 || type === 10) ? '761' : (type === 7 || type === 8) ? '682' : (type === 5 || type === 6) ? '603' : (type === 3 || type === 4) ? '524' : (type === 1 || type === 2) ? '445' : '0' : (type === 1) ? '108' : '209')
        y = ((id == 'iconLoad') ? (type === 1 || type === 3 || type === 5 || type === 7 || type === 9|| type === 11) ? '159' : (type === 2 || type === 4 || type === 6 || type === 8 || type === 10 || type === 12) ? '268' : '0' : '335')
        if ( id == 'iconLoad') width = height = '35'
        if ( id == 'iconBattery') width = height = '75'
        svg = '<svg xmlns="http://www.w3.org/2000/svg" id="' + id + type + '#id#" x="' + x + '" y="' + y + '" width="' + width + '" height="' + height + '" preserveAspectRatio="none" viewBox="0 0 1600 1600"><path fill="' + fill + '" d="M1553,402.5l-18.6-18.6c-4-4-10.4-4-14.4,0l-86.1,86.1l-57.2-57.2l86.1-86.1c4-4,4-10.4,0-14.4l-18.6-18.6   c-4-4-10.4-4-14.4,0l-86.1,86.1l-47-47c-48.6,48.6-57.8,121.8-27.5,179.7c-18,17.7-31.6,38.1-40.6,61.2c-2.7,6.8-4.9,13.8-6.7,21   c-39.6-45-74.3-73.2-74.3-73.2c-70.9-60.6-175.6-93.2-303.3-84.3c-190.4,13.3-267.9,98.6-324.4,160.9   c-34.7,38.3-55.9,60.1-87.2,64.8c-225.4,33.4-347,133.2-333.7,273.8c7.5,78.9,30.5,132.6,68.6,159.5c0,0,29.6,17.7,66,17.2h54.9   c27.4,69.8,95.5,119.3,174.9,119.3s147.5-49.5,174.9-119.3h236.9c27.4,69.8,95.5,119.3,174.9,119.3c88.3,0,162.6-61.3,182.6-143.6   c26.9-34.9,88.8-126.1,101.7-225.3c7.3-56.4-10.1-112.6-36.9-162.6c-3.8-12.3-7.4-27.5-8.8-43.8c-3.1-37.3,6.2-67.1,28.3-90.4   c59.9,42.3,143.3,36.6,197-17l-47-47l86.1-86.1C1557,412.9,1557,406.4,1553,402.5z M463.3,1159.8c-63.4,0-114.9-51.6-114.9-114.9   c0-63.4,51.6-114.9,114.9-114.9s114.9,51.6,114.9,114.9C578.2,1108.3,526.7,1159.8,463.3,1159.8z M1050,1159.8   c-63.4,0-114.9-51.6-114.9-114.9c0-63.4,51.6-114.9,114.9-114.9c63.4,0,114.9,51.6,114.9,114.9   C1165,1108.3,1113.4,1159.8,1050,1159.8z M1261.7,870.9c-2.2,38.8-16.9,78-35.1,109.7c-26.3-72.1-95.5-123.6-176.5-123.6   c-102.1,0-185.4,81.9-187.8,183.4H651.1c-2.4-101.5-85.7-183.4-187.8-183.4s-185.4,81.9-187.8,183.4h-45.4c-21,0.3-22.2-5-22.2-5   c-10.7-8.6-29.7-33.7-36.5-105.6c-12.5-132.6,164.9-178.9,271.8-194.8c58.7-8.7,93.6-47.2,130.6-87.9   c53.6-59,114.3-126,275.5-137.2c13.6-1,26.8-1.4,39.5-1.4c87,0,154.7,22,201.6,65.6C1090.3,574.1,1271.1,702.5,1261.7,870.9z"/></svg>'
      }
      log#id#('|| value = ' +  icone)
      log#id#('|| type = ' +  type)
      log#id#('|| id = ' +  id)
      log#id#('|| x = ' +  x)
      log#id#('|| y = ' +  y)
      log#id#('|└────────────────────────────────────')
      return svg
    }
    ////////////////////////////////////////////////////////
    //////////////////////// CONFIG ////////////////////////
    ////////////////////////////////////////////////////////
    var config#id# = {
      panel_mode: true, // rester a true pour que l'user puisse choisir la taille
      show_solar: false,
      card_height: '396px',
      blink: false,
      timer: {
        usetimer: false, /* Displays "Use timer" status as an icon next to the inverter. Set to `no` to hide */
        state: 'no', // [on, off] Shows if energy pattern is set to priority load or priority battery as an icon next to the inverter.
        text_on: 'Timer on',
        text_off: 'Timer off'
      },
      priority: {
        usepriority: false, //--------------- Todo
        state: 'off', // on, off 
        text_on: 'Priority Load',
        text_off: 'Priority Batt'
      },
      inverter: {
        autarky: 'no', // no, energy, power
        autarky_state: 10, // affiché si autarky = energy
        autarkyp_state: 20, // affiché si autarky = power
        ratio_state: 30, // affiché si autarky = energy
        ratiop_state: 40, // affiché si autarky = power
        autarky_text: 'Autarky', // affiché si autarky != no
        ratio_text:'Ratio', // affiché si autarky != no
        model: 'sunsynk',
        voltage_state: false,
        voltage_unit: 'V',
        frequency_state: false,
        frequency_unit: 'Hz',
        current_state: false,
        current_unit: 'A',
        temp:{
          ac_state: false,
          ac_unit: '°C',
          dc_state: false,
          dc_unit: '°C'
        },
        prog: { //--------------- Todo
          show: false,
          charge: 'none', // 'none'
          grid: '', //none
          capacity: 100
        }
      },
      battery: {
        animation_speed: 5,
        energy: false, 
        voltage: {
          show: false,
          state: 0,
          unit: 'V'
        },
        current: {
          show: false,
          state: 0,
          unit: 'A'
        },
        temp: {
          show: false,
          state: 0,
          unit: '°'
        },
        power: {
          show: false,
          state: 0,
          unit: 'W'
        },
        state: {
          show: false,
          state: 100,
          unit: '%'
        },
        daily: {
          show_charge: false,
          show_discharge: false,
          charge_state: 0,
          discharge_state: 0,
          charge_unit: '',
          discharge_unit: '',
          text_charge: 'CHARGE JOUR',
          text_discharge: 'DECHARGE JOUR',
        },
        mppt : {
          power: {
            show: false,
            state: 0,
            unit: 'W'
          },
          energy: {
            show: false,
            state: 0,
            unit: 'Wh'
          },
          name: '',
          voltage: false,
          voltage_unit: 'A',
          current: false,
          current_unit: 0
        },
        full_capacity: 100, // Todo -> param optionnel
        empty_capacity: 0, // Todo -> param optionnel
        soc: {
          shutdown: 0
        },
        icon_perso: false
      },
      solar: {
        animation_speed: 5,
        max_power: false,
        daily: {
          show: false,
          state: 0,
          unit: '',
          text: 'PROD JOUR',
          text_left: 'DAILY SOLAR / LEFT TODAY',
          remaining_show: false,
          remaining_state: 0,
          remaining_unit: 'T'
        },
        mppts: 0,
        pv1: {
          name: '',
          power: 0,
          power_unit: '',
          energy: false,
          energy_unit: '',
          voltage: false,
          voltage_unit: 'A',
          current: false,
          current_unit: 0
        },
        pv2: {
          name: '',
          power: 0,
          power_unit: '',
          energy: false,
          energy_unit: '',
          voltage: false,
          voltage_unit: 'A',
          current: false,
          current_unit: 0
        },
        pv3: {
          name: '',
          power: 0,
          power_unit: '',
          energy: false,
          energy_unit: '',
          voltage: false,
          voltage_unit: 'A',
          current: false,
          current_unit: 0
        },
        pv4: {
          name: '',
          power: 0,
          power_unit: '',
          energy: false,
          energy_unit: '',
          voltage: false,
          voltage_unit: 'A',
          current: false,
          current_unit: 0
        },
        has_pv_power: false,
        power: 0,
        unit: 'W',
        sell: false, // on, off, 1, 0, undefined // Todo        
      },
      load: {
        animation_speed: 5,
        max_power: false,
        power: 0,
        power_unit: 'W',
        daily:{
          show: false,
          text: 'CONSO JOUR',
          state: 0,
          unit: '',
        },
        additional_loads: 0,
        aux: {
          //show_aux: true,
          //show_daily_aux: false,
          //invert_aux: false,
          //aux_name: 'Aux load 1',
          //aux_type: 'default',
          //aux_loads: 0,
          //aux_load1_name: '',
          //aux_load2_name: '',
        },
        load1: {
          power: 0,
          power_unit: 'W',
          energy: false,
          energy_unit: '',
          icon: false,
          name: false,
          max_power: false,
          perso: false,
          perso_unit: ''
        },
        load2: {
          power: 0,
          power_unit: 'W',
          icon: false,
          name: false,
          energy: false,
          energy_unit: '',
          max_power: false,
          perso: false,
          perso_unit: ''
        },
        load3: {
          power: 0,
          power_unit: 'W',
          icon: false,
          name: false,
          energy: false,
          energy_unit: '',
          max_power: false,
          perso: false,
          perso_unit: ''
        },
        load4: {
          power: 0,
          power_unit: 'W',
          icon: false,
          name: false,
          energy: false,
          energy_unit: '',
          max_power: false,
          perso: false,
          perso_unit: ''
        },
        load5: {
          power: 0,
          power_unit: 'W',
          icon: false,
          name: false,
          energy: false,
          energy_unit: '',
          max_power: false,
          perso: false,
          perso_unit: ''
        },
        load6: {
          power: 0,
          power_unit: 'W',
          icon: false,
          name: false,
          energy: false,
          energy_unit: '',
          max_power: false,
          perso: false,
          perso_unit: ''
        },
        load7: {
          power: 0,
          power_unit: 'W',
          icon: false,
          name: false,
          energy: false,
          energy_unit: '',
          max_power: false,
          perso: false,
          perso_unit: ''
        },
        load8: {
          power: 0,
          power_unit: 'W',
          icon: false,
          name: false,
          energy: false,
          energy_unit: '',
          max_power: false,
          perso: false,
          perso_unit: ''
        },
        load9: {
          power: 0,
          power_unit: 'W',
          icon: false,
          name: false,
          energy: false,
          energy_unit: '',
          max_power: false,
          perso: false,
          perso_unit: ''
        },
        load10: {
          power: 0,
          power_unit: 'W',
          icon: false,
          name: false,
          energy: false,
          energy_unit: '',
          max_power: false,
          perso: false,
          perso_unit: ''
        },
        load11: {
          power: 0,
          power_unit: 'W',
          icon: false,
          name: false,
          energy: false,
          energy_unit: '',
          max_power: false,
          perso: false,
          perso_unit: ''
        },
        load12: {
          power: 0,
          power_unit: 'W',
          icon: false,
          name: false,
          energy: false,
          energy_unit: '',
          max_power: false,
          perso: false,
          perso_unit: ''
        },
        has_load_power: false,
        animate_load_enable: true
      },
      grid: {
        animation_speed: 5,
        max_power: false,
        daily: {
          show_sell: false,
          show_buy: false,
          buy_state: 0,
          buy_unit: '',
          sell_state: 0,
          sell_unit: '',
          text_sell: 'VENTE JOUR',
          text_buy: 'ACHAT JOUR'
        },
        energy_cost: false,
        power: 0,
        power_unit:'W',
        status: 1, // on, off, '0', 0, '1', 1
        noness: {
          //show_nonessential: true,
          //nonessential_icon: 'default',
          //nonessential_name: 'nonessential_name',
          //additional_loads: 2,
          //load1_name: 'common.load1', //
          //load2_name: 'common.load2', //
          //load1_icon: 'default',
          //load2_icon: 'default',
        },
        has_grid_power: false,
        //invert_grid: false,           
      },
      aux: {
        type: 'gen',
        max_power: false,
        status: 'on',
        power: 0,
        power_unit: 'W',
        has_aux_power: false,
        animation_speed: 5,
        energy: false,
        daily:{
          show: false,
          text: 'PRODUCTION JOUR',
          state: 0,
          unit: '',
        },
      }
    }
    ////////////////////////////////////////////////////////
    //////////////// PARAMETRES OPTIONNELS /////////////////
    ////////////////////////////////////////////////////////
    /////////////////////// DIVERS /////////////////////////
    if ('#Background#' != '#'+'Background#') document.documentElement.style.setProperty('--background#id#', '#Background#')
    ////////////////////////// Solar ///////////////////////
    if ("#pv1Name#" != '#'+'pv1Name#') config#id#.solar.pv1.name = "#pv1Name#"
    if ("#pv2Name#" != '#'+'pv2Name#') config#id#.solar.pv2.name = "#pv2Name#"
    if ("#pv3Name#" != '#'+'pv3Name#') config#id#.solar.pv3.name = "#pv3Name#"
    if ("#pv4Name#" != '#'+'pv4Name#') config#id#.solar.pv4.name = "#pv4Name#"
    if (is_numeric('#pvMaxPower#')) config#id#.solar.max_power = '#pvMaxPower#'
    if ("#dailySolarText#" != '#'+'dailySolarText#') config#id#.solar.daily.text = "#dailySolarText#"
    if ("#solarColor#" != '#'+'solarColor#') document.documentElement.style.setProperty('--solar_colour#id#', '#solarColor#')
    ////////////////////////// LOAD ////////////////////////
    if ("#load1Name#" != '#'+'load1Name#') config#id#.load.load1.name = "#load1Name#"
    if ("#load1Icon#" != '#'+'load1Icon#') config#id#.load.load1.icon = "#load1Icon#"
    if ("#load1MaxPower#" != '#'+'load1MaxPower#') config#id#.load.load1.max_power = "#load1MaxPower#"
    if ("#load2Name#" != '#'+'load2Name#') config#id#.load.load2.name = "#load2Name#"
    if ("#load2Icon#" != '#'+'load2Icon#') config#id#.load.load2.icon = "#load2Icon#"
    if ("#load2MaxPower#" != '#'+'load2MaxPower#') config#id#.load.load2.max_power = "#load2MaxPower#"
    if ("#load3Name#" != '#'+'load3Name#') config#id#.load.load3.name = "#load3Name#"
    if ("#load3Icon#" != '#'+'load3Icon#') config#id#.load.load3.icon = "#load3Icon#"
    if ("#load3MaxPower#" != '#'+'load3MaxPower#') config#id#.load.load3.max_power = "#load3MaxPower#"
    if ("#load4Name#" != '#'+'load4Name#') config#id#.load.load4.name = "#load4Name#"
    if ("#load4Icon#" != '#'+'load4Icon#') config#id#.load.load4.icon = "#load4Icon#"
    if ("#load4MaxPower#" != '#'+'load4MaxPower#') config#id#.load.load4.max_power = "#load4MaxPower#"
    if ("#load5Name#" != '#'+'load5Name#') config#id#.load.load5.name = "#load5Name#"
    if ("#load5Icon#" != '#'+'load5Icon#') config#id#.load.load5.icon = "#load5Icon#"
    if ("#load5MaxPower#" != '#'+'load5MaxPower#') config#id#.load.load5.max_power = "#load5MaxPower#"
    if ("#load6Name#" != '#'+'load6Name#') config#id#.load.load6.name = "#load6Name#"
    if ("#load6Icon#" != '#'+'load6Icon#') config#id#.load.load6.icon = "#load6Icon#"
    if ("#load6MaxPower#" != '#'+'load6MaxPower#') config#id#.load.load6.max_power = "#load6MaxPower#"
    if ("#load7Name#" != '#'+'load7Name#') config#id#.load.load7.name = "#load7Name#"
    if ("#load7Icon#" != '#'+'load7Icon#') config#id#.load.load7.icon = "#load7Icon#"
    if ("#load7MaxPower#" != '#'+'load7MaxPower#') config#id#.load.load7.max_power = "#load7MaxPower#"
    if ("#load8Name#" != '#'+'load8Name#') config#id#.load.load8.name = "#load8Name#"
    if ("#load8Icon#" != '#'+'load8Icon#') config#id#.load.load8.icon = "#load8Icon#"
    if ("#load8MaxPower#" != '#'+'load8MaxPower#') config#id#.load.load8.max_power = "#load8MaxPower#"
    if ("#load9Name#" != '#'+'load9Name#') config#id#.load.load9.name = "#load9Name#"
    if ("#load9Icon#" != '#'+'load9Icon#') config#id#.load.load9.icon = "#load9Icon#"
    if ("#load9MaxPower#" != '#'+'load9MaxPower#') config#id#.load.load9.max_power = "#load9MaxPower#"
    if ("#load10Name#" != '#'+'load10Name#') config#id#.load.load10.name = "#load10Name#"
    if ("#load10Icon#" != '#'+'load10Icon#') config#id#.load.load10.icon = "#load10Icon#"
    if ("#load10MaxPower#" != '#'+'load10MaxPower#') config#id#.load.load10.max_power = "#load10MaxPower#"
    if ("#load11Name#" != '#'+'load11Name#') config#id#.load.load11.name = "#load11Name#"
    if ("#load11Icon#" != '#'+'load11Icon#') config#id#.load.load11.icon = "#load11Icon#"
    if ("#load11MaxPower#" != '#'+'load11MaxPower#') config#id#.load.load11.max_power = "#load11MaxPower#"
    if ("#load12Name#" != '#'+'load12Name#') config#id#.load.load12.name = "#load12Name#"
    if ("#load12Icon#" != '#'+'load12Icon#') config#id#.load.load12.icon = "#load12Icon#"
    if ("#load12MaxPower#" != '#'+'load12MaxPower#') config#id#.load.load12.max_power = "#load12MaxPower#"
    if ("#loadAnimate#" != '#'+'loadAnimate#' && "#loadAnimate#" == '0') config#id#.load.animate_load_enable = 0
    if ("#dailyLoadText#" != '#'+'dailyLoadText#') config#id#.load.daily.text = "#dailyLoadText#"
    if (is_numeric('#loadMaxPower#')) config#id#.load.max_power = '#loadMaxPower#'
    if ("#loadColor#" != '#'+'loadColor#') document.documentElement.style.setProperty('--load_colour#id#', '#loadColor#')
    if ("#blink#" == 1) config#id#.blink = true
    if ("#colorDanger#" != '#'+'colorDanger#') document.documentElement.style.setProperty('--color_alerte#id#', '#colorDanger#')
    ////////////////////////// GRID ////////////////////////
    if ("#dailyGridSellText#" != '#'+'dailyGridSellText#') config#id#.grid.daily.text_sell = "#dailyGridSellText#"
    if ("#dailyGridBuyText#" != '#'+'dailyGridBuyText#') config#id#.grid.daily.text_buy = "#dailyGridBuyText#"
    if (is_numeric('#gridMaxPower#')) config#id#.grid.max_power = '#gridMaxPower#'
    if ("#gridColor#" != '#'+'gridColor#') document.documentElement.style.setProperty('--grid_colour#id#', '#gridColor#')
    if ("#noGridColor#" != '#'+'noGridColor#') document.documentElement.style.setProperty('--no_grid_colour#id#', '#noGridColor#')
    ////////////////////////// BATTERY /////////////////////
    if ("#batteryIcone#" != '#'+'batteryIcone#') config#id#.battery.icon_perso = '#batteryIcone#'
    if ("#batteryIconeVe#" == '1') config#id#.battery.icon_perso = 've'
    if ("#dailyBatteryChargeText#" != '#'+'dailyBatteryChargeText#') config#id#.battery.daily.text_charge = "#dailyBatteryChargeText#"
    if ("#dailyBatteryDischargeText#" != '#'+'dailyBatteryDischargeText#') config#id#.battery.daily.text_discharge = "#dailyBatteryDischargeText#"
    if (is_numeric('#batteryMaxPower#')) config#id#.battery.energy = '#batteryMaxPower#'
    if (is_numeric('#batterySocShutdown#')) config#id#.battery.soc.shutdown = '#batterySocShutdown#'
    if ("#mpptName#" != '#'+'mpptName#') config#id#.battery.mppt.name = "#mpptName#"
    if ("#batteryColor#" != '#'+'batteryColor#') document.documentElement.style.setProperty('--battery_colour#id#', '#batteryColor#')
    //////////////////////// INVERTER //////////////////////
    if ("#inverterColor#" != '#'+'inverterColor#') document.documentElement.style.setProperty('--inverter_colour#id#', '#inverterColor#')
    if ("#inverterModel#" != '#'+'inverterModel#') config#id#.inverter.model = '#inverterModel#'
    ////////////////////////// AUX /////////////////////////
    if ("#auxColor#" != '#'+'auxColor#') document.documentElement.style.setProperty('--aux_colour#id#', '#auxColor#')
    if (is_numeric('#auxMaxPower#')) config#id#.aux.max_power = '#auxMaxPower#'
   
    jeedom.eqLogic.getCmd({
      id: '#eqLogic_id#',
      async: false,
      success: function (cmds) {
        for (j in cmds) {
          //console.table(cmds[j])
          cmds[j].name = cmds[j].name.toLowerCase();
          cmds[j].name = cmds[j].name.replace(/é/g, 'e');
          cmds[j].name = cmds[j].name.replace(/_/g, ' ');
          let id_eql = cmds[j].id
          let name = cmds[j].name
          let iPv = cmds[j].name[2]
          let re_res = cmds[j].name.match(/\d+/);
          let iLoad = (re_res === null) ? "" : re_res[0];
          //let iLoad = cmds[j].name[4];
          let type = cmds[j].name.split(' ')
          switch (cmds[j].name) {
            ///////////////////////////////////////////////////////////////////////
            ////////////////////////////////  pv power ////////////////////////////
            ///////////////////////////////////////////////////////////////////////
            case 'pv power':
              log#id#('| pv_power')
              config#id#.solar.has_pv_power = true
              jeedom.cmd.execute({
                id: id_eql,
                async: false,
                success:  function(pvValue) {
                  if (cmds[j].unite != '') config#id#.solar.unit = cmds[j].unite
                  config#id#.solar.power = isNaN(parseFloat(pvValue)) ? 0 : parseFloat(pvValue)
                  log#id#('|    └> value : ' + config#id#.solar.power + config#id#.solar.unit)
                }
              })
              jeedom.cmd.addUpdateFunction(cmds[j].id, function(_options) {
                config#id#.solar.power = isNaN(parseFloat(_options.value)) ? 0 : parseFloat(_options.value)
                calculatePv#id#('pv_power')
              })
              break;
            ///////////////////////////////////////////////////////////////////////
            ///////////////////////////////// pvX /////////////////////////////////
            ///////////////////////////////////////////////////////////////////////
            case 'pv1 power':
            case 'pv2 power':
            case 'pv3 power':
            case 'pv4 power':
            case 'pv1 voltage':
            case 'pv2 voltage':
            case 'pv3 voltage':
            case 'pv4 voltage':
            case 'pv1 current':
            case 'pv2 current':
            case 'pv3 current':
            case 'pv4 current':
            case 'pv1 energy':
            case 'pv2 energy':
            case 'pv3 energy':
            case 'pv4 energy':
              log#id#('| pv' + iPv + '_' + type[1])
              jeedom.cmd.execute({
                id: id_eql,
                async: false,
                success:  function(pvValue) {
                  if(iPv == 1 && type[1] == 'power') config#id#.show_solar = true
                  if (type[1] == 'power') config#id#.solar.mppts = Math.max(config#id#.solar.mppts, iPv)
                  config#id#.solar['pv' + iPv][type[1]] = isNaN(parseFloat(pvValue)) ? 0 : parseFloat(pvValue)
                  config#id#.solar['pv' + iPv][type[1] + '_unit'] = cmds[j].unite
                  log#id#('|    └> value : ' + config#id#.solar['pv' + iPv][type[1]] + config#id#.solar['pv' + iPv][type[1] + '_unit'])
                }
              })
              jeedom.cmd.addUpdateFunction(cmds[j].id, function(_options) {
                config#id#.solar['pv' + iPv][type[1]] = isNaN(parseFloat(_options.value)) ? 0 : parseFloat(_options.value)
                let pvEnergy = autoValueArray#id#(config#id#.solar['pv' + iPv][type[1]],config#id#.solar['pv' + iPv][type[1] + '_unit'])
                if (type[1] != 'energy') document.getElementById("pv" + iPv + "_" + type[1] + "#id#").innerHTML = trunc#id#(parseFloat(_options.value), 1) + ' ' + ((type[1] == 'power') ? config#id#.solar.unit : config#id#.solar['pv' + iPv][type[1] + '_unit'])
                else document.getElementById("pv" + iPv + "_" + type[1] + "#id#").innerHTML = trunc#id#(pvEnergy.value, 3, 1) + ' ' + pvEnergy.unit
                if (type[1] == 'power') calculatePv#id#('pv' + iPv + '_power') //&& config#id#.solar.has_pv_power === false
              })
              break;
            ///////////////////////////////////////////////////////////////////////
            /////////////////////////////////  Daily  /////////////////////////////
            ///////////////////////////////////////////////////////////////////////
            case 'daily solar':
            case 'daily load':
            case 'daily aux':
              config#id#[type[1]].daily.show = true
              log#id#('| daily ' + type[1])
              jeedom.cmd.execute({
                id: id_eql,
                async: false,
                success:  function(dailyValue) {
                  config#id#[type[1]].daily.unit = cmds[j].unite
                  config#id#[type[1]].daily.state = isNaN(parseFloat(dailyValue)) ? 0 : parseFloat(dailyValue)
                  log#id#('|    └> value : ' + config#id#[type[1]].daily.state + config#id#[type[1]].daily.unit)
                }
              })
              jeedom.cmd.addUpdateFunction(cmds[j].id, function(_options) {
                let daily = autoValueArray#id#((_options.value != undefined) ? parseFloat(_options.value) : 0,config#id#[type[1]].daily.unit)
                document.getElementById("daily_" + type[1] + "_value#id#").innerHTML = trunc#id#(daily.value, 3, 1) + ' ' + daily.unit
              })
              break;
            case 'daily battery charge':
            case 'daily battery discharge':
            case 'daily grid buy':
            case 'daily grid sell':
              log#id#('| daily ' + type[1] + ' ' + type[2])
              config#id#[type[1]].daily['show_' + type[2]] = true
              jeedom.cmd.execute({
                id: id_eql,
                async: false,
                success:  function(daily) {
                  config#id#[type[1]].daily[type[2] + '_unit'] = cmds[j].unite
                  config#id#[type[1]].daily[type[2] + '_state'] = isNaN(parseFloat(daily)) ? 0 : parseFloat(daily)
                  log#id#('|    └> value : ' + config#id#[type[1]].daily[type[2] + '_state'] + config#id#[type[1]].daily[type[2] + '_unit'])
                }
              })
              jeedom.cmd.addUpdateFunction(cmds[j].id, function(_options) {
                let daily = autoValueArray#id#((_options.value != undefined) ? parseFloat(_options.value) : 0,config#id#[type[1]].daily[type[2] + '_unit'])
                document.getElementById("daily_" + type[1] + "_" + type[2] + "_value#id#").innerHTML = trunc#id#(daily.value, 3, 1) + ' ' + daily.unit
              })
              break;
            ///////////////////////////////////////////////////////////////////////
            ///////////////////////////////  Battery //////////////////////////////
            ///////////////////////////////////////////////////////////////////////
            case 'battery temp':
            case 'battery voltage':
            case 'battery current':
            case 'battery power':
            case 'battery state':
              log#id#('| battery ' + type[1])
              jeedom.cmd.execute({
                id: id_eql,
                async: false,
                success:  function(batteryValue) {
                  config#id#.battery[type[1]].show = true
                  if (cmds[j].unite != '') config#id#.battery[type[1]].unit = cmds[j].unite
                  if (type[1] != 'state') config#id#.battery[type[1]].state = isNaN(parseFloat(batteryValue)) ? 0 : parseFloat(batteryValue)
                  else config#id#.battery[type[1]].state = isNaN(parseFloat(batteryValue)) ? 100 : parseFloat(batteryValue)
                  log#id#('|    └> value : ' + config#id#.battery[type[1]].state + config#id#.battery[type[1]].unit)
                }
              })
              jeedom.cmd.addUpdateFunction(cmds[j].id, function(_options) {
                config#id#.battery[type[1]].state = isNaN(parseFloat(_options.value)) ? 0 : parseFloat(_options.value)
                let batteryValue = (config#id#.battery[type[1]].state < 0) ? config#id#.battery[type[1]].state * -1 : config#id#.battery[type[1]].state
                if (type[1] != 'state') document.getElementById("battery_" + type[1] + "#id#").innerHTML = trunc#id#(parseFloat(batteryValue),1) + ' ' + config#id#.battery[type[1]].unit
                if (type[1] == 'power' || type[1] == 'state') calculateBattery#id#('battery ' + type[1])
              })
              break;
            ///////////////////////////////////////////////////////////////////////
            /////////////////////////  Battery Mppt ///////////////////////////////
            ///////////////////////////////////////////////////////////////////////
            case 'battery mppt power':
            case 'battery mppt energy':
              log#id#('| battery mppt ' + type[2])
              jeedom.cmd.execute({
                id: id_eql,
                async: false,
                success:  function(batteryMppt) {
                  config#id#.battery.mppt[type[2]].show = true
                  if (cmds[j].unite != '') config#id#.battery.mppt[type[2]].unit = cmds[j].unite
                  config#id#.battery.mppt[type[2]].state = isNaN(parseFloat(batteryMppt)) ? 0 : parseFloat(batteryMppt)
                  log#id#('|    └> value : ' + config#id#.battery.mppt[type[2]].state + config#id#.battery.mppt[type[2]].unit)
                }
              })
              jeedom.cmd.addUpdateFunction(cmds[j].id, function(_options) {
                config#id#.battery.mppt[type[2]].state = isNaN(parseFloat(_options.value)) ? 0 : parseFloat(_options.value)
                let batteryValue = autoValueArray#id#(config#id#.battery.mppt[type[2]].state,config#id#.battery.mppt[type[2]].unit)
                if(type[2] == 'energy') document.getElementById("battery-mppt-energy-#id#").innerHTML = trunc#id#(batteryValue.value, 3, 1) + ' ' + batteryValue.unit
                if(type[2] == 'power') {
                  document.getElementById("battery_mppt_" + type[2] + "-#id#").innerHTML = config#id#.battery.mppt[type[2]].state + ' ' + config#id#.battery.mppt[type[2]].unit
                  if(config#id#.battery.mppt[type[2]].state > 0) document.getElementById("dot-battery-mppt-#id#").setAttribute("fill", "var(--solar_colour#id#)")
                  else document.getElementById("dot-battery-mppt-#id#").setAttribute("fill", "transparent")
                  calculateBattery#id#('battery mppt power')
                }
              })
              break;
            ///////////////////////////////////////////////////////////////////////
            ///////////////////////////  Grid Status //////////////////////////////
            ///////////////////////////////////////////////////////////////////////
            case 'grid status':
              log#id#('| grid status')
              jeedom.cmd.execute({
                id: id_eql,
                async: false,
                success:  function(gridStatus) {
                  log#id#('|    └> cmd.execute : ' + gridStatus)
                  if (gridStatus === 0 || gridStatus === '0' || gridStatus === 'off') config#id#.grid.status = 0
                  else config#id#.grid.status = 1
                }
              })
              jeedom.cmd.addUpdateFunction(cmds[j].id, function(_options) {
                if (_options.value === 0 || _options.value === '0' || _options.value === 'off') {
                  document.getElementById("transmission_on#id#").querySelector('path').classList.add("hidden-#id#");
                  document.getElementById("transmission_off#id#").querySelector('path').classList.remove("hidden-#id#");
                }
                else {
                  document.getElementById("transmission_on#id#").querySelector('path').classList.remove("hidden-#id#");
                  document.getElementById("transmission_off#id#").querySelector('path').classList.add("hidden-#id#");
                }
              })
              break;
            ///////////////////////////////////////////////////////////////////////
            //////////////////////////  AC / DC Temp //////////////////////////////
            ///////////////////////////////////////////////////////////////////////    
            case 'ac temp':
            case 'dc temp':
              log#id#('| ' + type[0] + ' temp')
              jeedom.cmd.execute({
                id: id_eql,
                async: false,
                success:  function(temp) {
                  config#id#.inverter.temp[type[0] + '_state'] = isNaN(parseFloat(temp)) ? 0 : parseFloat(temp)
                  if (cmds[j].unite != '') config#id#.inverter.temp[type[0] + '_unit'] = cmds[j].unite
                  log#id#('|    └> value : ' + config#id#.inverter.temp[type[0] + '_state'] + config#id#.inverter.temp[type[0] + '_unit'])
                }
              })
              jeedom.cmd.addUpdateFunction(cmds[j].id, function(_options) {
                config#id#.inverter.temp[type[0] + '_state'] = isNaN(parseFloat(_options.value)) ? 0 : parseFloat(_options.value)
                document.getElementById(type[0] + "_temp#id#").innerHTML = trunc#id#(config#id#.inverter.temp[type[0] + '_state'], 1) + ' ' + config#id#.inverter.temp[type[0] + '_unit']
              })
              break;
            ///////////////////////////////////////////////////////////////////////
            /////////////////////////////  Inverter ///////////////////////////////
            ///////////////////////////////////////////////////////////////////////
            case 'voltage state':
            case 'frequency state':
            case 'current state':
              log#id#('| ' + type[0] + ' state')
              jeedom.cmd.execute({
                id: id_eql,
                async: false,
                success:  function(value) {
                  config#id#.inverter[type[0] + '_state'] = isNaN(parseFloat(value)) ? 0 : parseFloat(value)
                  if (cmds[j].unite != '') config#id#.inverter[type[0] + '_unit'] = cmds[j].unite
                  log#id#('|    └> value : ' + config#id#.inverter[type[0] + '_state'] + config#id#.inverter[type[0] + '_unit'])
                }
              })
              jeedom.cmd.addUpdateFunction(cmds[j].id, function(_options) {
                config#id#.inverter[type[0] + '_state'] = isNaN(parseFloat(_options.value)) ? 0 : parseFloat(_options.value)
                document.getElementById("inverter_" + type[0] + "#id#").innerHTML = trunc#id#(config#id#.inverter[type[0] + '_state'], 1) + ' ' + config#id#.inverter[type[0] + '_unit']
              })
              break;
            ///////////////////////////////////////////////////////////////////////
            //////////////////////////////  Power /////////////////////////////////
            ///////////////////////////////////////////////////////////////////////
            case 'load state':
            case 'load power':
            case 'aux power':
            case 'grid power':  
              log#id#('| ' + type[0] + ' ' + type[1])
              config#id#[type[0]]['has_' + type[0] + '_power'] = true
              jeedom.cmd.execute({
                id: id_eql,
                async: false,
                success:  function(value) {
                  if (cmds[j].unite != '') config#id#[type[0]].power_unit = cmds[j].unite
                  config#id#[type[0]].power = isNaN(parseFloat(value)) ? 0 : parseFloat(value)
                  log#id#('|    └> value : ' + config#id#[type[0]].power + config#id#[type[0]].power_unit)
                  log#id#('|    └> max_power : '  + config#id#[type[0]].max_power)
                }
              })
              jeedom.cmd.addUpdateFunction(cmds[j].id, function(_options) {
                config#id#[type[0]].power = isNaN(parseFloat(_options.value)) ? 0 : parseFloat(_options.value)
                let PowerTrunc = trunc#id#(config#id#[type[0]].power, 1)
                let PowerAbs = (PowerTrunc > 0) ? PowerTrunc : (PowerTrunc < 0) ? (PowerTrunc * -1) : PowerTrunc
                document.getElementById(type[0] + "_power#id#").innerHTML = PowerAbs + ' ' + config#id#[type[0]].power_unit
                if (config#id#[type[0]].max_power && config#id#[type[0]].power >= config#id#[type[0]].max_power) {
                  document.getElementById(type[0] + "-rect-#id#").setAttribute("stroke", "var(--color_alerte#id#)")
                  if (config#id#.blink) document.getElementById(type[0] + "-rect-#id#").classList.add("blink#id#")
                }
                else {
                  document.getElementById(type[0] + "-rect-#id#").setAttribute("stroke", "var(--" + type[0] + "_colour#id#)")
                  if (config#id#.blink) document.getElementById(type[0] + "-rect-#id#").classList.remove("blink#id#")
                }
                if (type[0] == 'load') calculateLoad#id#('load state')
                if (type[0] == 'aux') calculateAux#id#('aux power')
                if (type[0] == 'grid') {
                  if(PowerTrunc > 0) {
                    document.getElementById("grid-dot-buy#id#").setAttribute("fill", "var(--grid_colour#id#)");
                    document.getElementById("grid-dot1-buy#id#").setAttribute("fill", "var(--grid_colour#id#)");
                    document.getElementById("grid-dot-sell#id#").setAttribute("fill", "transparent");
                    document.getElementById("grid-dot1-sell#id#").setAttribute("fill", "transparent");
                  }
                  else if(PowerTrunc < 0) {
                    document.getElementById("grid-dot-buy#id#").setAttribute("fill", "transparent");
                    document.getElementById("grid-dot1-buy#id#").setAttribute("fill", "transparent");
                    document.getElementById("grid-dot-sell#id#").setAttribute("fill", "var(--grid_colour#id#)");
                    document.getElementById("grid-dot1-sell#id#").setAttribute("fill", "var(--grid_colour#id#)");
                  }
                  else {
                    document.getElementById("grid-dot-buy#id#").setAttribute("fill", "transparent");
                    document.getElementById("grid-dot1-buy#id#").setAttribute("fill", "transparent");
                    document.getElementById("grid-dot-sell#id#").setAttribute("fill", "transparent");
                    document.getElementById("grid-dot1-sell#id#").setAttribute("fill", "transparent");
                  }
                  calculateGrid#id#('grid power')
                }
              })
              break;
            ///////////////////////////////////////////////////////////////////////
            ////////////////////////////////  Load  ///////////////////////////////
            ///////////////////////////////////////////////////////////////////////
            case 'load1 state':
            case 'load1 power':
            case 'load2 state':
            case 'load2 power':
            case 'load3 state':
            case 'load3 power':
            case 'load4 state':
            case 'load4 power':
            case 'load5 state':
            case 'load5 power':
            case 'load6 state':
            case 'load6 power':
            case 'load7 state':
            case 'load7 power':
            case 'load8 state':
            case 'load8 power':
            case 'load9 state':
            case 'load9 power':
            case 'load10 state':
            case 'load10 power':
            case 'load11 state':
            case 'load11 power':
            case 'load12 state':
            case 'load12 power':
            case 'load1 energy':
            case 'load2 energy':
            case 'load3 energy':
            case 'load4 energy':
            case 'load5 energy':
            case 'load6 energy':
            case 'load7 energy':
            case 'load8 energy':
            case 'load9 energy':
            case 'load10 energy':
            case 'load11 energy':
            case 'load12 energy':
            case 'load1 perso':
            case 'load2 perso':
            case 'load3 perso':
            case 'load4 perso':
            case 'load5 perso':
            case 'load6 perso':
            case 'load7 perso':
            case 'load8 perso':
            case 'load9 perso':
            case 'load10 perso':
            case 'load11 perso':
            case 'load12 perso':
              if (type[1] == 'state') type[1] = 'power' // workaround pour ne pas modifier le nom équipements d'origines.
              log#id#('| load' + iLoad + ' ' + type[1])
              if (type[1] == 'power') config#id#.load.additional_loads = Math.max(config#id#.load.additional_loads, iLoad)
              jeedom.cmd.execute({
                id: id_eql,
                async: false,
                success:  function(loadState) {
                  config#id#.load['load' + iLoad][type[1]] = isNaN(parseFloat(loadState)) ? 0 : parseFloat(loadState)
                  if (cmds[j].unite != '') config#id#.load['load' + iLoad][type[1] + '_unit'] = cmds[j].unite
                  log#id#('|    └> value : ' + config#id#.load['load' + iLoad][type[1]] + config#id#.load['load' + iLoad][type[1] + '_unit'])
                  if (type[1] == 'power' && config#id#.load['load' + iLoad].max_power) log#id#('|    └> max_power : '  + config#id#.load['load' + iLoad].max_power)
                }
              })
              jeedom.cmd.addUpdateFunction(cmds[j].id, function(_options) {
                config#id#.load['load' + iLoad][type[1]] = isNaN(parseFloat(_options.value)) ? 0 : parseFloat(_options.value)
                if (type[1] != 'perso') config#id#.load['load' + iLoad][type[1]] = trunc#id#(config#id#.load['load' + iLoad][type[1]], 1)
                if (type[1] == 'power'){
                  document.getElementById("ess_load" + iLoad + "#id#").innerHTML = config#id#.load['load' + iLoad][type[1]] + ' ' + config#id#.load['load' + iLoad][type[1] + '_unit']
                  if (config#id#.load.has_load_power === false) calculateLoad#id#('load' + iLoad + ' state')
                  if (config#id#.load['load' + iLoad][type[1]] > 0) document.getElementById("es-dot" + iLoad + "-#id#").setAttribute("fill", "var(--load_colour#id#)")
                  else document.getElementById("es-dot" + iLoad + "-#id#").setAttribute("fill", "transparent")
                  if (config#id#.load['load' + iLoad].max_power && config#id#.load['load' + iLoad].power >= config#id#.load['load' + iLoad].max_power)
                  {
                    document.getElementById("load" + iLoad + "-rect-#id#").setAttribute("stroke", "var(--color_alerte#id#)")
                    if (config#id#.blink) document.getElementById("load" + iLoad + "-rect-#id#").classList.add("blink#id#")
                  }
                  else 
                  {
                    document.getElementById("load" + iLoad + "-rect-#id#").setAttribute("stroke", "var(--load_colour#id#)")
                    if (config#id#.blink) document.getElementById("load" + iLoad + "-rect-#id#").classList.remove("blink#id#")
                  }
                } else if (type[1] == 'energy') {
                  let loadEnergy = autoValueArray#id#(config#id#.load['load' + iLoad][type[1]],config#id#.load['load' + iLoad][type[1] + '_unit'])
                  document.getElementById("load" + iLoad + "_" + type[1] + "#id#").innerHTML = trunc#id#(loadEnergy.value, 3, 1) + ' ' + loadEnergy.unit
                } else { // perso
                  document.getElementById("load" + iLoad + "_" + type[1] + "#id#").innerHTML = config#id#.load['load' + iLoad][type[1]] + ' ' + config#id#.load['load' + iLoad][type[1] + '_unit']
                }
              })
              break;
            /*
            ///////////////////////////////////////////////////////////////////////
            ///////////////////////////  Energy cost //////////////////////////////
            ///////////////////////////////////////////////////////////////////////
            case 'energy cost':
              log#id#('| energy cost')
              jeedom.cmd.execute({
                id: id_eql,
                async: false,
                success:  function(energyCost) {
                  log#id#('|    └> cmd.execute : ' + energyCost)
                  config#id#.grid.energy_cost = (typeof energyCost === "number") ? trunc#id#(parseFloat(energyCost), 2) : 0
                }
              })
              jeedom.cmd.addUpdateFunction(cmds[j].id, function(_options) {
                document.getElementById("energy_cost#id#").innerHTML = trunc#id#((_options.value != undefined) ? parseFloat(_options.value) : 0, 2) + '€'
              })
              break;
            */
          default: //else {
            if (name != 'rafraichir' && name != 'widget') log#id#('| ----------------> /!\\ le nom de la commande ' + name + '[' + id_eql + '] est inconnu')
          break;//}
          }
        }
      }
    })
    log#id#('└──────────────────────────────────────────────────────')
    
    init#id#(true)
    
    function init#id#(init=true,el='') {
      log#id#('┌─────────────────── Widget Distribution Onduleur [#id#] en debug [init()] ───────────────')
      var ElDomExist = !!document.getElementById("widget#id#");
      log#id#('| ElDomExist ? ' + ElDomExist)
      if (ElDomExist) {
        if (el != '') log#id#('| | launched by ' + el)
        if (init) {
          var html = '<div class="container#id# card#id#">';
          //html += '<svg viewBox="-0.5 ' + ((config#id#.show_solar === false) ? ((config#id#.load.additional_loads >= 1) ? '110' : '145') : ((config#id#.solar.mppts == 1) ? '65' : '-0.5'))
          html += '<svg viewBox="-0.5 ' + ((config#id#.show_solar === false) ? ((config#id#.load.additional_loads >= 1) ? '110' : '145') : ((config#id#.solar.mppts == 1) ? '65' : '-0.5'))
          if (config#id#.load.additional_loads == 1 || config#id#.load.additional_loads == 2) html += ' 500'
          else if (config#id#.load.additional_loads == 3 || config#id#.load.additional_loads == 4) html += ' 560'
          else if (config#id#.load.additional_loads == 5 || config#id#.load.additional_loads == 6) html += ' 650'
          else if (config#id#.load.additional_loads == 7 || config#id#.load.additional_loads == 8) html += ' 740'
          else if (config#id#.load.additional_loads == 9 || config#id#.load.additional_loads == 10) html += ' 830'
          else if (config#id#.load.additional_loads == 11 || config#id#.load.additional_loads == 12) html += ' 920'
          else html += ' 500'
          
          html += ((config#id#.show_solar === false) ? ((config#id#.load.additional_loads >= 1) ? ' 292' : ' 270') : ((config#id#.solar.mppts == 1) ? ' 340' : ' 406'))
          html += '" preserveAspectRatio="xMidYMid meet" height="'
          
          if (config#id#.panel_mode === false) {
            if (config#id#.show_solar === false) html += '246px'
            else html += config#id#.card_height
          } else if (config#id#.show_solar === false) html += '75%'
          else html += '100%'
          html += '" width="100%"  xmlns:xlink="http://www.w3.org/1999/xlink" version="1.1">'
          ///////////////////////////////////////////////////////
          /////////////////////// PV ////////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- PV -->'
          html += '<rect x="205" y="128.5" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="var(--solar_colour#id#)" pointer-events="all" class="' + ((config#id#.show_solar === false || config#id#.solar.mppts == 1) ? 'hidden-#id#' : '') + '"/>'
          html += '<text id="pvtotal_power#id#" x="238.8" y="148" class="ft12-#id# ftw-#id# center-align#id#" display="' + ((config#id#.show_solar === false || config#id#.solar.mppts == 1) ? 'none' : '') + '" fill="var(--solar_colour#id#)"></text>'
          // LINE
          html += '<path id="so-line#id#" d="M 239 196 L 239 158" class="' + ((config#id#.show_solar === false) ? 'hidden-#id#' : '') + '" fill="none" stroke="var(--solar_colour#id#)" stroke-width="1" stroke-miterlimit="10"  pointer-events="stroke"/>'
          html += '<circle id="so-dot#id#" cx="0" cy="0" r="3" class="' + ((config#id#.show_solar === false) ? 'hidden-#id#' : '') + '" fill="transparent">'
          html += '<animateMotion id="anim_pv#id#" dur="' + config#id#.solar.animation_speed + 's" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear">'
          html += '<mpath xlink:href="#so-line#id#"/></animateMotion></circle>'
          // ICON
          html += '<svg xmlns="http://www.w3.org/2000/svg" id="icon_sun#id#" x="' + ((config#id#.solar.daily.show === false) ? '220' : '180') + '" y="' + ((config#id#.solar.mppts == 1) ? '70' : '10') + '" width="40" height="40" viewBox="0 0 24 24"><path class="' + ((config#id#.show_solar === false) ? 'hidden-#id#' : '') + '" fill="var(--solar_colour#id#)" d="M11.45 2v3.55L15 3.77L11.45 2m-1 6L8 10.46l3.75 1.25L10.45 8M2 11.45L3.77 15l1.78-3.55H2M10 2H2v8c.57.17 1.17.25 1.77.25c3.58.01 6.49-2.9 6.5-6.5c-.01-.59-.1-1.18-.27-1.75m7 20v-6h-3l5-9v6h3l-5 9Z"/></svg>'
          // DAILY
          let dailySolar = autoValueArray#id#(config#id#.solar.daily.state,config#id#.solar.daily.unit)
          html += '<text id="daily_solar_value#id#" x="226" y="' + ((config#id#.solar.mppts == 1) ? '85' : '26') + '" class="ft16-#id# left-align#id#" display="'
          html += (config#id#.solar.daily.show !== true || config#id#.show_solar === false || config#id#.solar.daily.remaining_show != false) ? 'none' : ''
          html += '" fill="var(--solar_colour#id#)">'
          html += trunc#id#(dailySolar.value, 3, 1) + ' ' + dailySolar.unit
          html += '</text>'
          html += '<text id="daily_solar#id#" x="226" y="' + ((config#id#.solar.mppts == 1) ? '100' : '40') + '" class="ft9-#id# left-align#id#" fill="' + ((config#id#.solar.daily.show !== true || config#id#.show_solar === false || config#id#.solar.daily.remaining_show != false) ? 'transparent' : 'var(--solar_colour#id#)') + '">' + config#id#.solar.daily.text + '</text>'
          ///////////////////////////////////////////////////////
          ////////////////////// PV1 ////////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- PV1 -->'
          html += '<rect id="pv1-rect-#id#" x="' + ((config#id#.solar.mppts == 1) ? '205' : '154') + '" y="' + ((config#id#.solar.mppts == 1) ? '128.5' : '64.5') + '" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="var(--solar_colour#id#)" pointer-events="all" class="' + ((config#id#.show_solar === false) ? 'hidden-#id#' : '') + '"/>'
          html += '<text x="' + ((config#id#.solar.mppts == 1) ? '240' : '187') + '" y="' + ((config#id#.solar.mppts == 1) ? '122' : '60') + '" class="ft9-#id# ftw-#id# center-align#id#" display="' + ((config#id#.show_solar === false) ? 'none' : '') + '" fill="var(--solar_colour#id#)">' + config#id#.solar.pv1.name + '</text>'
          html += '<text id="pv1_power#id#" x="' + ((config#id#.solar.mppts == 1) ? '238.8' : '188.1')
          html += '" y="' + ((config#id#.solar.pv1.energy === false) ? ((config#id#.solar.mppts == 1) ? '148' : '84') : ((config#id#.solar.mppts == 1) ? '143' : '79')) + '" class="ft12-#id#'
          html += ' ftw-#id# center-align#id#" display="' + ((config#id#.show_solar === false) ? 'none' : '') + '" fill="var(--solar_colour#id#)">' + trunc#id#(config#id#.solar.pv1.power, 1) + ' ' + config#id#.solar.unit + '</text>'
          // ENERGY
          let pv1_energy = autoValueArray#id#((config#id#.solar.pv1.energy || 0),config#id#.solar.pv1.energy_unit)
          html += '<text id="pv1_energy#id#" x="' + ((config#id#.solar.mppts == 1) ? '238.8' : '188.1') + '" y="' + (config#id#.solar.mppts == 1 ? '154' : '90') + '" class="ft8-#id# center-align#id#" display="'
          html += (config#id#.show_solar === false || config#id#.solar.pv1.energy === false || config#id#.solar.mppts === 0) ? 'none' : ''
          html += '" fill="var(--solar_colour#id#)">'
          html += trunc#id#(pv1_energy.value, 3, 1) + ' ' + pv1_energy.unit
          html += '</text>'
          // VOLTAGE
          html += '<text id="pv1_voltage#id#" x="' + ((config#id#.solar.mppts == 1) ? '235' : '181') + '" y="'+ ((config#id#.solar.pv1.current === false) ? ((config#id#.solar.mppts == 1) ? '172' : '106') : ((config#id#.solar.mppts == 1) ? '184' : '118'))
          html += '" class="ft9-#id# right-align#id#" display="' + ((config#id#.show_solar === false || config#id#.solar.pv1.voltage === false || config#id#.solar.mppts < 1) ? 'none' : '') + '" fill="var(--solar_colour#id#)" >' + trunc#id#(config#id#.solar.pv1.voltage, 1) + ' ' + config#id#.solar.pv1.voltage_unit + '</text>'
          // CURRENT
          html += '<text id="pv1_current#id#" x="' + ((config#id#.solar.mppts == 1) ? '235' : '181') + '" y="' + ((config#id#.solar.mppts == 1) ? '172' : '106') + '" class="ft9-#id# right-align#id#" display="'
          html += (config#id#.show_solar === false || config#id#.solar.pv1.current === false) ? 'none' : ''
          html += '" fill="var(--solar_colour#id#)" >' + trunc#id#(config#id#.solar.pv1.current, 1) + ' ' + config#id#.solar.pv1.current_unit + '</text>'
          // LINE
          html += '<path id="pv1-line#id#" d="M 187 95 L 187 132 Q 187 144 195 144 L 205 144" class="' + ((config#id#.show_solar === false || config#id#.solar.mppts === 1) ? 'hidden-#id#' : '') + '" fill="none" stroke="var(--solar_colour#id#)" stroke-width="1" stroke-miterlimit="10"  pointer-events="stroke"/>'
          html += '<circle id="pv1-dot#id#" cx="0" cy="0" r="3" class="' + ((config#id#.show_solar === false || config#id#.solar.mppts === 1) ? 'hidden-#id#' : '') + '" fill="transparent">'
          html += '<animateMotion id="anim_pv1#id#" dur="' + config#id#.solar.animation_speed + 's" repeatCount="indefinite" keyPoints="0;1" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#pv1-line#id#"/></animateMotion></circle>'
          ///////////////////////////////////////////////////////
          ////////////////////// PV2 ////////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- PV2 -->'
          html += '<rect id="pv2-rect-#id#" x="254" y="64.5" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="var(--solar_colour#id#)" pointer-events="all" class="' + ((config#id#.show_solar === false || config#id#.solar.mppts < 2) ? 'hidden-#id#' : '') + '"/>'
          html += '<text x="288" y="60" class="ft9-#id# ftw-#id# center-align#id#" display="' + ((config#id#.show_solar === false || config#id#.solar.mppts < 2) ? 'none' : '') + '" fill="var(--solar_colour#id#)">' + config#id#.solar.pv2.name + '</text>'
          html += '<text id="pv2_power#id#" x="289.5" y="' + ((config#id#.solar.pv2.energy === false) ? '84' : '79') + '" class="ft12-#id# ftw-#id# center-align#id#" display="'
          html += (config#id#.show_solar === false || config#id#.solar.mppts < 2) ? 'none' : ''
          html += '" fill="var(--solar_colour#id#)">' + trunc#id#(config#id#.solar.pv2.power, 1) + ' ' + config#id#.solar.unit + '</text>'
          // ENERGY
          let pv2_energy = autoValueArray#id#((config#id#.solar.pv2.energy || 0),config#id#.solar.pv2.energy_unit)
          html += '<text id="pv2_energy#id#" x="289.5" y="90" class="ft8-#id# center-align#id#" display="' + ((config#id#.show_solar === false || config#id#.solar.pv2.energy === false || config#id#.solar.mppts < 2) ? 'none' : '') + '" fill="var(--solar_colour#id#)">'
          html += trunc#id#(pv2_energy.value, 3, 1) + ' ' + pv2_energy.unit
          html += '</text>'
          // VOLTAGE
          html += '<text id="pv2_voltage#id#" x="284" y="' + ((config#id#.solar.pv2.current === false) ? '106' : '118') + '" class="ft9-#id# right-align#id#" display="' + ((config#id#.show_solar === false || config#id#.solar.pv2.voltage === false || config#id#.solar.mppts < 2) ? 'none' : '') + '" fill="var(--solar_colour#id#)" >' + trunc#id#(config#id#.solar.pv2.voltage, 1) + ' ' + config#id#.solar.pv2.voltage_unit + '</text>'
          // CURRENT
          html += '<text id="pv2_current#id#" x="284" y="106" class="ft9-#id# right-align#id#" display="' + ((config#id#.show_solar === false || config#id#.solar.pv2.current === false || config#id#.solar.mppts < 2) ? 'none' : '') + '" fill="var(--solar_colour#id#)" >' + trunc#id#(config#id#.solar.pv2.current, 1) + ' ' + config#id#.solar.pv2.current_unit + '</text>'
          // LINE
          html += '<path id="pv2-line#id#" d="M 289 95 L 289 135 Q 289 144 282 144 L 275 144" class="' + ((config#id#.show_solar === false || config#id#.solar.mppts < 2) ? 'hidden-#id#' : '') + '" fill="none" stroke="var(--solar_colour#id#)" stroke-width="1" stroke-miterlimit="10"  pointer-events="stroke"/>'
          html += '<circle id="pv2-dot#id#" cx="0" cy="0" r="3" class="' + ((config#id#.show_solar === false || config#id#.solar.mppts < 2) ? 'hidden-#id#' : '') + '" fill="transparent">'
          html += '<animateMotion id="anim_pv2#id#" dur="' + config#id#.solar.animation_speed + 's" repeatCount="indefinite" keyPoints="0;1" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#pv2-line#id#"/></animateMotion></circle>'
          ///////////////////////////////////////////////////////
          ////////////////////// PV3 ////////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- PV3 -->'
          html += '<rect id="pv3-rect-#id#" x="78" y="64.5" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="var(--solar_colour#id#)" pointer-events="all" class="' + ((config#id#.show_solar === false  || config#id#.solar.mppts < 3) ? 'hidden-#id#' : '') + '"/>'
          html += '<text x="112" y="60" class="ft9-#id# ftw-#id# center-align#id#" display="' + ((config#id#.show_solar === false || config#id#.solar.mppts < 3) ? 'none' : '') + '" fill="var(--solar_colour#id#)">' + config#id#.solar.pv3.name + '</text>'
          html += '<text id="pv3_power#id#" x="113" y="' + ((config#id#.solar.pv3.energy === false) ? '84' : '79') + '" class="ft12-#id# ftw-#id# center-align#id#" display="'
          html += (config#id#.show_solar === false || config#id#.solar.mppts < 3) ? 'none' : ''
          html += '" fill="var(--solar_colour#id#)">' + trunc#id#(config#id#.solar.pv3.power, 1) + ' ' + config#id#.solar.unit + '</text>'
          // ENERGY
          let pv3_energy = autoValueArray#id#((config#id#.solar.pv3.energy || 0),config#id#.solar.pv3.energy_unit)
          html += '<text id="pv3_energy#id#" x="113" y="90" class="ft8-#id# center-align#id#" display="' + ((config#id#.show_solar === false || config#id#.solar.pv3.energy === false || config#id#.solar.mppts < 3) ? 'none' : '') + '" fill="var(--solar_colour#id#)">'
          html += trunc#id#(pv3_energy.value, 3, 1) + ' ' + pv3_energy.unit
          html += '</text>'
          // VOLTAGE
          html += '<text id="pv3_voltage#id#" x="107" y="' + ((config#id#.solar.pv3.current === false) ? '106' : '118') + '" class="ft9-#id# right-align#id#" display="' + ((config#id#.show_solar === false || config#id#.solar.pv3.voltage === false || config#id#.solar.mppts < 3) ? 'none' : '') + '" fill="var(--solar_colour#id#)" >' + trunc#id#(config#id#.solar.pv3.voltage, 1) + ' ' + config#id#.solar.pv3.voltage_unit + '</text>'
          // CURRENT
          html += '<text id="pv3_current#id#" x="107" y="106" class="ft9-#id# right-align#id#" display="' + ((config#id#.show_solar === false || config#id#.solar.pv3.current === false || config#id#.solar.mppts < 3) ? 'none' : '') + '" fill="var(--solar_colour#id#)" >' + trunc#id#(config#id#.solar.pv3.current, 1) + ' ' + config#id#.solar.pv3.current_unit + '</text>'
          // LINE
          html += '<path id="pv3-line#id#" d="M 113 95 L 113 135 Q 113 144 120 144 L 205 144" class="' + ((config#id#.show_solar === false || config#id#.solar.mppts < 3) ? 'hidden-#id#' : '') + '" fill="none" stroke="var(--solar_colour#id#)" stroke-width="1" stroke-miterlimit="10"  pointer-events="stroke"/>'
          html += '<circle id="pv3-dot#id#" cx="0" cy="0" r="3" class="' + ((config#id#.show_solar === false || config#id#.solar.mppts < 3) ? 'hidden-#id#' : '') + '" fill="transparent">'
          html += '<animateMotion id="anim_pv3#id#" dur="' + config#id#.solar.animation_speed + 's" repeatCount="indefinite" keyPoints="0;1" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#pv3-line#id#"/></animateMotion></circle>'
          ///////////////////////////////////////////////////////
          ////////////////////// PV4 ////////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- PV4 -->'
          html += '<rect id="pv4-rect-#id#" x="330" y="64.5" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="var(--solar_colour#id#)" pointer-events="all" class="' + ((config#id#.show_solar === false || config#id#.solar.mppts < 4) ? 'hidden-#id#' : '') + '"/>'
          html += '<text x="364" y="60" class="ft9-#id# ftw-#id# center-align#id#" display="' + ((config#id#.show_solar === false || config#id#.solar.mppts < 4) ? 'none' : '') + '" fill="var(--solar_colour#id#)">' + config#id#.solar.pv4.name + '</text>'
          html += '<text id="pv4_power#id#" x="366" y="' + ((config#id#.solar.pv4.energy === false) ? '84' : '79') + '" class="ft12-#id# ftw-#id# center-align#id#" display="'
          html += (config#id#.show_solar === false || config#id#.solar.mppts < 4) ? 'none' : ''
          html += '" fill="var(--solar_colour#id#)">' + trunc#id#(config#id#.solar.pv4.power, 1) + ' ' + config#id#.solar.unit + '</text>'
          // ENERGY
          let pv4_energy = autoValueArray#id#((config#id#.solar.pv4.energy || 0),config#id#.solar.pv4.energy_unit)
          html += '<text id="pv4_energy#id#" x="366" y="90" class="ft8-#id# center-align#id#" display="' + ((config#id#.show_solar === false || config#id#.solar.pv4.energy === false  || config#id#.solar.mppts < 4) ? 'none' : '') + '" fill="var(--solar_colour#id#)">'
          html += trunc#id#(pv4_energy.value, 3, 1) + ' ' + pv4_energy.unit
          html += '</text>'
          // VOLTAGE
          html += '<text id="pv4_voltage#id#" x="360" y="' + ((config#id#.solar.pv4.current === false) ? '106' : '118') + '" class="ft9-#id# right-align#id#" display="' + ((config#id#.show_solar === false || config#id#.solar.pv4.voltage === false || config#id#.solar.mppts < 4) ? 'none' : '') + '" fill="var(--solar_colour#id#)" >' + trunc#id#(config#id#.solar.pv4.voltage, 1) + ' ' + config#id#.solar.pv4.voltage_unit + '</text>'
          // CURRENT
          html += '<text id="pv4_current#id#" x="360" y="106" class="ft9-#id# right-align#id#" display="' + ((config#id#.show_solar === false || config#id#.solar.pv4.current === false || config#id#.solar.mppts < 4) ? 'none' : '') + '" fill="var(--solar_colour#id#)" >' + trunc#id#(config#id#.solar.pv4.current, 1) + ' ' + config#id#.solar.pv4.current_unit + '</text>'
          // LINE
          html += '<path id="pv4-line#id#" d="M 365 95 L 365 135 Q 365 144 358 144 L 275 144" class="' + ((config#id#.show_solar === false || config#id#.solar.mppts < 4) ? 'hidden-#id#' : '') + '" fill="none" stroke="var(--solar_colour#id#)" stroke-width="1" stroke-miterlimit="10"  pointer-events="stroke"/>'
          html += '<circle id="pv4-dot#id#" cx="0" cy="0" r="3" class="' + ((config#id#.show_solar === false || config#id#.solar.mppts < 4) ? 'hidden-#id#' : '') + '" fill="transparent">'
          html += '<animateMotion id="anim_pv4#id#" dur="' + config#id#.solar.animation_speed + 's" repeatCount="indefinite" keyPoints="0;1" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#pv4-line#id#"/></animateMotion></circle>'
          ///////////////////////////////////////////////////////
          ////////////////////// Load ///////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- Load -->'
          html += '<rect id="load-rect-#id#" x="304" y="213.5" width="70" height="30" rx="4.5" ry="4.5" class="' + ((config#id#.load.additional_loads >= 1 || config#id#.load.has_load_power) ? '' : 'hidden-#id#') + '" fill="none" stroke="var(--load_colour#id#)" pointer-events="all"/>'
          html += '<text id="load_power#id#" x="338.1" y="232.2" display="' + ((config#id#.load.additional_loads >= 1 || config#id#.load.has_load_power) ? '' : 'none') + '" class="ft12-#id# ftw-#id# center-align#id#" fill="var(--load_colour#id#)">' + trunc#id#(config#id#.load.power, 1) + ' ' + config#id#.load.power_unit + '</text>'
          // LINE LOAD
          html += '<path id="es-line#id#" class="' + ((config#id#.load.additional_loads >= 1 || config#id#.load.has_load_power) ? '' : 'hidden-#id#') + '" d="M 304 228 L 264.7 228" fill="none" stroke="var(--load_colour#id#)" stroke-width="1" stroke-miterlimit="10"  pointer-events="stroke"/>'
          html += '<circle id="es-dot1#id#" cx="0" cy="0" r="3" fill="transparent">'
          html += '<animateMotion id="anim_load1#id#" dur="' + config#id#.load.animation_speed + 's" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear">'
          html += '<mpath xlink:href="#es-line#id#"/></animateMotion></circle>'
          html += '<path id="es-line1#id#" class="' + ((config#id#.load.additional_loads >= 1 || config#id#.load.has_load_power) ? '' : 'hidden-#id#') + '" d="M 374 228 L 402.38 228" fill="none" stroke="var(--load_colour#id#)" stroke-width="1" stroke-miterlimit="10"  pointer-events="stroke"/>'
          html += '<circle id="es-dot#id#" cx="0" cy="0" r="3" fill="transparent"><animateMotion id="anim_load#id#" dur="' + config#id#.load.animation_speed + 's" repeatCount="indefinite" keyPoints="0;1" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#es-line1#id#"/></animateMotion></circle>'
          // ICON LOAD ESS
          //html += '<svg xmlns="http://www.w3.org/2000/svg" id="icon_load#id#" x="402" y="177.5" width="79" height="79" viewBox="0 0 24 24"><path fill="var(--load_colour#id#)" d="M15 9h1V7.5h4V9h1c.55 0 1 .45 1 1v11c0 .55-.45 1-1 1h-6c-.55 0-1-.45-1-1V10c0-.55.45-1 1-1m1 2v3h4v-3h-4m-4-5.31l-5 4.5V18h5v2H5v-8H2l10-9l2.78 2.5H14v1.67l-.24.1L12 5.69Z"/></svg>'
          // ICON LOAD NONESS
          html += '<svg xmlns="http://www.w3.org/2000/svg" class="' + ((config#id#.load.additional_loads >= 1 || config#id#.load.has_load_power) ? '' : 'hidden-#id#') + '" id="icon_load#id#" x="400" y="190.5" width="79" height="79" viewBox="0 0 24 24"><path fill="var(--load_colour#id#)" d="m15 13l-4 4v-3H2v-2h9V9l4 4M5 20v-4h2v2h10v-7.81l-5-4.5L7.21 10H4.22L12 3l10 9h-3v8H5Z"></path></svg>'
          // DAILY
          let dailyLoad = autoValueArray#id#(config#id#.load.daily.state,config#id#.load.daily.unit)
          html += '<text id="daily_load_value#id#" x="' + ((config#id#.load.additional_loads == 1) ? '400.4' : '335') + '" y="' + ((config#id#.load.additional_loads == 1) ? '277.9' : '178') + '" class="ft16-#id# left-align#id# ' + (((config#id#.load.daily.show === true) && (config#id#.load.additional_loads >= 1 || config#id#.load.has_load_power)) ? '' : 'hidden-#id#') + '" fill="var(--load_colour#id#)">' + trunc#id#(dailyLoad.value, 3, 1) + ' ' + dailyLoad.unit + '</text>'
          html += '<text id="daily_load#id#" x="' + ((config#id#.load.additional_loads == 1) ? '400.4' : '335') + '" y="' + ((config#id#.load.additional_loads == 1) ? '292.1' : '192.2') + '" class="ft9-#id# left-align#id# ' + (((config#id#.load.daily.show === true) && (config#id#.load.additional_loads >= 1 || config#id#.load.has_load_power)) ? '' : 'hidden-#id#') + '" fill="var(--load_colour#id#)" >' + config#id#.load.daily.text + '</text>'
          ///////////////////////////////////////////////////////
          //////////////////// Load 1 ///////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- Load 1 -->'
          html += '<rect id="load1-rect-#id#" class="' + ((config#id#.blink && config#id#.load.load1.max_power && config#id#.load.load1.power >= config#id#.load.load1.max_power) ? 'blink#id#' : '') + '" x="406" y="128.5" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="' + ((config#id#.load.load1.max_power && config#id#.load.load1.power >= config#id#.load.load1.max_power) ? 'var(--color_alerte#id#)' : 'var(--load_colour#id#)') + '" pointer-events="all" display="' + ((config#id#.load.additional_loads >= 1) ? '' : 'none') + '"/>'
          html += '<text id="ess_load1#id#" x="440" y="' + ((config#id#.load.load1.energy === false) ? '148' : '143') + '" display="' + ((config#id#.load.additional_loads >= 1) ? '' : 'none') + '" class="ft12-#id#'
          html += ' ftw-#id# center-align#id#" fill="var(--load_colour#id#)">' + trunc#id#(config#id#.load.load1.power, 1) + ' ' + config#id#.load.load1.power_unit + '</text>'
          html += '<text id="es-load1-name#id#" x="440" y="122" class="ft9-#id# center-align#id#" display="' + ((config#id#.load.additional_loads >= 1) ? '' : 'none') + '" fill="var(--load_colour#id#)" >' + ((config#id#.load.load1.name) ? config#id#.load.load1.name : '') + '</text>'
          // ENERGY
          let load1_energy = autoValueArray#id#((config#id#.load.load1.energy || 0),config#id#.load.load1.energy_unit)
          html += '<text id="load1_energy#id#" x="440" y="154" class="ft8-#id# center-align#id#" display="' + ((config#id#.load.load1.energy === false || config#id#.load.additional_loads <= 0) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += trunc#id#(load1_energy.value, 3, 1) + ' ' + load1_energy.unit
          html += '</text>'
          // PERSO
          html += '<text id="load1_perso#id#" x="436" y="170" class="ft8-#id# right-align#id#" display="' + ((config#id#.load.load1.perso === false || config#id#.load.additional_loads <= 0) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += config#id#.load.load1.perso + ' ' + config#id#.load.load1.perso_unit
          html += '</text>'
          // ICON
          if (config#id#.load.additional_loads >= 1 && config#id#.load.load1.icon !== false) html += getSvgIcon(config#id#.load.load1.icon, 1)
          // LINE
          html += '<path id="es-load1path#id#" d="M 441 190 L 441 158" class="' + ((config#id#.load.additional_loads >= 1) ? '' : 'hidden-#id#') + '" fill="none" stroke="var(--load_colour#id#)" stroke-width="1" stroke-miterlimit="10"  pointer-events="stroke"/>'
          html += '<circle id="es-dot1-#id#" cx="0" cy="0" r="3"  class="' + ((config#id#.load.additional_loads >= 1 && config#id#.load.animate_load_enable === true) ? '' : 'hidden-#id#') + '" fill="' + ((config#id#.load.load1.power == 0) ? 'transparent' : 'var(--load_colour#id#)') + '"><animateMotion id="anim_load1-#id#" dur="3" repeatCount="indefinite" keyPoints="0;1" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#es-load1path#id#"></mpath></animateMotion></circle>'
          ///////////////////////////////////////////////////////
          //////////////////// Load 2 ///////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- Load 2 -->'
          html += '<rect id="load2-rect-#id#" class="' + ((config#id#.blink && config#id#.load.load2.max_power && config#id#.load.load2.power >= config#id#.load.load2.max_power) ? 'blink#id#' : '') + '" x="406" y="300" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="' + ((config#id#.load.load2.max_power && config#id#.load.load2.power >= config#id#.load.load2.max_power) ? 'var(--color_alerte#id#)' : 'var(--load_colour#id#)') + '" pointer-events="all" display="' + ((config#id#.load.additional_loads >= 2) ? '' : 'none') + '"/>'
          html += '<text id="ess_load2#id#" x="436" y="' + ((config#id#.load.load2.energy === false) ? '319.5' : '314.5') + '" display="' + ((config#id#.load.additional_loads >= 2) ? '' : 'none') + '" class="ft12-#id#'
          html += ' ftw-#id# center-align#id#" fill="var(--load_colour#id#)">' + trunc#id#(config#id#.load.load2.power, 1) + ' ' + config#id#.load.load2.power_unit + '</text>'
          html += '<text id="es-load2-name#id#" x="440" y="343" class="ft9-#id# center-align#id#" display="' + ((config#id#.load.additional_loads >= 2) ? '' : 'none') + '" fill="var(--load_colour#id#)" >' + ((config#id#.load.load2.name) ? config#id#.load.load2.name : '') + '</text>'
          // ENERGY
          let load2_energy = autoValueArray#id#((config#id#.load.load2.energy || 0),config#id#.load.load2.energy_unit)
          html += '<text id="load2_energy#id#" x="440" y="325.5" class="ft8-#id# center-align#id#" display="' + ((config#id#.load.load2.energy === false || config#id#.load.additional_loads <= 1) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += trunc#id#(load2_energy.value, 3, 1) + ' ' + load2_energy.unit
          html += '</text>'
          // PERSO
          html += '<text id="load2_perso#id#" x="435" y="295" class="ft8-#id# right-align#id#" display="' + ((config#id#.load.load2.perso === false || config#id#.load.additional_loads <= 1) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += config#id#.load.load2.perso + ' ' + config#id#.load.load2.perso_unit
          html += '</text>'
          // ICON
          if (config#id#.load.additional_loads >= 2 && config#id#.load.load2.icon !== false) html += getSvgIcon(config#id#.load.load2.icon, 2)
          // LINE
          html += '<path id="es-load2path#id#" d="M 441 300 L 441 267" class="' + ((config#id#.load.additional_loads >= 2) ? '' : 'hidden-#id#') + '" fill="none" stroke="var(--load_colour#id#)" stroke-width="1" stroke-miterlimit="10"  pointer-events="stroke"/>'
          html += '<circle id="es-dot2-#id#" cx="0" cy="0" r="3"  class="' + ((config#id#.load.additional_loads >= 2 && config#id#.load.animate_load_enable === true) ? '' : 'hidden-#id#') + '" fill="' + ((config#id#.load.load2.power == 0) ? 'transparent' : 'var(--load_colour#id#)') + '"><animateMotion id="anim_load2-#id#" dur="3" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#es-load2path#id#"></mpath></animateMotion></circle>'
          ///////////////////////////////////////////////////////
          //////////////////// Load 3 ///////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- Load 3 -->'
          html += '<rect id="load3-rect-#id#" class="' + ((config#id#.blink && config#id#.load.load3.max_power && config#id#.load.load3.power >= config#id#.load.load3.max_power) ? 'blink#id#' : '') + '" x="485" y="128.5" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="' + ((config#id#.load.load3.max_power && config#id#.load.load3.power >= config#id#.load.load3.max_power) ? 'var(--color_alerte#id#)' : 'var(--load_colour#id#)') + '" pointer-events="all" display="' + ((config#id#.load.additional_loads >= 3) ? '' : 'none') + '"/>'
          html += '<text id="ess_load3#id#" x="520" y="' + ((config#id#.load.load3.energy === false) ? '148' : '143') + '" display="' + ((config#id#.load.additional_loads >= 3) ? '' : 'none') + '" class="ft12-#id#'
          html += ' ftw-#id# center-align#id#" fill="var(--load_colour#id#)">' + trunc#id#(config#id#.load.load3.power, 1) + ' ' + config#id#.load.load3.power_unit + '</text>'
          html += '<text id="es-load3-name#id#" x="520" y="122" class="ft9-#id# center-align#id#" display="' + ((config#id#.load.additional_loads >= 3) ? '' : 'none') + '" fill="var(--load_colour#id#)" >' + ((config#id#.load.load3.name) ? config#id#.load.load3.name : '') + '</text>'
          // ENERGY
          let load3_energy = autoValueArray#id#((config#id#.load.load3.energy || 0),config#id#.load.load3.energy_unit)
          html += '<text id="load3_energy#id#" x="520" y="154" class="ft8-#id# center-align#id#" display="' + ((config#id#.load.load3.energy === false || config#id#.load.additional_loads <= 2) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += trunc#id#(load3_energy.value, 3, 1) + ' ' + load3_energy.unit
          html += '</text>'
          // PERSO
          html += '<text id="load3_perso#id#" x="515" y="170" class="ft8-#id# right-align#id#" display="' + ((config#id#.load.load3.perso === false || config#id#.load.additional_loads <= 2) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += config#id#.load.load3.perso + ' ' + config#id#.load.load3.perso_unit
          html += '</text>'
          // ICON
          if (config#id#.load.additional_loads >= 3 && config#id#.load.load3.icon !== false) html += getSvgIcon(config#id#.load.load3.icon, 3)
          // LINE
          html += '<path id="es-load3path#id#" d="M 520 158 L 520 205 Q 520 214 512 214 L 475 214" class="' + ((config#id#.load.additional_loads >= 3) ? '' : 'hidden-#id#') + '" fill="none" stroke="var(--load_colour#id#)" stroke-width="1" stroke-miterlimit="10"  pointer-events="stroke"/>'
          html += '<circle id="es-dot3-#id#" cx="0" cy="0" r="3"  class="' + ((config#id#.load.additional_loads >= 3 && config#id#.load.animate_load_enable === true) ? '' : 'hidden-#id#') + '" fill="' + ((config#id#.load.load3.power == 0) ? 'transparent' : 'var(--load_colour#id#)') + '"><animateMotion id="anim_load3-#id#" dur="3" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#es-load3path#id#"></mpath></animateMotion></circle>'
          ///////////////////////////////////////////////////////
          //////////////////// Load 4 ///////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- Load 4 -->'
          html += '<rect id="load4-rect-#id#" class="' + ((config#id#.blink && config#id#.load.load4.max_power && config#id#.load.load4.power >= config#id#.load.load4.max_power) ? 'blink#id#' : '') + '" x="485" y="300" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="' + ((config#id#.load.load4.max_power && config#id#.load.load4.power >= config#id#.load.load4.max_power) ? 'var(--color_alerte#id#)' : 'var(--load_colour#id#)') + '" pointer-events="all" display="' + ((config#id#.load.additional_loads >= 4) ? '' : 'none') + '"/>'
          html += '<text id="ess_load4#id#" x="520" y="' + ((config#id#.load.load4.energy === false) ? '319.5' : '314.5') + '" display="' + ((config#id#.load.additional_loads >= 4) ? '' : 'none') + '" class="ft12-#id#'
          html += ' ftw-#id# center-align#id#" fill="var(--load_colour#id#)">' + trunc#id#(config#id#.load.load4.power, 1) + ' ' + config#id#.load.load4.power_unit + '</text>'
          html += '<text id="es-load4-name#id#" x="520" y="343" class="ft9-#id# center-align#id#" display="' + ((config#id#.load.additional_loads >= 4) ? '' : 'none') + '" fill="var(--load_colour#id#)" >' + ((config#id#.load.load4.name) ? config#id#.load.load4.name : '') + '</text>'
          // ENERGY
          let load4_energy = autoValueArray#id#((config#id#.load.load4.energy || 0),config#id#.load.load4.energy_unit)
          html += '<text id="load4_energy#id#" x="514" y="325.5" class="ft8-#id# center-align#id#" display="' + ((config#id#.load.load4.energy === false || config#id#.load.additional_loads <= 3) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += trunc#id#(load4_energy.value, 3, 1) + ' ' + load4_energy.unit
          html += '</text>'
          // PERSO
          html += '<text id="load4_perso#id#" x="515" y="295" class="ft8-#id# right-align#id#" display="' + ((config#id#.load.load4.perso === false || config#id#.load.additional_loads <= 3) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += config#id#.load.load4.perso + ' ' + config#id#.load.load4.perso_unit
          html += '</text>'
          // ICON
          if (config#id#.load.additional_loads >= 4 && config#id#.load.load4.icon !== false) html += getSvgIcon(config#id#.load.load4.icon, 4)
          // LINE
          html += '<path id="es-load4path#id#" d="M 520 300 L 520 252 Q 520 242 512 242 L 475 242" class="' + ((config#id#.load.additional_loads >= 4) ? '' : 'hidden-#id#') + '" fill="none" stroke="var(--load_colour#id#)" stroke-width="1" stroke-miterlimit="10" pointer-events="stroke"></path>'
          html += '<circle id="es-dot4-#id#" cx="0" cy="0" r="3"  class="' + ((config#id#.load.additional_loads >= 4 && config#id#.load.animate_load_enable === true) ? '' : 'hidden-#id#') + '" fill="' + ((config#id#.load.load4.power == 0) ? 'transparent' : 'var(--load_colour#id#)') + '"><animateMotion id="anim_load4-#id#" dur="3" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#es-load4path#id#"></mpath></animateMotion></circle>'
          ///////////////////////////////////////////////////////
          //////////////////// Load 5 ///////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- Load 5 -->'
          html += '<rect id="load5-rect-#id#" class="' + ((config#id#.blink && config#id#.load.load5.max_power && config#id#.load.load5.power >= config#id#.load.load5.max_power) ? 'blink#id#' : '') + '" x="564" y="128.5" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="' + ((config#id#.load.load5.max_power && config#id#.load.load5.power >= config#id#.load.load5.max_power) ? 'var(--color_alerte#id#)' : 'var(--load_colour#id#)') + '" pointer-events="all" display="' + ((config#id#.load.additional_loads >= 5) ? '' : 'none') + '"/>'
          html += '<text id="ess_load5#id#" x="599" y="' + ((config#id#.load.load5.energy === false) ? '148' : '143') + '" display="' + ((config#id#.load.additional_loads >= 5) ? '' : 'none') + '" class="ft12-#id#'
          html += ' ftw-#id# center-align#id#" fill="var(--load_colour#id#)">' + trunc#id#(config#id#.load.load5.power, 1) + ' ' + config#id#.load.load5.power_unit + '</text>'
          html += '<text id="es-load5-name#id#" x="600" y="122" class="ft9-#id# center-align#id#" display="' + ((config#id#.load.additional_loads >= 5) ? '' : 'none') + '" fill="var(--load_colour#id#)" >' + ((config#id#.load.load5.name) ? config#id#.load.load5.name : '') + '</text>'
          // ENERGY
          let load5_energy = autoValueArray#id#((config#id#.load.load5.energy || 0),config#id#.load.load5.energy_unit)
          html += '<text id="load5_energy#id#" x="599" y="154" class="ft8-#id# center-align#id#" display="' + ((config#id#.load.load5.energy === false || config#id#.load.additional_loads <= 4) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += trunc#id#(load5_energy.value, 3, 1) + ' ' + load5_energy.unit
          html += '</text>'
          // PERSO
          html += '<text id="load5_perso#id#" x="594" y="170" class="ft8-#id# right-align#id#" display="' + ((config#id#.load.load5.perso === false || config#id#.load.additional_loads <= 4) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += config#id#.load.load5.perso + ' ' + config#id#.load.load5.perso_unit
          html += '</text>'
          // ICON
          if (config#id#.load.additional_loads >= 5 && config#id#.load.load5.icon !== false) html += getSvgIcon(config#id#.load.load5.icon, 5)
          // LINE
          html += '<path id="es-load5path#id#" d="M 599 158 L 599 205 Q 599 214 591 214 L 475 214" class="' + ((config#id#.load.additional_loads >= 5) ? '' : 'hidden-#id#') + '" fill="none" stroke="var(--load_colour#id#)" stroke-width="1" stroke-miterlimit="10"  pointer-events="stroke"/>'
          html += '<circle id="es-dot5-#id#" cx="0" cy="0" r="3"  class="' + ((config#id#.load.additional_loads >= 5 && config#id#.load.animate_load_enable === true) ? '' : 'hidden-#id#') + '" fill="' + ((config#id#.load.load5.power == 0) ? 'transparent' : 'var(--load_colour#id#)') + '"><animateMotion id="anim_load5-#id#" dur="3" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#es-load5path#id#"></mpath></animateMotion></circle>'
          ///////////////////////////////////////////////////////
          //////////////////// Load 6 ///////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- Load 6 -->'
          html += '<rect id="load6-rect-#id#" class="' + ((config#id#.blink && config#id#.load.load6.max_power && config#id#.load.load6.power >= config#id#.load.load6.max_power) ? 'blink#id#' : '') + '" x="564" y="300" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="' + ((config#id#.load.load6.max_power && config#id#.load.load6.power >= config#id#.load.load6.max_power) ? 'var(--color_alerte#id#)' : 'var(--load_colour#id#)') + '" pointer-events="all" display="' + ((config#id#.load.additional_loads >= 6) ? '' : 'none') + '"/>'
          html += '<text id="ess_load6#id#" x="599" y="' + ((config#id#.load.load6.energy === false) ? '319.5' : '314.5') + '" display="' + ((config#id#.load.additional_loads >= 6) ? '' : 'none') + '" class="ft12-#id#'
          html += ' ftw-#id# center-align#id#" fill="var(--load_colour#id#)">' + trunc#id#(config#id#.load.load6.power, 1) + ' ' + config#id#.load.load6.power_unit + '</text>'
          html += '<text id="es-load6-name#id#" x="600" y="343" class="ft9-#id# center-align#id#" display="' + ((config#id#.load.additional_loads >= 6) ? '' : 'none') + '" fill="var(--load_colour#id#)" >' + ((config#id#.load.load6.name) ? config#id#.load.load6.name : '') + '</text>'
          // ENERGY
          let load6_energy = autoValueArray#id#((config#id#.load.load6.energy || 0),config#id#.load.load6.energy_unit)
          html += '<text id="load6_energy#id#" x="599" y="325.5" class="ft8-#id# center-align#id#" display="' + ((config#id#.load.load6.energy === false || config#id#.load.additional_loads <= 5) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += trunc#id#(load6_energy.value, 3, 1) + ' ' + load6_energy.unit
          html += '</text>'
          // PERSO
          html += '<text id="load6_perso#id#" x="594" y="295" class="ft8-#id# right-align#id#" display="' + ((config#id#.load.load6.perso === false || config#id#.load.additional_loads <= 5) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += config#id#.load.load6.perso + ' ' + config#id#.load.load6.perso_unit
          html += '</text>'
          // ICON
          if (config#id#.load.additional_loads >= 6 && config#id#.load.load6.icon !== false) html += getSvgIcon(config#id#.load.load6.icon, 6)
          // LINE
          html += '<path id="es-load6path#id#" d="M 599 300 L 599 252 Q 599 242 591 242 L 475 242" class="' + ((config#id#.load.additional_loads >= 6) ? '' : 'hidden-#id#') + '" fill="none" stroke="var(--load_colour#id#)" stroke-width="1" stroke-miterlimit="10" pointer-events="stroke"></path>'
          html += '<circle id="es-dot6-#id#" cx="0" cy="0" r="3"  class="' + ((config#id#.load.additional_loads >= 6 && config#id#.load.animate_load_enable === true) ? '' : 'hidden-#id#') + '" fill="' + ((config#id#.load.load6.power == 0) ? 'transparent' : 'var(--load_colour#id#)') + '"><animateMotion id="anim_load6-#id#" dur="3" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#es-load6path#id#"></mpath></animateMotion></circle>'
          ///////////////////////////////////////////////////////
          //////////////////// Load 7 ///////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- Load 7 -->'
          html += '<rect id="load7-rect-#id#" class="' + ((config#id#.blink && config#id#.load.load7.max_power && config#id#.load.load7.power >= config#id#.load.load7.max_power) ? 'blink#id#' : '') + '" x="643" y="128.5" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="' + ((config#id#.load.load7.max_power && config#id#.load.load7.power >= config#id#.load.load7.max_power) ? 'var(--color_alerte#id#)' : 'var(--load_colour#id#)') + '" pointer-events="all" display="' + ((config#id#.load.additional_loads >= 7) ? '' : 'none') + '"/>'
          html += '<text id="ess_load7#id#" x="678" y="' + ((config#id#.load.load7.energy === false) ? '148' : '143') + '" display="' + ((config#id#.load.additional_loads >= 7) ? '' : 'none') + '" class="ft12-#id#'
          html += ' ftw-#id# center-align#id#" fill="var(--load_colour#id#)">' + trunc#id#(config#id#.load.load7.power, 1) + ' ' + config#id#.load.load7.power_unit + '</text>'
          html += '<text id="es-load7-name#id#" x="680" y="122" class="ft9-#id# center-align#id#" display="' + ((config#id#.load.additional_loads >= 7) ? '' : 'none') + '" fill="var(--load_colour#id#)" >' + ((config#id#.load.load7.name) ? config#id#.load.load7.name : '') + '</text>'
          // ENERGY
          let load7_energy = autoValueArray#id#((config#id#.load.load7.energy || 0),config#id#.load.load7.energy_unit)
          html += '<text id="load7_energy#id#" x="678" y="154" class="ft8-#id# center-align#id#" display="' + ((config#id#.load.load7.energy === false || config#id#.load.additional_loads <= 6) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += trunc#id#(load7_energy.value, 3, 1) + ' ' + load7_energy.unit
          html += '</text>'
          // PERSO
          html += '<text id="load7_perso#id#" x="673" y="170" class="ft8-#id# right-align#id#" display="' + ((config#id#.load.load7.perso === false || config#id#.load.additional_loads <= 6) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += config#id#.load.load7.perso + ' ' + config#id#.load.load7.perso_unit
          html += '</text>'
          // ICON
          if (config#id#.load.additional_loads >= 7 && config#id#.load.load7.icon !== false) html += getSvgIcon(config#id#.load.load7.icon, 7)
          // LINE
          html += '<path id="es-load7path#id#" d="M 678 158 L 678 205 Q 678 214 670 214 L 475 214" class="' + ((config#id#.load.additional_loads >= 7) ? '' : 'hidden-#id#') + '" fill="none" stroke="var(--load_colour#id#)" stroke-width="1" stroke-miterlimit="10"  pointer-events="stroke"/>'
          html += '<circle id="es-dot7-#id#" cx="0" cy="0" r="3"  class="' + ((config#id#.load.additional_loads >= 7 && config#id#.load.animate_load_enable === true) ? '' : 'hidden-#id#') + '" fill="' + ((config#id#.load.load7.power == 0) ? 'transparent' : 'var(--load_colour#id#)') + '"><animateMotion id="anim_load7-#id#" dur="3" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#es-load7path#id#"></mpath></animateMotion></circle>'
          ///////////////////////////////////////////////////////
          //////////////////// Load 8 ///////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- Load 8 -->'
          html += '<rect id="load8-rect-#id#" class="' + ((config#id#.blink && config#id#.load.load8.max_power && config#id#.load.load8.power >= config#id#.load.load8.max_power) ? 'blink#id#' : '') + '" x="643" y="300" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="' + ((config#id#.load.load8.max_power && config#id#.load.load8.power >= config#id#.load.load8.max_power) ? 'var(--color_alerte#id#)' : 'var(--load_colour#id#)') + '" pointer-events="all" display="' + ((config#id#.load.additional_loads >= 8) ? '' : 'none') + '"/>'
          html += '<text id="ess_load8#id#" x="678" y="' + ((config#id#.load.load8.energy === false) ? '319.5' : '314.5') + '" display="' + ((config#id#.load.additional_loads >= 8) ? '' : 'none') + '" class="ft12-#id#'
          html += ' ftw-#id# center-align#id#" fill="var(--load_colour#id#)">' + trunc#id#(config#id#.load.load8.power, 1) + ' ' + config#id#.load.load8.power_unit + '</text>'
          html += '<text id="es-load8-name#id#" x="680" y="343" class="ft9-#id# center-align#id#" display="' + ((config#id#.load.additional_loads >= 8) ? '' : 'none') + '" fill="var(--load_colour#id#)" >' + ((config#id#.load.load8.name) ? config#id#.load.load8.name : '') + '</text>'
          // ENERGY
          let load8_energy = autoValueArray#id#((config#id#.load.load8.energy || 0),config#id#.load.load8.energy_unit)
          html += '<text id="load8_energy#id#" x="678" y="325.5" class="ft8-#id# center-align#id#" display="' + ((config#id#.load.load8.energy === false || config#id#.load.additional_loads <= 7) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += trunc#id#(load8_energy.value, 3, 1) + ' ' + load8_energy.unit
          html += '</text>'
          // PERSO
          html += '<text id="load8_perso#id#" x="673" y="295" class="ft8-#id# right-align#id#" display="' + ((config#id#.load.load8.perso === false || config#id#.load.additional_loads <= 7) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += config#id#.load.load8.perso + ' ' + config#id#.load.load8.perso_unit
          html += '</text>'
          // ICON
          if (config#id#.load.additional_loads >= 8 && config#id#.load.load8.icon !== false) html += getSvgIcon(config#id#.load.load8.icon, 8)
          // LINE
          html += '<path id="es-load8path#id#" d="M 678 300 L 678 252 Q 678 242 670 242 L 475 242" class="' + ((config#id#.load.additional_loads >= 8) ? '' : 'hidden-#id#') + '" fill="none" stroke="var(--load_colour#id#)" stroke-width="1" stroke-miterlimit="10" pointer-events="stroke"></path>'
          html += '<circle id="es-dot8-#id#" cx="0" cy="0" r="3"  class="' + ((config#id#.load.additional_loads >= 8 && config#id#.load.animate_load_enable === true) ? '' : 'hidden-#id#') + '" fill="' + ((config#id#.load.load8.power == 0) ? 'transparent' : 'var(--load_colour#id#)') + '"><animateMotion id="anim_load8-#id#" dur="3" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#es-load8path#id#"></mpath></animateMotion></circle>'
          ///////////////////////////////////////////////////////
          //////////////////// Load 9 ///////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- Load 9 -->'
          html += '<rect id="load9-rect-#id#" class="' + ((config#id#.blink && config#id#.load.load9.max_power && config#id#.load.load9.power >= config#id#.load.load9.max_power) ? 'blink#id#' : '') + '" x="722" y="128.5" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="' + ((config#id#.load.load9.max_power && config#id#.load.load9.power >= config#id#.load.load9.max_power) ? 'var(--color_alerte#id#)' : 'var(--load_colour#id#)') + '" pointer-events="all" display="' + ((config#id#.load.additional_loads >= 9) ? '' : 'none') + '"/>'
          html += '<text id="ess_load9#id#" x="757" y="' + ((config#id#.load.load9.energy === false) ? '148' : '143') + '" display="' + ((config#id#.load.additional_loads >= 9) ? '' : 'none') + '" class="ft12-#id#'
          html += ' ftw-#id# center-align#id#" fill="var(--load_colour#id#)">' + trunc#id#(config#id#.load.load9.power, 1) + ' ' + config#id#.load.load9.power_unit + '</text>'
          html += '<text id="es-load9-name#id#" x="760" y="122" class="ft9-#id# center-align#id#" display="' + ((config#id#.load.additional_loads >= 9) ? '' : 'none') + '" fill="var(--load_colour#id#)" >' + ((config#id#.load.load9.name) ? config#id#.load.load9.name : '') + '</text>'
          // ENERGY
          let load9_energy = autoValueArray#id#((config#id#.load.load9.energy || 0),config#id#.load.load9.energy_unit)
          html += '<text id="load9_energy#id#" x="757" y="154" class="ft8-#id# center-align#id#" display="' + ((config#id#.load.load9.energy === false || config#id#.load.additional_loads <= 8) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += trunc#id#(load9_energy.value, 3, 1) + ' ' + load9_energy.unit
          html += '</text>'
          // PERSO
          html += '<text id="load9_perso#id#" x="752" y="170" class="ft8-#id# right-align#id#" display="' + ((config#id#.load.load9.perso === false || config#id#.load.additional_loads <= 8) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += config#id#.load.load9.perso + ' ' + config#id#.load.load9.perso_unit
          html += '</text>'
          // ICON
          if (config#id#.load.additional_loads >= 9 && config#id#.load.load9.icon !== false) html += getSvgIcon(config#id#.load.load9.icon, 9)
          // LINE
          html += '<path id="es-load9path#id#" d="M 757 158 L 757 205 Q 757 214 749 214 L 475 214" class="' + ((config#id#.load.additional_loads >= 9) ? '' : 'hidden-#id#') + '" fill="none" stroke="var(--load_colour#id#)" stroke-width="1" stroke-miterlimit="10"  pointer-events="stroke"/>'
          html += '<circle id="es-dot9-#id#" cx="0" cy="0" r="3"  class="' + ((config#id#.load.additional_loads >= 9 && config#id#.load.animate_load_enable === true) ? '' : 'hidden-#id#') + '" fill="' + ((config#id#.load.load9.power == 0) ? 'transparent' : 'var(--load_colour#id#)') + '"><animateMotion id="anim_load9-#id#" dur="3" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#es-load9path#id#"></mpath></animateMotion></circle>'
          ///////////////////////////////////////////////////////
          ////////////////////// Load 10 ////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- Load 10 -->'
          html += '<rect id="load10-rect-#id#" class="' + ((config#id#.blink && config#id#.load.load10.max_power && config#id#.load.load10.power >= config#id#.load.load10.max_power) ? 'blink#id#' : '') + '" x="722" y="300" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="' + ((config#id#.load.load10.max_power && config#id#.load.load10.power >= config#id#.load.load10.max_power) ? 'var(--color_alerte#id#)' : 'var(--load_colour#id#)') + '" pointer-events="all" display="' + ((config#id#.load.additional_loads >= 10) ? '' : 'none') + '"/>'
          html += '<text id="ess_load10#id#" x="757" y="' + ((config#id#.load.load10.energy === false) ? '319.5' : '314.5') + '" display="' + ((config#id#.load.additional_loads >= 10) ? '' : 'none') + '" class="ft12-#id#'
          html += ' ftw-#id# center-align#id#" fill="var(--load_colour#id#)">' + trunc#id#(config#id#.load.load10.power, 1) + ' ' + config#id#.load.load10.power_unit + '</text>'
          html += '<text id="es-load10-name#id#" x="760" y="343" class="ft9-#id# center-align#id#" display="' + ((config#id#.load.additional_loads >= 10) ? '' : 'none') + '" fill="var(--load_colour#id#)" >' + ((config#id#.load.load10.name) ? config#id#.load.load10.name : '') + '</text>'
          // ENERGY
          let load10_energy = autoValueArray#id#((config#id#.load.load10.energy || 0),config#id#.load.load10.energy_unit)
          html += '<text id="load10_energy#id#" x="757" y="325.5" class="ft8-#id# center-align#id#" display="' + ((config#id#.load.load10.energy === false || config#id#.load.additional_loads <= 9) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += trunc#id#(load10_energy.value, 3, 1) + ' ' + load10_energy.unit
          html += '</text>'
          // PERSO
          html += '<text id="load10_perso#id#" x="752" y="295" class="ft8-#id# right-align#id#" display="' + ((config#id#.load.load10.perso === false || config#id#.load.additional_loads <= 9) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += config#id#.load.load10.perso + ' ' + config#id#.load.load10.perso_unit
          html += '</text>'
          // ICON
          if (config#id#.load.additional_loads >= 10 && config#id#.load.load10.icon !== false) html += getSvgIcon(config#id#.load.load10.icon, 10)
          // LINE
          html += '<path id="es-load10path#id#" d="M 757 300 L 757 252 Q 757 242 749 242 L 475 242" class="' + ((config#id#.load.additional_loads >= 10) ? '' : 'hidden-#id#') + '" fill="none" stroke="var(--load_colour#id#)" stroke-width="1" stroke-miterlimit="10" pointer-events="stroke"></path>'
          html += '<circle id="es-dot10-#id#" cx="0" cy="0" r="3"  class="' + ((config#id#.load.additional_loads >= 10 && config#id#.load.animate_load_enable === true) ? '' : 'hidden-#id#') + '" fill="' + ((config#id#.load.load10.power == 0) ? 'transparent' : 'var(--load_colour#id#)') + '"><animateMotion id="anim_load10-#id#" dur="3" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#es-load10path#id#"></mpath></animateMotion></circle>'
          ///////////////////////////////////////////////////////
          //////////////////// Load 11 //////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- Load 11 -->'
          html += '<rect id="load11-rect-#id#" class="' + ((config#id#.blink && config#id#.load.load11.max_power && config#id#.load.load11.power >= config#id#.load.load11.max_power) ? 'blink#id#' : '') + '" x="801" y="128.5" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="' + ((config#id#.load.load11.max_power && config#id#.load.load11.power >= config#id#.load.load11.max_power) ? 'var(--color_alerte#id#)' : 'var(--load_colour#id#)') + '" pointer-events="all" display="' + ((config#id#.load.additional_loads >= 11) ? '' : 'none') + '"/>'
          html += '<text id="ess_load11#id#" x="836" y="' + ((config#id#.load.load11.energy === false) ? '148' : '143') + '" display="' + ((config#id#.load.additional_loads >= 11) ? '' : 'none') + '" class="ft12-#id#'
          html += ' ftw-#id# center-align#id#" fill="var(--load_colour#id#)">' + trunc#id#(config#id#.load.load11.power, 1) + ' ' + config#id#.load.load11.power_unit + '</text>'
          html += '<text id="es-load11-name#id#" x="840" y="122" class="ft9-#id# center-align#id#" display="' + ((config#id#.load.additional_loads >= 11) ? '' : 'none') + '" fill="var(--load_colour#id#)" >' + ((config#id#.load.load11.name) ? config#id#.load.load11.name : '') + '</text>'
          // ENERGY
          let load11_energy = autoValueArray#id#((config#id#.load.load11.energy || 0),config#id#.load.load11.energy_unit)
          html += '<text id="load11_energy#id#" x="836" y="154" class="ft8-#id# center-align#id#" display="' + ((config#id#.load.load11.energy === false || config#id#.load.additional_loads <= 10) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += trunc#id#(load11_energy.value, 3, 1) + ' ' + load11_energy.unit
          html += '</text>'
          // PERSO
          html += '<text id="load11_perso#id#" x="831" y="170" class="ft8-#id# right-align#id#" display="' + ((config#id#.load.load11.perso === false || config#id#.load.additional_loads <= 10) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += config#id#.load.load11.perso + ' ' + config#id#.load.load11.perso_unit
          html += '</text>'
          // ICON
          if (config#id#.load.additional_loads >= 11 && config#id#.load.load11.icon !== false) html += getSvgIcon(config#id#.load.load11.icon, 11)
          // LINE
          html += '<path id="es-load11path#id#" d="M 836 158 L 836 205 Q 836 214 828 214 L 475 214" class="' + ((config#id#.load.additional_loads >= 11) ? '' : 'hidden-#id#') + '" fill="none" stroke="var(--load_colour#id#)" stroke-width="1" stroke-miterlimit="10"  pointer-events="stroke"/>'
          html += '<circle id="es-dot11-#id#" cx="0" cy="0" r="3"  class="' + ((config#id#.load.additional_loads >= 11 && config#id#.load.animate_load_enable === true) ? '' : 'hidden-#id#') + '" fill="' + ((config#id#.load.load11.power == 0) ? 'transparent' : 'var(--load_colour#id#)') + '"><animateMotion id="anim_load11-#id#" dur="3" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#es-load11path#id#"></mpath></animateMotion></circle>'
          ///////////////////////////////////////////////////////
          //////////////////// Load 12 //////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- Load 12 -->'
          html += '<rect id="load12-rect-#id#" class="' + ((config#id#.blink && config#id#.load.load12.max_power && config#id#.load.load12.power >= config#id#.load.load12.max_power) ? 'blink#id#' : '') + '" x="801" y="300" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="' + ((config#id#.load.load12.max_power && config#id#.load.load12.power >= config#id#.load.load12.max_power) ? 'var(--color_alerte#id#)' : 'var(--load_colour#id#)') + '" pointer-events="all" display="' + ((config#id#.load.additional_loads >= 12) ? '' : 'none') + '"/>'
          html += '<text id="ess_load12#id#" x="836" y="' + ((config#id#.load.load12.energy === false) ? '319.5' : '314.5') + '" display="' + ((config#id#.load.additional_loads >= 12) ? '' : 'none') + '" class="ft12-#id#'
          html += ' ftw-#id# center-align#id#" fill="var(--load_colour#id#)">' + trunc#id#(config#id#.load.load12.power, 1) + ' ' + config#id#.load.load12.power_unit + '</text>'
          html += '<text id="es-load12-name#id#" x="840" y="343" class="ft9-#id# center-align#id#" display="' + ((config#id#.load.additional_loads >= 12) ? '' : 'none') + '" fill="var(--load_colour#id#)" >' + ((config#id#.load.load12.name) ? config#id#.load.load12.name : '') + '</text>'
          // ENERGY
          let load12_energy = autoValueArray#id#((config#id#.load.load12.energy || 0),config#id#.load.load12.energy_unit)
          html += '<text id="load12_energy#id#" x="836" y="325.5" class="ft8-#id# center-align#id#" display="' + ((config#id#.load.load12.energy === false || config#id#.load.additional_loads <= 11) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += trunc#id#(load12_energy.value, 3, 1) + ' ' + load12_energy.unit
          html += '</text>'
          // PERSO
          html += '<text id="load12_perso#id#" x="831" y="295" class="ft8-#id# right-align#id#" display="' + ((config#id#.load.load12.perso === false || config#id#.load.additional_loads <= 11) ? 'none' : '') + '" fill="var(--load_colour#id#)">'
          html += config#id#.load.load12.perso + ' ' + config#id#.load.load12.perso_unit
          html += '</text>'
          // ICON
          if (config#id#.load.additional_loads >= 12 && config#id#.load.load12.icon !== false) html += getSvgIcon(config#id#.load.load12.icon, 12)
          // LINE
          html += '<path id="es-load12path#id#" d="M 836 300 L 836 252 Q 836 242 828 242 L 475 242" class="' + ((config#id#.load.additional_loads >= 12) ? '' : 'hidden-#id#') + '" fill="none" stroke="var(--load_colour#id#)" stroke-width="1" stroke-miterlimit="10" pointer-events="stroke"></path>'
          html += '<circle id="es-dot12-#id#" cx="0" cy="0" r="3"  class="' + ((config#id#.load.additional_loads >= 12 && config#id#.load.animate_load_enable === true) ? '' : 'hidden-#id#') + '" fill="' + ((config#id#.load.load12.power == 0) ? 'transparent' : 'var(--load_colour#id#)') + '"><animateMotion id="anim_load12-#id#" dur="3" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#es-load12path#id#"></mpath></animateMotion></circle>'
          ///////////////////////////////////////////////////////
          /////////////////////  Grid ///////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- Grid -->'
          html += '<rect id="grid-rect-#id#" class="' + ((config#id#.blink && config#id#.grid.max_power && config#id#.grid.power >= config#id#.grid.max_power) ? 'blink#id#' : '') + '" x="103" y="213.5" width="70" height="29.5" rx="4.42" ry="4.42" fill="none" stroke="var(--grid_colour#id#)" pointer-events="all"/>'
          html += '<text id="grid_power#id#" x="138.1" y="232.2" display="'
          html += '" class="ft12-#id# ftw-#id# center-align#id#" fill="var(--grid_colour#id#)">'
          html += (config#id#.grid.power < 0) ? config#id#.grid.power * -1 : config#id#.grid.power
          html += ' ' + config#id#.grid.power_unit + '</text>'
          // LINE GRID
          html += '<path id="grid-line#id#" d="M 173 228 L 214 228" fill="none" stroke="var(--grid_colour#id#)" stroke-width="1" stroke-miterlimit="10"  pointer-events="stroke"/>'
          html += '<circle id="grid-dot-buy#id#" cx="0" cy="0" r="3" fill="' + ((config#id#.grid.power < 0 || config#id#.grid.power === 0) ? 'transparent' : 'var(--grid_colour#id#)') + '">'
          html += '<animateMotion id="anim_grid_buy#id#" dur="' + config#id#.grid.animation_speed + 's" repeatCount="indefinite" keyPoints="0;1" keyTimes="0;1" calcMode="linear">'
          html += '<mpath xlink:href="#grid-line#id#"/></animateMotion></circle>'
          html += '<circle id="grid-dot-sell#id#" cx="0" cy="0" r="3" fill="' + ((config#id#.grid.power > 0 || config#id#.grid.power === 0) ? 'transparent' : 'var(--grid_colour#id#)') + '">'
          html += '<animateMotion id="anim_grid_sell#id#" dur="' + config#id#.grid.animation_speed + 's" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear">'
          html += '<mpath xlink:href="#grid-line#id#"/></animateMotion></circle>'
          // LINE GRID 1
          html += '<path id="grid-line1#id#" d="M 103 228 L 64.5 228" fill="none" stroke="var(--grid_colour#id#)" stroke-width="1" stroke-miterlimit="10"  pointer-events="stroke"/>'
          html += '<circle id="grid-dot1-buy#id#" cx="0" cy="0" r="3" fill="' + ((config#id#.grid.power < 0 || config#id#.grid.power === 0) ? 'transparent' : 'var(--grid_colour#id#)') + '">'
          html += '<animateMotion id="anim_grid_buy1#id#" dur="' + config#id#.grid.animation_speed + 's" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear">'
          html += '<mpath xlink:href="#grid-line1#id#"/></animateMotion></circle>'
          html += '<circle id="grid-dot1-sell#id#" cx="0" cy="0" r="3" fill="' + ((config#id#.grid.power > 0 || config#id#.grid.power === 0) ? 'transparent' : 'var(--grid_colour#id#)') + '">'
          html += '<animateMotion id="anim_grid_sell1#id#" dur="' + config#id#.grid.animation_speed + 's" repeatCount="indefinite" keyPoints="0;1" keyTimes="0;1" calcMode="linear">'
          html += '<mpath xlink:href="#grid-line1#id#"/></animateMotion></circle>'
          // ICON ON
          html += '<svg xmlns="http://www.w3.org/2000/svg" id="transmission_on#id#" x="-0.5" y="197.5" width="62" height="62" viewBox="0 0 24 24"><path class="'
          html += (config#id#.grid.status === 'off' || config#id#.grid.status === '0' || config#id#.grid.status === 0) ? 'hidden-#id#' : ''
          html += '" fill="var(--grid_colour#id#)" d="m8.28 5.45l-1.78-.9L7.76 2h8.47l1.27 2.55l-1.78.89L15 4H9l-.72 1.45M18.62 8h-4.53l-.79-3h-2.6l-.79 3H5.38L4.1 10.55l1.79.89l.73-1.44h10.76l.72 1.45l1.79-.89L18.62 8m-.85 14H15.7l-.24-.9L12 15.9l-3.47 5.2l-.23.9H6.23l2.89-11h2.07l-.36 1.35L12 14.1l1.16-1.75l-.35-1.35h2.07l2.89 11m-6.37-7l-.9-1.35l-1.18 4.48L11.4 15m3.28 3.12l-1.18-4.48l-.9 1.36l2.08 3.12Z"/></svg>'
          // ICON OFF
          html += '<svg xmlns="http://www.w3.org/2000/svg" id="transmission_off#id#" x="-0.5" y="197.5" width="64.5" height="64.5" viewBox="0 0 24 24"><path class="'
          html += (config#id#.grid.status === 'on' || config#id#.grid.status === '1' || config#id#.grid.status === 1) ? 'hidden-#id#' : ''
          html += '" fill="var(--no_grid_colour#id#)" d="M22.1 21.5L2.4 1.7L1.1 3l5 5h-.7l-1.3 2.5l1.8.9l.7-1.4h1.5l1 1l-2.9 11h2.1l.2-.9l3.5-5.2l3.5 5.2l.2.9h2.1l-.8-3.2l3.9 3.9l1.2-1.2M9.3 18.1l1.2-4.5l.9 1.3l-2.1 3.2m5.4 0L12.6 15l.2-.3l1.3 1.3l.6 2.1m-.5-7.1h.7l.2.9l-.9-.9m-.1-3h4.5l1.3 2.6l-1.8.9l-.7-1.5h-4.2l-3-3l.5-2h2.6l.8 3M8.4 5.2L6.9 3.7L7.8 2h8.5l1.3 2.5l-1.8.9L15 4H9l-.6 1.2Z"/></svg>'
          // DAILY
          html += '<text id="daily_grid_buy#id#" x="5" y="292.1" class="ft9-#id# left-align#id#" fill="' + ((config#id#.grid.daily.show_buy !== true) ? 'transparent' : 'var(--grid_colour#id#)') + '" >' + config#id#.grid.daily.text_buy + '</text>'
          html += '<text id="daily_grid_sell#id#" x="5" y="189" class="ft9-#id# left-align#id#" fill="' + ((config#id#.grid.daily.show_sell !== true) ? 'transparent' : 'var(--grid_colour#id#)') + '" >' + config#id#.grid.daily.text_sell + '</text>'
          let dailyGridBuy = autoValueArray#id#(config#id#.grid.daily.buy_state,config#id#.grid.daily.buy_unit)
          html += '<text id="daily_grid_buy_value#id#" x="5" y="277.9" class="ft16-#id# left-align#id#" display="' + ((config#id#.grid.daily.show_buy !== true) ? 'none' : '')
          html += '" fill="var(--grid_colour#id#)">' + trunc#id#(dailyGridBuy.value, 3, 1) + ' ' + dailyGridBuy.unit + '</text>'
          let dailyGridSell = autoValueArray#id#(config#id#.grid.daily.sell_state,config#id#.grid.daily.sell_unit)
          html += '<text id="daily_grid_sell_value#id#" x="5" y="175" class="ft16-#id# left-align#id#" display="' + ((config#id#.grid.daily.show_sell !== true) ? 'none' : '')
          html += '" fill="var(--grid_colour#id#)" >' + trunc#id#(dailyGridSell.value,3 , 1) + ' ' + dailyGridSell.unit + '</text>'
          // TEMPO
          html += '<text id="tempo_today_text#id#" x="78" y="221" class="ft12-#id# left-align#id#" fill="transparent" display=""></text>'
          html += '<circle id="tempo_today_circle#id#" cx="66" cy="217" r="6" fill="transparent"></circle>'
          html += '<text  id="tempo_tomorrow_text#id#" x="75" y="241" class="ft7-#id# left-align#id#" fill="transparent" display="">Demain</text>'
          html += '<circle id="tempo_tomorrow_circle#id#" cx="66" cy="238" r="6" fill="transparent"></circle>'          
          ///////////////////////////////////////////////////////
          ////////////////////// Battery ////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- Battery -->'
          html += '<rect x="' + ((config#id#.aux.has_aux_power) ? '104' : '204') + '" y="300" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="var(--battery_colour#id#)" pointer-events="all" display="' + ((config#id#.battery.power.show === false) ? 'none' : '') + '"></rect>'
          html += '<text id="battery_power#id#" x="' + ((config#id#.aux.has_aux_power) ? '140' : '239') + '" y="320" display="' + ((config#id#.battery.power.show === false) ? 'none' : '') + '" fill=var(--battery_colour#id#) class="ft12-#id# ftw-#id# center-align#id#">'
          html += (config#id#.battery.power.state < 0) ? config#id#.battery.power.state * -1 : config#id#.battery.power.state
          html += ' ' + config#id#.battery.power.unit + '</text>'
          // CURRENT
          html += '<text id="battery_current#id#" x="' + ((config#id#.aux.has_aux_power) ? '133' : '232') + '" y="295" display="' + ((config#id#.battery.power.show === false || !config#id#.battery.current.show) ? 'none' : '') + '" fill=var(--battery_colour#id#) class="ft9-#id# right-align#id#">' + config#id#.battery.current.state + ' ' + config#id#.battery.current.unit + '</text>'
          // VOLTAGE
          html += '<text id="battery_voltage#id#" x="' + ((config#id#.aux.has_aux_power) ? '133' : '232') + '" y="' + ((!config#id#.battery.current.show) ? '295' : '285') + '" display="' // 193 346
          html += (config#id#.battery.power.show === false || !config#id#.battery.voltage.show) ? 'none' : ''
          html += '" fill=var(--battery_colour#id#) class="ft9-#id# right-align#id#" >' + config#id#.battery.voltage.state + ' ' + config#id#.battery.voltage.unit + '</text>'
          // TEMP
          html += '<text id="battery_temp#id#" x="' + ((config#id#.aux.has_aux_power) ? '146' : '245') + '" y="295" class="ft9-#id# left-align#id#" fill="var(--battery_colour#id#)" display="'
          html += (config#id#.battery.power.show === false || !config#id#.battery.temp.show) ? 'none' : ''
          html += '" >' + config#id#.battery.temp.state + '' + config#id#.battery.temp.unit + '</text>'
          // DAILY
          let dailyBatteryCharge = autoValueArray#id#(config#id#.battery.daily.charge_state,config#id#.battery.daily.charge_unit)
          html += '<text id="daily_battery_charge_value#id#" x="' + ((config#id#.aux.has_aux_power) ? '25' : '131') + '" y="343" class= "ft16-#id# left-align#id#" display="' + ((config#id#.battery.power.show === false || config#id#.battery.daily.show_charge !== true) ? 'none' : '') + '" fill="var(--battery_colour#id#)">'
          html += trunc#id#(dailyBatteryCharge.value, 3, 1) + ' ' + dailyBatteryCharge.unit
          html += '</text>'
          html += '<text id="daily_bat_charge#id#" x="' + ((config#id#.aux.has_aux_power) ? '25' : '131') + '" y="357.2" class="ft9-#id# left-align#id#"  fill="' + ((config#id#.battery.daily.show_charge !== true) ? 'transparent' : 'var(--battery_colour#id#)') + '" display="' + ((config#id#.battery.power.show === false) ? 'none' : '') + '" >' + config#id#.battery.daily.text_charge + '</text>'
          let dailyBatteryDischarge = autoValueArray#id#(config#id#.battery.daily.discharge_state,config#id#.battery.daily.discharge_unit)
          html += '<text id="daily_battery_discharge_value#id#" x="' + ((config#id#.aux.has_aux_power) ? '25' : '131') + '" y="380.1" class="ft16-#id# left-align#id#" display="' + ((config#id#.battery.power.show === false || config#id#.battery.daily.show_discharge !== true) ? 'none' : '')
          html += '" fill="var(--battery_colour#id#)" >' + trunc#id#(dailyBatteryDischarge.value, 3, 1) + ' ' + dailyBatteryDischarge.unit + '</text>'
          html += '<text id="daily_bat_discharge#id#" x="' + ((config#id#.aux.has_aux_power) ? '25' : '131') + '" y="393.7" class="ft9-#id# left-align#id#"  fill="' + ((config#id#.battery.daily.show_discharge !== true) ? 'transparent' : 'var(--battery_colour#id#)') + '" display="' + ((config#id#.battery.power.show === false) ? 'none' : '') + '" >' + config#id#.battery.daily.text_discharge + '</text>'
          // TIME
          html += '<text id="duration#id#" x="' + ((config#id#.aux.has_aux_power) ? '171' : '270') + '" y="377.5" class="ft12-#id# left-align#id#" fill="'
          html += (config#id#.battery.energy == 0 || !config#id#.battery.energy) ? 'transparent' : 'var(--battery_colour#id#)'
          html += '" display="' + ((config#id#.battery.power.show === false) ? 'none' : '') + '"></text>'
          html += '<text id="duration_text_etat#id#" x="' + ((config#id#.aux.has_aux_power) ? '171' : '270') + '" y="393.7" class="ft9-#id# left-align#id#" fill="'
          html += (config#id#.battery.energy == 0 || !config#id#.battery.energy || config#id#.battery.power.state === 0 || float === true) ? 'transparent' : 'var(--battery_colour#id#)'
          html += '" display="' + ((config#id#.battery.power.show === false) ? 'none' : '') + '"></text>'
          // %
          html += '<text id="battery_soc#id#" x="' + ((config#id#.aux.has_aux_power) ? '171' : '270') + '" y="360" display="' + ((config#id#.battery.power.show === false || config#id#.battery.state.show === false) ? 'none' : '') + '" fill=var(--battery_colour#id#) class="ft18-#id# ftw-#id# left-align#id#"></text>'
          // ICON BATTERY
          if (!config#id#.battery.icon_perso) {
            html += '<svg xmlns="http://www.w3.org/2000/svg" id="icon_bat#id#" class="' + ((config#id#.battery.power.show === false) ? 'hidden-#id#' : '') + '" x="' + ((config#id#.aux.has_aux_power) ? '114' : '213') + '" y="325.5" width="78.75" height="78.75" preserveAspectRatio="none" opacity="1" viewBox="0 0 24 24">'
            html += getBatteryIcon#id#(config#id#.battery.state.state, config#id#.battery.full_capacity, config#id#.battery.empty_capacity)
            html += '</svg>'
          } else {
            html += getSvgIcon(config#id#.battery.icon_perso, (config#id#.aux.has_aux_power) ? 1 : 0, 'iconBattery') //getSvgIcon(icone=false, type, id='iconLoad')
          }
          // LINE BATTERY
          html += '<path id="bat-line#id#" class="' + ((config#id#.battery.power.show === false) ? 'hidden-#id#' : '') + '" d="' + ((config#id#.aux.has_aux_power) ? 'M 214 250 L 147 250 Q 139 250 139 258 L 139 300' : 'M 239.23 260 L 239.23 300') + '" fill="none" stroke="var(--battery_colour#id#)" stroke-width="1" stroke-miterlimit="10"  pointer-events="stroke"/>'
          html += '<circle id="power-dot-charge#id#" class="' + ((config#id#.battery.power.show === false) ? 'hidden-#id#' : '') + '" cx="0" cy="0" r="3" fill="transparent">'
          html += '<animateMotion id="anim_battery-charge#id#" dur="' + config#id#.battery.animation_speed + 's" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear">'
          html += '<mpath xlink:href="#bat-line#id#"/></animateMotion></circle>'
          html += '<circle id="power-dot-discharge#id#" class="' + ((config#id#.battery.power.show === false) ? 'hidden-#id#' : '') + '" cx="0" cy="0" r="3" fill="transparent">'
          html += '<animateMotion id="anim_battery-discharge#id#"  dur="' + config#id#.battery.animation_speed + 's" repeatCount="indefinite" keyPoints="0;1" keyTimes="0;1" calcMode="linear">'
          html += '<mpath xlink:href="#bat-line#id#"/></animateMotion></circle>'
          ///////////////////////////////////////////////////////
          /////////////////// Battery mppt //////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- battery mppt -->'
          html += '<rect x="' + ((config#id#.aux.has_aux_power) ? '204' : '303') + '" y="300" width="70" height="30" rx="4.42" ry="4.42" fill="none" stroke="var(--solar_colour#id#)" pointer-events="all" class="' + ((!config#id#.battery.mppt.power.show || !config#id#.battery.power.show) ? 'hidden-#id#' : '') + '"/>'
          html += '<text x="' + ((config#id#.aux.has_aux_power) ? '239' : '338') + '" y="295" class="ft9-#id# ftw-#id# center-align#id#" display="' + ((config#id#.battery.mppt.power.show && config#id#.battery.power.show) ? '' : 'none') + '" fill="var(--solar_colour#id#)">' + config#id#.battery.mppt.name + '</text>'
          html += '<text id="battery_mppt_power-#id#" x="' + ((config#id#.aux.has_aux_power) ? '240' : '337') + '" y="' + ((!config#id#.battery.mppt.energy.show) ? '319' : '314') + '" class="ft12-#id# ftw-#id# center-align#id#" display="' + ((config#id#.battery.mppt.power.show === true && config#id#.battery.power.show === true) ? '' : 'none')
          html += '" fill="var(--solar_colour#id#)">' + trunc#id#(config#id#.battery.mppt.power.state, 1) + ' ' + config#id#.battery.mppt.power.unit + '</text>'
          // ENERGY
          let mppt_energy = autoValueArray#id#(config#id#.battery.mppt.energy.state, config#id#.battery.mppt.energy.unit)
          html += '<text id="battery-mppt-energy-#id#" x="' + ((config#id#.aux.has_aux_power) ? '240' : '337') + '" y="325" class="ft8-#id# center-align#id#" display="' + ((!config#id#.battery.mppt.power.show || !config#id#.battery.mppt.energy.show || !config#id#.battery.power.show) ? 'none' : '') + '" fill="var(--solar_colour#id#)">'
          html += trunc#id#(mppt_energy.value, 3, 1) + ' ' + mppt_energy.unit
          html += '</text>'
          // LINE
          html += '<path id="battery-mppt-line-#id#" d="' + ((config#id#.aux.has_aux_power) ? 'M 175 315 L 204 315' : 'M 274 315 L 303 315') + '" class="' + ((!config#id#.battery.mppt.power.show || !config#id#.battery.power.show) ? 'hidden-#id#' : '') + '" fill="none" stroke="var(--solar_colour#id#)" stroke-width="1" stroke-miterlimit="10"  pointer-events="stroke"/>'
          html += '<circle id="dot-battery-mppt-#id#" cx="0" cy="0" r="3" class="' + ((!config#id#.battery.mppt.power.show || !config#id#.battery.power.show) ? 'hidden-#id#' : '') + '" fill="' + ((parseInt(config#id#.battery.mppt.power.state) <= 0) ? 'transparent' : 'var(--solar_colour#id#)') + '">'
          html += '<animateMotion id="battery-mppt-animate-#id#" dur="5s" repeatCount="indefinite" keyPoints="1;0" keyTimes="0;1" calcMode="linear"><mpath xlink:href="#battery-mppt-line-#id#"/></animateMotion></circle>'
          ///////////////////////////////////////////////////
          ////////////////////// Aux ////////////////////////
          ///////////////////////////////////////////////////
          html += '<!-- Aux -->'
          html += '<rect id="aux-rect-#id#" class="" x="' + ((config#id#.battery.power.show) ? '304' : '204') + '" y="300" width="70" height="30" rx="4.5" ry="4.5" display="'+ ((config#id#.aux.has_aux_power === false) ? 'none' : '') +'" fill="none" stroke="var(--aux_colour#id#)" pointer-events="all"></rect>'
          html += '<text id="aux_power#id#" x="' + ((config#id#.battery.power.show) ? '339' : '239') + '" y="320" display="' + ((config#id#.aux.has_aux_power === false) ? 'none' : '')
          html += '" class="ft12-#id# ftw-#id# center-align#id#" fill="var(--aux_colour#id#)">'
          html += trunc#id#(config#id#.aux.power, 1) + ' ' + config#id#.aux.power_unit + '</text>'
          //LINE
          html += '<path id="aux-line#id#" d="' + ((config#id#.battery.power.show) ? 'M 339 300 L 339 258 Q 339 250 331 250 L 264 250' : 'M 239.23 300 L 239.23 260') + '" class="' + ((config#id#.aux.has_aux_power === false) ? 'hidden-#id#' : '') + '" fill="none" stroke="var(--aux_colour#id#)" stroke-width="1" stroke-miterlimit="10" pointer-events="stroke"></path>'
          html += '<circle id="aux-dot-#id#" cx="0" cy="0" r="3" class="' + ((config#id#.aux.has_aux_power === false) ? 'hidden-#id#' : '') + '" fill="' + ((config#id#.aux.power == 0) ? 'transparent' : 'var(--aux_colour#id#)') + '">'
          html += '<animateMotion id="anim_aux#id#" dur="' + config#id#.aux.animation_speed + 's" repeatCount="indefinite" keyPoints="0;1" keyTimes="0;1" calcMode="linear">'
          html += '<mpath xlink:href="#aux-line#id#"/></animateMotion></circle>'
          // ICON
          html += '<svg xmlns="http://www.w3.org/2000/svg" id="aux_generator" x="' + ((config#id#.battery.power.show) ? '304' : '203') + '" y="325" width="74" height="74" viewBox="0 0 24 24">'
          html += '<path class="' + ((config#id#.aux.has_aux_power === false) ? 'hidden-#id#' : '') + '" display="" fill="' + ((config#id#.aux.status === 'on' || config#id#.aux.status === '1') ? 'var(--aux_colour#id#)' : 'var(--aux_off_colour#id#)') + '" d="M6 3a2 2 0 0 0-2 2v11h2v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h6v1c0 .55.45 1 1 1h1c.55 0 1-.45 1-1v-1h2V5a2 2 0 0 0-2-2H6m6 4V5h6v2h-6m0 2h6v2h-6V9M8 5v4h2l-3 6v-4H5l3-6m14 15v2H2v-2h20Z"/></svg>'
          // DAILY
          let dailyAux = autoValueArray#id#(config#id#.aux.daily.state,config#id#.aux.daily.unit)
          html += '<text id="daily_aux_value#id#" x="' + ((config#id#.battery.power.show) ? '385' : '115') + '" y="' + ((config#id#.battery.power.show) ? '380' : '343') + '" class="ft16-#id# left-align#id#" display="'
          html += (config#id#.aux.has_aux_power !== true) ? 'none' : ''
          html += '" fill="var(--aux_colour#id#)" >' + trunc#id#(dailyAux.value, 3, 1) + ' ' + dailyAux.unit + '</text>'
          html += '<text id="daily_aux_text#id#" x="' + ((config#id#.battery.power.show) ? '385' : '115') + '" y="' + ((config#id#.battery.power.show) ? '393.7' : '357.2') + '" class="ft9-#id# left-align#id#" display="'
          html += (config#id#.aux.has_aux_power !== true) ? 'none' : ''
          html += '" fill="var(--aux_colour#id#)">' + config#id#.aux.daily.text + '</text>'
          ///////////////////////////////////////////////////////
          ///////////////////// Inverter ////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- Inverter -->'
          // ICON
          if (config#id#.inverter.model == 'sunsynk') {
            html += '<svg version="1.0" xmlns="http://www.w3.org/2000/svg" x="213.5" y="189" width="54" height="79" viewBox="0 0 74 91"  preserveAspectRatio="xMidYMid meet"> '
            html += '<g transform="translate(0.000000,91.000000) scale(0.100000,-0.100000)" fill="var(--inverter_colour#id#)" stroke="none"> <path d="M35 887 l-27 -23 0 -404 0 -404 27 -23 c26 -23 28 -23 329 -23 284 0 305 1 327 19 l24 19 0 412 0 412 -24 19 c-22 18 -43 19 -327 19 -301 0 -303 0 -329 -23z m585 -157 l0 -80 -255 0 -255 0 0 80 0 80 255 0 255 0 0 -80z m-242 -229"/> </g> </svg>'
          }
          else html += '<rect x="214" y="196" width="50" height="64" rx="4.5" ry="4.5" fill="none" stroke="var(--inverter_colour#id#)" pointer-events="all"></rect>'
          // VOLTAGE
          html += '<text id="inverter_voltage#id#" x="240" y="230" display="' + ((config#id#.inverter.voltage_state === false) ? 'none' : '') + '" class="ft9-#id# center-align#id#" fill="' +((config#id#.inverter.model == 'sunsynk') ? 'var(--inverter_secondary_colour#id#)' : 'var(--inverter_colour#id#)') + '" >' + config#id#.inverter.voltage_state + ' ' + config#id#.inverter.voltage_unit + '</text>'
          // FREQUENCY
          html += '<text id="inverter_frequency#id#" x="240" y="' + ((config#id#.inverter.voltage_state === false) ? '230' : '240') + '" display="' + ((config#id#.inverter.frequency_state === false) ? 'none' : '') + '" class="ft9-#id# center-align#id#" fill="' +((config#id#.inverter.model == 'sunsynk') ? 'var(--inverter_secondary_colour#id#)' : 'var(--inverter_colour#id#)') + '">' + config#id#.inverter.frequency_state + ' ' + config#id#.inverter.frequency_unit + '</text>'
          // CURRENT
          html += '<text id="inverter_current#id#" x="240" y="' + ((config#id#.inverter.voltage_state === false && config#id#.inverter.frequency_state === false) ? '230' : (config#id#.inverter.voltage_state !== false && config#id#.inverter.frequency_state !== false) ? '250' : '240') + '" display="' + ((config#id#.inverter.current_state === false) ? 'none' : '') + '" class="ft9-#id# center-align#id#" fill="' +((config#id#.inverter.model == 'sunsynk') ? 'var(--inverter_secondary_colour#id#)' : 'var(--inverter_colour#id#)') + '">' + config#id#.inverter.current_state + ' ' + config#id#.inverter.current_unit + '</text>'
          // TEMP
          html += '<text id="ac_temp#id#" x="' + ((config#id#.aux.has_aux_power || config#id#.load.additional_loads >= 1 || config#id#.load.has_load_power) ? '270' : '185') + '" y="242" class="ft9-#id# left-align#id#" fill="var(--inverter_colour#id#)" display="' + ((config#id#.inverter.temp.ac_state !== false) ? '' : 'none') + '" >' + config#id#.inverter.temp.ac_state + ' ' + config#id#.inverter.temp.ac_unit + '</text>'   
          html += '<text id="dc_temp#id#" x="243" y="' + ((config#id#.show_solar || (!config#id#.show_solar && !config#id#.battery.power.show)) ? '192' : '272') + '" class="ft9-#id# left-align#id#" fill="var(--inverter_colour#id#)" display="' + ((config#id#.inverter.temp.dc_state !== false) ? '' : 'none') + '" >' + config#id#.inverter.temp.dc_state + ' ' + config#id#.inverter.temp.dc_unit + '</text>'
          /*
          // entities.energy_cost
          html += '<text id="energy_cost#id#" x="105" y="195" class="ft9-#id# left-align#id#" fill="var(--grid_colour#id#)"'
          html += (config#id#.grid.energy_cost === false) ? ' display="none"' : ''
          html += ' >' + config#id#.grid.energy_cost + '€</text>'
          
          html += '<text id="autarkye_value#id#" x="130" y="260" display="' + ((config#id#.inverter.autarky === "no") ? 'none' : '') + '" class="' + ((config#id#.inverter.autarky === 'energy') ? 'ft14-#id# ftw-#id# left-align#id#' : 'hidden-#id#') + '" fill="var(--inverter_colour#id#)" >' + config#id#.inverter.autarky_state + '%</text>'
          
          html += '<text id="ratioe_value#id#" x="173" y="260" display="'
          html += (config#id#.inverter.autarky === "no") ? 'none' : ''
          html += '" class="'
          html += (config#id#.inverter.autarky === 'energy') ? 'ft14-#id# ftw-#id# left-align#id#' : 'hidden-#id#'
          html += '" fill="var(--inverter_colour#id#)" >' + config#id#.inverter.ratio_state + '%</text>'
    
          html += '<text id="autarkyp_value#id#" x="130" y="260" display="'
          html += (config#id#.inverter.autarky === "no") ? 'none' : ''
          html += '" class="'
          html += (config#id#.inverter.autarky === 'power') ? 'ft14-#id# ftw-#id# left-align#id#' : 'hidden-#id#'
          html += '" fill="var(--inverter_colour#id#)" >' + config#id#.inverter.autarkyp_state + '%</text>'
    
          html += '<text id="ratiop_value#id#" x="173" y="260" display="'
          html += (config#id#.inverter.autarky === "no") ? 'none' : ''
          html += '" class="'
          html += (config#id#.inverter.autarky === 'power') ? 'ft14-#id# ftw-#id# left-align#id#' : 'hidden-#id#'
          html += '" fill="var(--inverter_colour#id#)" >'  + config#id#.inverter.ratiop_state + '%</text>'
    
          html += '<text id="autarky#id#" x="130" y="273" display="'
          html += (config#id#.inverter.autarky === "no") ? 'none' : ''
          html += '" class="ft9-#id# left-align#id#" fill="var(--inverter_colour#id#)" >' + config#id#.inverter.autarky_text + '</text>'
    
          html += '<text id="ratio#id#" x="173" y="273" display="'
          html += (config#id#.inverter.autarky === "no") ? 'none' : ''
          html += '" class="ft9-#id# left-align#id#" fill="var(--inverter_colour#id#)" >' + config#id#.inverter.ratio_text + '</text>'
          
          ////////////////////// PRIORITY /////////////////////
          // priority_load_243
          html += '<svg xmlns="http://www.w3.org/2000/svg" id="pbat#id#" x="267.7" y="262.5" width="18" height="18" viewBox="0 0 24 24"><path display="'
          html += (config#id#.priority.state === 'off' && config#id#.priority.usepriority !== false) ? '' : 'none'
          html += '" fill="var(--inverter_colour#id#)" d="M15.95 21.175L13.1 18.35l1.425-1.4l1.425 1.4l3.525-3.525l1.425 1.4l-4.95 4.95ZM8 22q-.425 0-.713-.288T7 21V5q0-.425.288-.713T8 4h2V2h4v2h2q.425 0 .713.288T17 5v7q-.525 0-1.025.088T15 12.35V6H9v14h2.35q.2.575.488 1.075t.687.925H8Zm1-2h2.35H11h.35H9Z"/></svg>'
          html += '<text id="priority_text_batt#id#" x="287" y="273" class="ft9-#id# left-align#id#" display="'
          html += (config#id#.priority.state === 'off' && config#id#.priority.usepriority !== false) ? '' : 'none'
          html += '" fill="var(--inverter_colour#id#)">' + config#id#.priority.text_off + '</text>'
          
          html += '<svg xmlns="http://www.w3.org/2000/svg" id="pload#id#" x="267.7" y="262.5" width="18" height="18" viewBox="0 0 24 24"><path display="'
          html += (config#id#.priority.state === 'on' && config#id#.priority.usepriority !== false) ? '' : 'none'
          html += '" fill="var(--inverter_colour#id#)" d="m15 13l-4 4v-3H2v-2h9V9l4 4M5 20v-4h2v2h10v-7.81l-5-4.5L7.21 10H4.22L12 3l10 9h-3v8H5Z"/></svg>'
          html += '<text id="priority_text_load#id#" x="287" y="273" class="ft9-#id# left-align#id#" display="'
          html += (config#id#.priority.state === 'on' && config#id#.priority.usepriority !== false) ? '' : 'none'
          html += '" fill="var(--inverter_colour#id#)">' + config#id#.priority.text_on + '</text>'
          ////////////////////// TIMER /////////////////////
          // entities.use_timer_248
          html += '<svg xmlns="http://www.w3.org/2000/svg" id="timer#id#" x="267.7" y="243.3" width="18" height="18" viewBox="0 0 24 24"><path display="'
          html += (config#id#.timer.state == 'on' && config#id#.timer.usetimer !== false) ? '' : 'none'
          html += '" fill="var(--inverter_colour#id#)" d="M15 1H9v2h6V1zm-4 13h2V8h-2v6zm8.03-6.61l1.42-1.42c-.43-.51-.9-.99-1.41-1.41l-1.42 1.42A8.962 8.962 0 0 0 12 4c-4.97 0-9 4.03-9 9s4.02 9 9 9a8.994 8.994 0 0 0 7.03-14.61zM12 20c-3.87 0-7-3.13-7-7s3.13-7 7-7s7 3.13 7 7s-3.13 7-7 7z"/></svg>'
          html += '<text id="timer_text_on#id#" x="287" y="254.7" class="ft9-#id# left-align#id#" display="'
          html += (config#id#.timer.state == 'on' && config#id#.timer.usetimer !== false) ? '' : 'none'
          html += '" fill="var(--inverter_colour#id#)">' + config#id#.timer.text_off + '</text>'
          
          html += '<svg xmlns="http://www.w3.org/2000/svg" id="timer_off#id#" x="267.7" y="243.3" width="18" height="18" viewBox="0 0 24 24"><path display="'
          html += (config#id#.timer.state == 'off' && config#id#.timer.usetimer !== false) ? '' : 'none'
          html += '" fill="var(--inverter_colour#id#)" d="m19.95 17.15l-1.5-1.5q.275-.675.413-1.337T19 13q0-2.9-2.05-4.95T12 6q-.6 0-1.275.125t-1.4.4l-1.5-1.5q.95-.5 2.012-.763T12 4q1.5 0 2.938.5t2.712 1.45l1.4-1.4l1.4 1.4l-1.4 1.4q.95 1.275 1.45 2.713T21 13q0 1.05-.263 2.087t-.787 2.063ZM13 10.2V8h-2v.2l2 2Zm6.8 12.4l-2.4-2.4q-1.2.875-2.588 1.338T12 22q-1.85 0-3.488-.713T5.65 19.35q-1.225-1.225-1.938-2.863T3 13q0-1.5.463-2.888T4.8 7.6L1.4 4.2l1.4-1.4l18.4 18.4l-1.4 1.4ZM12 20q1.05 0 2.05-.325t1.875-.925L6.2 9.025q-.6.875-.9 1.875T5 13q0 2.9 2.05 4.95T12 20ZM9 3V1h6v2H9Zm2.075 10.875Zm2.825-2.8Z"/></svg>'
          html += '<text id="timer_text_off#id#" x="287" y="254.7" class="ft9-#id# left-align#id#" display="'
          html += (config#id#.timer.state == 'off' && config#id#.timer.usetimer !== false) ? '' : 'none'
          html += '" fill="var(--inverter_colour#id#)">' + config#id#.timer.text_off + '</text>'
          // ICON PRISE ON
          // inverter_prog.entityID
          html += '<svg xmlns="http://www.w3.org/2000/svg" id="prog_grid_on#id#" x="323" y="243" width="20" height="18" viewBox="0 0 24 24"><path display="'
          html += (config#id#.inverter.prog.show === false || config#id#.inverter.prog.grid === 'none') ? 'none' : ''
          html += '" class="'
          html += (config#id#.inverter.prog.charge === 'none') ? 'hidden-#id#' : ''
          html += '" fill="var(--inverter_colour#id#)" d="M11.5 19h1v-1.85l3.5-3.5V9H8v4.65l3.5 3.5V19Zm-2 2v-3L6 14.5V9q0-.825.588-1.413T8 7h1L8 8V3h2v4h4V3h2v5l-1-1h1q.825 0 1.413.588T18 9v5.5L14.5 18v3h-5Zm2.5-7Z"/></svg>'
          // ICON PRISE OFF
          html += '<svg xmlns="http://www.w3.org/2000/svg" id="prog_grid_off#id#" x="323" y="243" width="20" height="18" viewBox="0 0 24 24"><path display="'
          html += (config#id#.inverter.prog.show === false || config#id#.inverter.prog.grid === 'none') ? 'none' : ''
          html += '" class="'
          html += (config#id#.inverter.prog.charge === 'none') ? '' : 'hidden-#id#'
          html += '" fill="var(--inverter_colour#id#)" d="M10 3H8v1.88l2 2zm6 6v3.88l1.8 1.8l.2-.2V9c0-1.1-.9-2-2-2V3h-2v4h-3.88l2 2H16zM4.12 3.84L2.71 5.25L6 8.54v5.96L9.5 18v3h5v-3l.48-.48l4.47 4.47l1.41-1.41L4.12 3.84zm8.38 13.33V19h-1v-1.83L8 13.65v-3.11l5.57 5.57l-1.07 1.06z"/></svg>'
          */
          ///////////////////////////////////////////////////////
          ///////////////////// Other ////////////////////////
          ///////////////////////////////////////////////////////
          html += '<!-- Other -->'
          // html += '<circle id="standby#id#" cx="220" cy="260" r="3.5" fill="var(--inverterStateColour#id#)"/>' /////////////// Todo
          //html += '<rect id="es-load5#id#" x="448" y="170" width="70" height="30" rx="4.5" ry="4.5" fill="none" stroke="var(--load_colour#id#)" pointer-events="all" display="'
          //html += ((config#id#.load.additional_loads >= 5) && config#id#.show_solar !== false) ? '' : 'none'
          //html += '"/>'
          //html += '<path id="es-load5path#id#" d="M 483 228.5 L 483 200" class="' + ((config#id#.load.additional_loads >= 5 && config#id#.show_solar !== false) ? '' : 'hidden-#id#') + '" fill="none" stroke="var(--load_colour#id#)" stroke-width="1" stroke-miterlimit="10" pointer-events="stroke"></path>'
          html += '</svg></div>'
          document.getElementById('widget#id#').innerHTML = html
        } // init
      } // ElDomExist
      log#id#('└──────────────────────────────────────────────────────')
      calculatePv#id#('init');
      calculateLoad#id#('init');
      calculateBattery#id#('init')
      calculateGrid#id#('init')
      calculateAux#id#('init')
      //calculateGreenValue#id#('init')
    }
    
    function calculatePv#id#(el='') {
      log#id#('┌─────────────────── Widget Distribution Onduleur [#id#] en debug [calculatePv()] ───────────────')
      var ElDomExist = !!document.getElementById("widget#id#");
      let total_pv = 0;
      log#id#('| ElDomExist ? ' + ElDomExist)
      if (ElDomExist) {  
        if (el != '') log#id#('| launched by ' + el)
        log#id#('| has_pv_power ? ' + config#id#.solar.has_pv_power);
        if (config#id#.solar.has_pv_power !== false) total_pv = config#id#.solar.power
        if (config#id#.solar.has_pv_power === false){
          total_pv = 
            (
              ((config#id#.solar.pv1.power) * 1000) +
              ((config#id#.solar.pv2.power) * 1000) +
              ((config#id#.solar.pv3.power) * 1000) +
              ((config#id#.solar.pv4.power) * 1000)
            ) / 1000
        }
        log#id#('| total_pv = ' + total_pv)
        let solar_animation_speed = config#id#.solar.animation_speed
        log#id#('| animation_speed = ' + config#id#.solar.animation_speed)
        log#id#('| max power = ' + config#id#.solar.max_power)
        let speed = config#id#.solar.animation_speed - ((config#id#.solar.animation_speed - 1.5) * (total_pv / (config#id#.solar.max_power || total_pv)))
        speed = (speed >= 1.5) ? speed : 1.5
        log#id#('| animation_speed = ' + speed)
        document.getElementById("anim_pv#id#")?.setAttribute("dur",speed)
        for (let iPv = 1; iPv < 5; iPv++) {
          document.getElementById("anim_pv" + iPv + "#id#")?.setAttribute("dur",speed)
          log#id#('| pv' + iPv + '_power = ' + parseFloat(config#id#.solar['pv' + iPv].power) + ' (' + config#id#.solar['pv' + iPv].power + ')')
          if(config#id#.solar['pv' + iPv].power > 0) document.getElementById("pv" + iPv + "-dot#id#").setAttribute("fill", "var(--solar_colour#id#)")
          else document.getElementById("pv" + iPv + "-dot#id#").setAttribute("fill", "transparent")
        }
        config#id#.solar.power = trunc#id#(total_pv, 1)
        document.getElementById("pvtotal_power#id#").innerHTML = config#id#.solar.power + ' ' + config#id#.solar.unit
        if(total_pv > 0) document.getElementById("so-dot#id#").setAttribute("fill", "var(--solar_colour#id#)")
        else document.getElementById("so-dot#id#").setAttribute("fill", "transparent")
      }
      log#id#('└──────────────────────────────────────────────────────')
    }    
    
    function calculateLoad#id#(el='') {
      log#id#('┌─────────────────── Widget Distribution Onduleur [#id#] en debug [calculateLoad()] ───────────────')
      var ElDomExist = !!document.getElementById("widget#id#");
      log#id#('| ElDomExist ? ' + ElDomExist)
      if (ElDomExist) {  
        if (el != '') log#id#('| launched by ' + el)
        log#id#('| has_load_power ?',config#id#.load.has_load_power)
        if (config#id#.load.has_load_power === false) {
          var differentUnit = false
          config#id#.load.power_unit = config#id#.load.load1.power_unit
          for (let i_additional_loads = 1; i_additional_loads <= config#id#.load.additional_loads; i_additional_loads++) {
            log#id#('| load' + i_additional_loads + '_state = ' + config#id#.load['load' + i_additional_loads].power + ' ' + config#id#.load['load' + i_additional_loads].power_unit)
            if (config#id#.load['load' + i_additional_loads].power_unit != config#id#.load.power_unit) differentUnit = true
          }
          if (differentUnit === true) {
            log#id#('| /!\\ ------- Attention unité differente entre load, calcul impossible !!!')
          } else {
            config#id#.load.power = ((config#id#.load.load1.power * 1000) + (config#id#.load.load2.power * 1000) + (config#id#.load.load3.power * 1000) + (config#id#.load.load4.power * 1000) + (config#id#.load.load5.power * 1000) + (config#id#.load.load6.power * 1000) + (config#id#.load.load7.power * 1000) + (config#id#.load.load8.power * 1000) + (config#id#.load.load9.power * 1000) + (config#id#.load.load10.power * 1000) + (config#id#.load.load11.power * 1000) + (config#id#.load.load12.power * 1000)) / 1000
            document.getElementById("load_power#id#").innerHTML = config#id#.load.power + ' ' + config#id#.load.power_unit
          }
        }
        if (config#id#.load.max_power && config#id#.load.power >= config#id#.load.max_power) {
          document.getElementById("load-rect-#id#").setAttribute("stroke", "var(--color_alerte#id#)")
          if (config#id#.blink) document.getElementById("load-rect-#id#").classList.add("blink#id#")
        } else {
          document.getElementById("load-rect-#id#").setAttribute("stroke", "var(--load_colour#id#)")
          if (config#id#.blink) document.getElementById("load-rect-#id#").classList.remove("blink#id#")
        }
        log#id#('| total_load = ' + config#id#.load.power)
        
        if(config#id#.load.power > 0) {
          document.getElementById("es-dot1#id#").setAttribute("fill", "var(--load_colour#id#)")
          document.getElementById("es-dot#id#").setAttribute("fill", "var(--load_colour#id#)")
        } else {
          document.getElementById("es-dot1#id#").setAttribute("fill", "transparent")
          document.getElementById("es-dot#id#").setAttribute("fill", "transparent")
        }
        log#id#('| animation_speed = ' + config#id#.load.animation_speed)
        log#id#('| max_power = ' + config#id#.load.max_power)
        let speed = config#id#.load.animation_speed - ((config#id#.load.animation_speed - 1) * (config#id#.load.power / (config#id#.load.max_power || config#id#.load.power)))
        speed = (speed >= 1) ? speed : 1
        log#id#('| animation_speed = ' + speed)
        document.getElementById("anim_load#id#")?.setAttribute("dur",speed)
        document.getElementById("anim_load1#id#")?.setAttribute("dur",speed)
        
      }
      log#id#('└──────────────────────────────────────────────────────')
    }
    
    function calculateAux#id#(el='') {
      log#id#('┌─────────────────── Widget Distribution Onduleur [#id#] en debug [calculateAux()] ───────────────')
      var ElDomExist = !!document.getElementById("widget#id#")
      log#id#('| ElDomExist ? ' + ElDomExist)
      if (ElDomExist) {
        if (el != '') log#id#('| launched by ' + el)
        let speed = config#id#.aux.animation_speed - ((config#id#.aux.animation_speed - 1.5) * ((config#id#.aux.power) / (config#id#.aux.max_power || config#id#.aux.power)))
        speed = (speed >= 1.5) ? speed : 1.5
        document.getElementById("anim_aux#id#")?.setAttribute("dur",speed)
        log#id#('| animation_speed = ' + config#id#.aux.animation_speed)
        log#id#('| new animation_speed = ' + speed)
        if (config#id#.aux.max_power && config#id#.aux.power >= config#id#.aux.max_power) {
          document.getElementById("aux-rect-#id#").setAttribute("stroke", "var(--color_alerte#id#)")
          if (config#id#.blink) document.getElementById("aux-rect-#id#").classList.add("blink#id#")
        } else {
          document.getElementById("aux-rect-#id#").setAttribute("stroke", "var(--aux_colour#id#)")
          if (config#id#.blink) document.getElementById("aux-rect-#id#").classList.remove("blink#id#")
        }
        if (config#id#.aux.power > 0) document.getElementById("aux-dot-#id#").setAttribute("fill", "var(--aux_colour#id#)")
        else document.getElementById("aux-dot-#id#").setAttribute("fill", "transparent")
      } // ElDomExist
      log#id#('└──────────────────────────────────────────────────────')
    }
    
    function calculateBattery#id#(el='') {
      log#id#('┌─────────────────── Widget Distribution Onduleur [#id#] en debug [calculateBattery()] ───────────────')
      var ElDomExist = !!document.getElementById("widget#id#")
      log#id#('| ElDomExist ? ' + ElDomExist)
      if (ElDomExist) {
        if (el != '') log#id#('| launched by ' + el)
        // get Icon of battery
        if (el == 'init' || el == 'battery state'){
          if (!config#id#.battery.icon_perso) document.getElementById("icon_bat#id#").innerHTML = getBatteryIcon#id#(config#id#.battery.state.state, config#id#.battery.full_capacity, config#id#.battery.empty_capacity)
          document.getElementById("battery_soc#id#").innerHTML = trunc#id#(config#id#.battery.state.state, 1) + '%'
        }
        // dot && speed
        if (el == 'init' || el == 'battery power' || el == 'battery mppt power'){
          let totalFromInverter = (config#id#.battery.power.state < 0) ? config#id#.battery.power.state + config#id#.battery.mppt.power.state : config#id#.battery.power.state
          log#id#('| totalFromInverter : ' + totalFromInverter)          
          if(parseFloat(totalFromInverter) > 0) {
            document.getElementById("power-dot-charge#id#").setAttribute("fill", "var(--battery_colour#id#)")
            document.getElementById("power-dot-discharge#id#").setAttribute("fill", "transparent")
          }
          else if(parseFloat(totalFromInverter) < 0) {
            document.getElementById("power-dot-charge#id#").setAttribute("fill", "transparent")
            document.getElementById("power-dot-discharge#id#").setAttribute("fill", "var(--battery_colour#id#)")
          }
          else {
            document.getElementById("power-dot-charge#id#").setAttribute("fill", "transparent")
            document.getElementById("power-dot-discharge#id#").setAttribute("fill", "transparent")
          }          
          log#id#('| animation_speed = ' + config#id#.battery.animation_speed)
          log#id#('| energie = ' + config#id#.battery.energy)
          let speed = config#id#.battery.animation_speed - ((config#id#.battery.animation_speed - 1.5) * ((totalFromInverter < 0 ? totalFromInverter * -1 : totalFromInverter) / (config#id#.battery.energy || (totalFromInverter < 0 ? totalFromInverter * -1 : totalFromInverter))))
          speed = (speed >= 1.5) ? speed : 1.5
          document.getElementById("anim_battery-charge#id#")?.setAttribute("dur",speed)
          document.getElementById("anim_battery-discharge#id#")?.setAttribute("dur",speed)
          log#id#('| animation_speed = ' + speed)
        }
        //calculate battery capacity
        log#id#('| ----------- battery_capacity & time --------------')
        let battery_capacity = 0
        if (config#id#.battery.power.state > 0) {
          battery_capacity = config#id#.battery.soc.shutdown
        }
        else if (config#id#.battery.power.state < 0) {
          battery_capacity = 100
        }
        log#id#('| battery_capacity = ' + battery_capacity)
        log#id#('| config#id#.battery.state.state = ' + config#id#.battery.state.state)
        //calculate remaining battery time to charge or discharge
        let totalSeconds = 0
        let formattedResultTime = ""
        let duration = ""
        
        if (config#id#.battery.energy !== false && config#id#.battery.energy > 0) {
          if (config#id#.battery.power.state == 0) {
            log#id#('| power.state == 0')
            totalSeconds = (((parseInt(config#id#.battery.state.state) - config#id#.battery.soc.shutdown) / 100) * config#id#.battery.energy) / 1 * 60 * 60
          } else if (config#id#.battery.power.state > 0) {
            log#id#('| power.state > 0')
            totalSeconds = (((config#id#.battery.state.state - battery_capacity) / 100) * config#id#.battery.energy) / config#id#.battery.power.state * 60 * 60
            log#id#('| energie restante = ' + ((config#id#.battery.state.state - battery_capacity) / 100) * config#id#.battery.energy)
          } else if (config#id#.battery.power.state < 0) {
            log#id#('| power.state < 0')
            totalSeconds = ((((battery_capacity - config#id#.battery.state.state) / 100) * config#id#.battery.energy) / config#id#.battery.power.state) * 60 * 60 * -1
            log#id#('| energie restante = ' + ((battery_capacity - config#id#.battery.state.state) / 100) * config#id#.battery.energy)
          }
          log#id#('| totalSeconds = ' + totalSeconds)
          const currentTime = new Date() // Create a new Date object representing the current time
          const durationMilliseconds = totalSeconds * 1000 // Convert the duration to milliseconds
          const resultTime = new Date(currentTime.getTime() + durationMilliseconds) // Add the duration in milliseconds
          const resultHours = resultTime.getHours() // Get the hours component of the resulting time
          const resultMinutes = resultTime.getMinutes() // Get the minutes component of the resulting time
          const formattedMinutes = resultMinutes.toString().padStart(2, "0")
          const formattedHours = resultHours.toString().padStart(2, "0")
          formattedResultTime = formattedHours + 'h' + formattedMinutes
          log#id#('| formatted = ' + formattedResultTime)
          const days = Math.floor(totalSeconds / (60 * 60 * 24))
          const hours = Math.floor((totalSeconds % (60 * 60 * 24)) / (60 * 60))
          const minutes = Math.floor((totalSeconds % (60 * 60)) / 60)
          if (days > 0) {
            duration += days
            duration += (hours <= 1) ? ' jour, ' : ' jours, '
          }
          if (hours > 0 || days > 0) {
            duration += hours
            duration += (hours <= 1) ? ' hr, ' : ' hrs, '
          }
          duration +=  minutes + ' min'
          log#id#('| duration= ' + duration)
          //config#id#.battery.duration = duration
          if (float !== true && config#id#.battery.energy !== 0 && config#id#.battery.energy !== false) {
            if (config#id#.battery.power.state == 0 || config#id#.battery.power.state == '0' || duration == '0 min') {
              document.getElementById("duration#id#").innerHTML = ''
              document.getElementById("duration_text_etat#id#").innerHTML = ''
            } else {
              document.getElementById("duration#id#").innerHTML = duration
              if (config#id#.battery.power.state <= 0) document.getElementById("duration_text_etat#id#").innerHTML = 'TO ' + battery_capacity + '% CHARGE @ ' + formattedResultTime
              if (config#id#.battery.power.state >= 0) document.getElementById("duration_text_etat#id#").innerHTML = 'RUNTIME TO ' + battery_capacity+ '% @ ' + formattedResultTime
            }
          }
          if(timer_in#id# === false) {
            log#id#('| initialisation de la tempo')
            timer_in#id# = setInterval(calculateBattery#id#, 60000, 'timer_in')
          } else {
            log#id#('| delete de la tempo & reinitialisation')
            clearInterval(timer_in#id#)
            timer_in#id# === false
            timer_in#id# = setInterval(calculateBattery#id#, 60000, 'timer_in')
          }
        }
      } // ElDomExist
      log#id#('└──────────────────────────────────────────────────────')
    }
    
    function calculateGrid#id#(el='') {
      log#id#('┌─────────────────── Widget Distribution Onduleur [#id#] en debug [calculateGrid()] ───────────────')
      var ElDomExist = !!document.getElementById("widget#id#");
      log#id#('| ElDomExist ? ' + ElDomExist)
      if (ElDomExist) {
        log#id#('| animation_speed = ' + config#id#.grid.animation_speed)
        log#id#('| max_power = ' + config#id#.grid.max_power)
        log#id#('| power = ' + config#id#.grid.power)        
        let speed = config#id#.grid.animation_speed - ((config#id#.grid.animation_speed - 1.5) * ((config#id#.grid.power < 0 ? config#id#.grid.power * -1 : config#id#.grid.power) / (config#id#.grid.max_power || (config#id#.grid.power < 0 ? config#id#.grid.power * -1 : config#id#.grid.power))))
        speed = (speed >= 1.5) ? speed : 1.5
        document.getElementById("anim_grid_buy#id#")?.setAttribute("dur",speed)
        document.getElementById("anim_grid_sell#id#")?.setAttribute("dur",speed)
        document.getElementById("anim_grid_buy1#id#")?.setAttribute("dur",speed)
        document.getElementById("anim_grid_sell1#id#")?.setAttribute("dur",speed)
        log#id#('| animation_speed = ' + speed)
        if (config#id#.grid.max_power && config#id#.grid.power >= config#id#.grid.max_power) {
          document.getElementById("grid-rect-#id#").setAttribute("stroke", "var(--color_alerte#id#)")
          if (config#id#.blink) document.getElementById("grid-rect-#id#").classList.add("blink#id#")
        } else {
          document.getElementById("grid-rect-#id#").setAttribute("stroke", "var(--grid_colour#id#)")
          if (config#id#.blink) document.getElementById("grid-rect-#id#").classList.remove("blink#id#")
        }
        //calculateGreenValue#id#('calculateGrid()')
      }
      log#id#('└──────────────────────────────────────────────────────')
      //calculateGreenValue#id#('calculateGrid()')
    }
    function calculateGreenValue#id#(el='') {
      /*
      log#id#('┌─────────────────── Widget Distribution Onduleur [#id#] en debug [calculateGreenValue()] ───────────────')
      var ElDomExist = !!document.getElementById("widget#id#");
      log#id#('| ElDomExist ? ' + ElDomExist)
      if (ElDomExist) {
        log#id#('config#id#.solar.mppts (' + config#id#.solar.mppts + ')')
        log#id#('config#id#.load.additional_loads (' + config#id#.load.additional_loads + ')')
        log#id#('config#id#.grid.power (' + config#id#.grid.power + ')')
        log#id#('config#id#.battery.power.state (' + config#id#.battery.power.state + ')')
        log#id#('config#id#.solar.power (' + config#id#.solar.power + ')')
        if(config#id#.solar.mppts > 0 && config#id#.load.additional_loads > 0) {
          //log#id#((config#id#.load.power - config#id#.grid.power) * 100 / config#id#.load.power)
        }
        
        
        if (config#id#.solar.mppts > 0) {
          let solarConsumption = 0;
          solarConsumption = config#id#.solar.power - ((config#id#.grid.power <= 0) ? Math.abs(config#id#.grid.power) : 0) - ((config#id#.battery.power.state <= 0)  ? Math.abs(config#id#.battery.power.state) : 0);
          log#id#('| | solarConsumption = ' + solarConsumption)
          
          let batteryFromGrid = 0;
          let batteryToGrid = 0;
          if (solarConsumption < 0) {
            // What we returned to the grid and what went in to the battery is more
            // than produced, so we have used grid energy to fill the battery or
            // returned battery energy to the grid
            if (config#id#.battery.power.show) {
              log#id#('| | config#id#.battery.power.show : ' + config#id#.battery.power.show)
              batteryFromGrid = Math.abs(solarConsumption); //200
              log#id#('| | batteryFromGrid : ' + batteryFromGrid)
              log#id#('| | config#id#.grid.power : ' + ((config#id#.grid.power <= 0) ? 0 : Math.abs(config#id#.grid.power)))
              if (batteryFromGrid > ((config#id#.grid.power <= 0) ? 0 : Math.abs(config#id#.grid.power))) { // totalFromGridNoUnit#id#
                log#id#('| | batteryFromGrid > config#id#.grid.power')
                batteryToGrid = (config#id#.grid.power <= 0) ? Math.min((batteryFromGrid - ((config#id#.grid.power <= 0) ? 0 : Math.abs(config#id#.grid.power))), batteryFromGrid) : 0;
                //batteryToGrid = Math.min((batteryFromGrid - ((config#id#.grid.power <= 0) ? 0 : Math.abs(config#id#.grid.power))), batteryFromGrid);
                batteryFromGrid = ((config#id#.grid.power <= 0) ? 0 : Math.abs(config#id#.grid.power));
              } else {
                batteryToGrid = 0 // add
                //batteryFromGrid = ((config#id#.grid.power <= 0) ? 0 : Math.abs(config#id#.grid.power));; // add
                //batteryToGrid = batteryFromGrid // add
                //batteryFromGrid = 0; // add
              } 
            }
            solarConsumption = 0;
            log#id#('| | NEW solarConsumption : ' + solarConsumption)
            
          }
          log#id#('| | batteryFromGrid : ' + batteryFromGrid)
          log#id#('| | batteryToGrid : ' + batteryToGrid)
          
          let gridConsumption = Math.max(((config#id#.grid.power >= 0) ? config#id#.grid.power : 0) - batteryFromGrid, 0);
          log#id#('| | gridConsumption : ' + gridConsumption)
          
          let batteryConsumption = 0;
          if (config#id#.battery.power.show) {
            batteryConsumption = ((config#id#.battery.power.state >= 0) ? config#id#.battery.power.state : 0) - batteryToGrid
            log#id#('| | batteryConsumption : ' + batteryConsumption)
          }
          
          let totalHomeConsumption = Math.max((gridConsumption + solarConsumption + batteryConsumption), 0);
          log#id#('| | totalHomeConsumption : ' + totalHomeConsumption)
          
          var greenValue#id# = 0
          greenValue#id# = (totalHomeConsumption - ((config#id#.grid.power >= 0) ? config#id#.grid.power : 0)) * 100 / totalHomeConsumption
          if(isNaN(greenValue#id#) == true) greenValue#id# = 0
          log#id#('| | greenValue : ' + greenValue#id#)
          
        }
      }
      */
    }
    /* lancer par addUpdateFunction et toute les minutes */
    function getTime#id# () {
      if (is_object(cmd = document.querySelector('.cmd[data-cmd_uid="#uid#"]'))) {
        log#id#('┌─────────────────── Widget Distribution Onduleur [#id#] en debug [getTime()] ───────────────')
        let reinitTempo = false
        let dToday = new Date()
        //dToday.setHours(22)
        let dTodayText = dToday.toLocaleString(navigator.language,{dateStyle: "full"})
        let hours = dToday.getHours()
        let dnext = new Date(dToday.getTime() + 86400000);
        let dnextText = dnext.toLocaleString(navigator.language,{dateStyle: "full"})
        if (Object.keys(JsonTempoArray#id#).length > 0 && Array.isArray(JsonTempoArray#id#)) { // si c'est un json valide qui est envoyé dans addUpdateFunction
          log#id#(JsonTempoArray#id#)
          log#id#('|┌─────────────────── jsonTempo detecté ───────────────────')
          log#id#('|| hours : ' + hours)
          if(JsonTempoArray#id#[dTodayText]) {
            log#id#('|| Date now ' + dTodayText + ' => ' + JsonTempoArray#id#[dTodayText])
            document.getElementById("tempo_today_circle#id#").setAttribute("fill", 'var(--' + getLabel(JsonTempoArray#id#[dTodayText]) + ')')
            document.getElementById("tempo_today_text#id#").setAttribute("fill", "var(--grid_colour#id#)")
            document.getElementById("tempo_today_text#id#").innerHTML = (hours >= 6 && hours < 22) ? 'HP' : 'HC'
          }
          else {
            document.getElementById("tempo_today_circle#id#").setAttribute("fill", "transparent")
            document.getElementById("tempo_today_text#id#").setAttribute("fill", "transparent")
          }
          if(JsonTempoArray#id#[dnextText]) {
            log#id#('|| Date tomorrow ' + dnextText + ' => ' + JsonTempoArray#id#[dnextText])
            document.getElementById("tempo_tomorrow_circle#id#").setAttribute("fill", 'var(--' + getLabel(JsonTempoArray#id#[dnextText]) + ')')
            document.getElementById("tempo_tomorrow_text#id#").setAttribute("fill", "var(--grid_colour#id#)")
          }
          else {
            document.getElementById("tempo_tomorrow_circle#id#").setAttribute("fill", "transparent")
            document.getElementById("tempo_tomorrow_text#id#").setAttribute("fill", "transparent")
          }
          reinitTempo = true
          log#id#('|└────────────────────────────────────')
        } else {
          document.getElementById("tempo_tomorrow_circle#id#").setAttribute("fill", "transparent")
          document.getElementById("tempo_tomorrow_text#id#").setAttribute("fill", "transparent")
          if (JsonTempoArray#id#.includes('red') || JsonTempoArray#id#.includes('rouge')){
            document.getElementById("tempo_today_circle#id#").setAttribute("fill", 'var(--' + getLabel('RED') + ')')
            document.getElementById("tempo_today_text#id#").setAttribute("fill", "var(--grid_colour#id#)")
            document.getElementById("tempo_today_text#id#").innerHTML = (hours >= 6 && hours < 22) ? 'HP' : 'HC'
            reinitTempo = true
          } else if (JsonTempoArray#id#.includes('blue') || JsonTempoArray#id#.includes('bleu')) {
            document.getElementById("tempo_today_circle#id#").setAttribute("fill", 'var(--' + getLabel('BLUE') + ')')
            document.getElementById("tempo_today_text#id#").setAttribute("fill", "var(--grid_colour#id#)")
            document.getElementById("tempo_today_text#id#").innerHTML = (hours >= 6 && hours < 22) ? 'HP' : 'HC'
            reinitTempo = true
          } else if (JsonTempoArray#id#.includes('white') || JsonTempoArray#id#.includes('blanc')) {
            document.getElementById("tempo_today_circle#id#").setAttribute("fill", 'var(--' + getLabel('WHITE') + ')')
            document.getElementById("tempo_today_text#id#").setAttribute("fill", "var(--grid_colour#id#)")
            document.getElementById("tempo_today_text#id#").innerHTML = (hours >= 6 && hours < 22) ? 'HP' : 'HC'
            reinitTempo = true
          } else {
            document.getElementById("tempo_today_circle#id#").setAttribute("fill", "transparent")
            document.getElementById("tempo_today_text#id#").setAttribute("fill", "transparent")
          }
        }
        
        if(timer#id# === false) {
          if (reinitTempo) { 
            log#id#('| initialisation de la tempo')
            timer#id# = setInterval(getTime#id#, 30000, 'timer')
          }
        } else {
          log#id#('| delete de la tempo')
          clearInterval(timer#id#)
          timer#id# === false
          if (reinitTempo) {
            log#id#('| reinitialisation de la tempo')
            timer#id# = setInterval(getTime#id#, 30000, 'timer')
          }
        }
        log#id#('└────────────────────────────────────')
      }
    }
    
    jeedom.cmd.addUpdateFunction('#id#', function(_options) {
      log#id#('┌─────────────────── Widget Distribution Onduleur [#id#] en debug [addUpdateFunction()] ───────────────')
      clearTimeout(timer#id#);
      let IS_JSON = true;
      JsonTempoArray#id# = []
      let tempoJour = ''
      let dToday = new Date()
      let hours = dToday.getHours()
      if (is_object(cmd = document.querySelector('.cmd[data-cmd_uid="#uid#"]'))) {
        try { var obj = JSON.parse(_options.display_value) }
        catch(err) { IS_JSON = false }
        if (_options.display_value != "" && IS_JSON && isNaN(_options.display_value)) {
          log#id#('| -> jsonTempo detecté')
          let dToday = new Date()
          let hours = dToday.getHours()
          for(key in obj){
            let dateTemp = new Date(obj[key]['datetime'])
            JsonTempoArray#id#[(dateTemp.toLocaleString(navigator.language,{dateStyle: "full"}))] = (obj[key]['value'])?obj[key]['value']:'undefined'
          }
          getTime#id#()
        }
        else {
          log#id#('| -> no jsonTempo detecté')
          let value = _options.display_value.toLowerCase()
          document.getElementById("tempo_tomorrow_circle#id#").setAttribute("fill", "transparent")
          document.getElementById("tempo_tomorrow_text#id#").setAttribute("fill", "transparent")
          if (value.includes('red') || value.includes('rouge')) JsonTempoArray#id# = 'red'
          else if (value.includes('blue') || value.includes('bleu')) JsonTempoArray#id# = 'blue'
          else if (value.includes('white') || value.includes('blanc')) JsonTempoArray#id# = 'white'
          getTime#id#()
        }
      }
      log#id#('└────────────────────────────────────')
    })
    
    jeedom.cmd.refreshValue([{ cmd_id: '#id#', value: '#value#', display_value: '#state#', valueDate: '#valueDate#', collectDate: '#collectDate#', alertLevel: '#alertLevel#', unit: '#unite#' }])
    
  </script>
  <template>
    <div> ------------ Général -------------</div>
    <div>Background : Couleur arrière plan du widget [ Exemple : #fffff, white, linear-gradient... | Défaut : transparent ]</div>
    <div>inverterColor : Couleur des éléments de catégorie "onduleur" [ Exemple : #fffff, white]</div>
    <div>noGridColor : Couleur du logo "noGridColor" [ Exemple : #fffff, white]</div>
    <div> ------------ Solar ------------</div>
    <div>pv1Name : personnalisation du nom du Pv1. (Ex: Ouest, Nord, PV1 ...)</div>
    <div>pv2Name : personnalisation du nom du Pv2. (Ex: Ouest, Nord, PV2 ...)</div>
    <div>pv3Name : personnalisation du nom du Pv3. (Ex: Ouest, Nord, PV3 ...)</div>
    <div>pv4Name : personnalisation du nom du Pv4. (Ex: Ouest, Nord, PV4 ...)</div>
    <div>dailySolarText : personnalisation du texte. (défaut : DAILY SOLAR)</div>
    <div>pvMaxPower : Puissance max des PV. (permet la gestion de vitesse de l'animation)</div>
    <div>solarColor : Couleur des éléments de catégorie "solaire" [ Exemple : #fffff, white]</div>
    <div> ------------ Load ------------</div>
    <div> [ Liste des icones possible pour les load : oven, pump, aircon, boiler, charging, battery, plug, light, pool, dryer, dishwasher, washing, microwave, toaster, fridge, coffee, hood, tv, server, laptop, console ]</div>
    <div>load1Name : personnalisation du nom du Load1. (Ex: C.E, Clim, ...)</div>
    <div>load1Icon : Afficher Icone. Choix : Voir liste au dessus.</div>
    <div>load1MaxPower : Puissance Max (Permet de colorer le rectangle cette puissance est atteinte)</div>
    <div>load2Name : personnalisation du nom du Load2. (Ex: C.E, Clim, ....)</div>
    <div>load2Icon : Afficher Icone. Choix : Voir liste au dessus.</div>
    <div>load2MaxPower : Puissance Max (Permet de colorer le rectangle cette puissance est atteinte)</div>
    <div>load3Name : personnalisation du nom du Load3. (Ex: C.E, Clim, ....)</div>
    <div>load3Icon : Afficher Icone. Choix : Voir liste au dessus.</div>
    <div>load3MaxPower : Puissance Max (Permet de colorer le rectangle cette puissance est atteinte)</div>
    <div>load4Name : personnalisation du nom du Load4. (Ex: C.E, Clim, ....)</div>
    <div>load4Icon : Afficher Icone. Choix : Voir liste au dessus.</div>
    <div>load4MaxPower : Puissance Max (Permet de colorer le rectangle cette puissance est atteinte)</div>
    <div>load5Name : personnalisation du nom du Load5. (Ex: C.E, Clim, ....)</div>
    <div>load5Icon : Afficher Icone. Choix : Voir liste au dessus.</div>
    <div>load5MaxPower : Puissance Max (Permet de colorer le rectangle cette puissance est atteinte)</div>
    <div>load6Name : personnalisation du nom du Load6. (Ex: C.E, Clim, ....)</div>
    <div>load6Icon : Afficher Icone. Choix : Voir liste au dessus.</div>
    <div>load6MaxPower : Puissance Max (Permet de colorer le rectangle cette puissance est atteinte)</div>
    <div>load7Name : personnalisation du nom du Load7. (Ex: C.E, Clim, ....)</div>
    <div>load7Icon : Afficher Icone. Choix : Voir liste au dessus.</div>
    <div>load7MaxPower : Puissance Max (Permet de colorer le rectangle cette puissance est atteinte)</div>
    <div>load8Name : personnalisation du nom du Load8. (Ex: C.E, Clim, ....)</div>
    <div>load8Icon : Afficher Icone. Choix : Voir liste au dessus.</div>
    <div>load8MaxPower : Puissance Max (Permet de colorer le rectangle cette puissance est atteinte)</div>
	<div>load8Name : personnalisation du nom du Load8. (Ex: C.E, Clim, ....)</div>
    <div>load8Icon : Afficher Icone. Choix : Voir liste au dessus.</div>
    <div>load8MaxPower : Puissance Max (Permet de colorer le rectangle cette puissance est atteinte)</div>
    <div>load9Name : personnalisation du nom du Load9. (Ex: C.E, Clim, ....)</div>
    <div>load9Icon : Afficher Icone. Choix : Voir liste au dessus.</div>
    <div>load9MaxPower : Puissance Max (Permet de colorer le rectangle cette puissance est atteinte)</div>
    <div>load10Name : personnalisation du nom du Load10. (Ex: C.E, Clim, ....)</div>
    <div>load10Icon : Afficher Icone. Choix : Voir liste au dessus.</div>
    <div>load10MaxPower : Puissance Max (Permet de colorer le rectangle cette puissance est atteinte)</div>
    <div>load11Name : personnalisation du nom du Load11. (Ex: C.E, Clim, ....)</div>
    <div>load11Icon : Afficher Icone. Choix : Voir liste au dessus.</div>
    <div>load11MaxPower : Puissance Max (Permet de colorer le rectangle cette puissance est atteinte)</div>
    <div>load12Name : personnalisation du nom du Load12. (Ex: C.E, Clim, ....)</div>
    <div>load12Icon : Afficher Icone. Choix : Voir liste au dessus.</div>
    <div>load12MaxPower : Puissance Max (Permet de colorer le rectangle cette puissance est atteinte)</div>
    <div>dailyLoadText : personnalisation du texte. (défaut : DAILY LOAD)</div>
    <div>loadMaxPower : Puissance max des équipements "Load". (Permet la gestion de vitesse de l'animation + coloration du rectangle cette puissance est atteinte)</div>
    <div>loadColor : Couleur des éléments de catégorie "load" [ Exemple : #fffff, white]</div>
    <div>loadAnimate: Pour désactiver l'animation des Load passer ce paramètre a 0</div>
    <div>blink : Clignotement rectangle si valeur > puissance max</div>
    <div>colorDanger : Couleur des rectangles en cas de dépassement de puissance. (Défaut : red)</div>
    <div> ------------ Grid ------------</div>
    <div>dailyGridSellText : personnalisation du texte. (défaut : DAILY GRID SELL)</div>
    <div>dailyGridBuyText : personnalisation du texte. (défaut : DAILY GRID BUYL)</div>
    <div>gridMaxPower : Puissance max de consommation. (permet la gestion de vitesse de l'animation)</div>
    <div>gridColor : Couleur des éléments de catégorie "réseau" [ Exemple : #fffff, white]</div>
    <div> ------------ Battery ------------</div>
    <div>dailyBatteryChargeText : personnalisation du texte. (défaut : DAILY CHARGE)</div>
    <div>dailyBatteryDischargeText : personnalisation du texte. (défaut : DAILY DISCHARGE)</div>
    <div>batteryMaxPower : Puissance max de la batterie. (permet la gestion de vitesse de l'animation)</div>
    <div>batterySocShutdown : SOC mini. (defaut: 0)</div>
    <div>mpptName : personnalisation du nom du Chargeur PV.</div>
    <div>batteryColor : Couleur des éléments de catégorie "batterie" [ Exemple : #fffff, white]</div>
    <div>batteryIcone : Afficher Icone. Choix : Voir liste des "load".</div>
    <div> ------------ Aux ------------</div>
    <div>auxColor :  Couleur des éléments de catégorie "aux" [ Exemple : #fffff, white]</div>
    <div>auxMaxPower : Puissance max des "Aux". (permet la gestion de vitesse de l'animation)</div>
  </template>
</div>
